#textdomain wesnoth-DB

#define TRY_SAY_BY_THIS_RACE RACE MES
	[if]
            	[have_unit]
            		race={RACE}
            	[/have_unit]
            	[then]
            		[message]
            			side=1
            			canrecruit=no
            			race={RACE}
            			message={MES}
            		[/message]
            	[/then]
            	[else]
            		[message]
            			side=1
            			canrecruit=no
            			message={MES}
            		[/message]
            	[/else]
            [/if]
#enddef


[scenario]
    id=1_The_End_of_the_War
    name = _ "Commander of Weaklings"
    random_start_time=no
    experience_modifier=100
    map_data="{~add-ons/Dirty_Blood/maps/1_End_of_the_War.map}"
    victory_when_enemies_defeated=no
    next_scenario=2_Breaking_Tradition
    carryover_percentage=20
    carryover_add=yes
    current_time=2

    {TURNS 32 30 28}
    {SCENARIO_MUSIC "loyalists.ogg"}
    {EXTRA_SCENARIO_MUSIC "knolls.ogg"}
    {WINTER_SCHEDULE}
    {EVENTS_FOR_ABILITIES}

    [story]
        [part]
        story= _"Thirty years ago Kapou'e Black Eye united the disparate orc clans under his banner. Since then, no ruler had dared to attack the powerful union of clans. The Iron Law of the Supreme Leader suppressed inter-clan strife. In the united country orcs were multiplying, licking their wounds, establishing new settlements, they were recovering from the great war. But Kapou'e died and the union weakened. The air smelled of the old orcish life."
        {DB_BIGMAP}
        [/part]
        [part]
        story= _"A young clan of Straight Blades founded by veterans of the Kapou'e army was located in the southeast of the Union bordering the Barren Plains where wild nomadic ogres lived. Ogre raids used to be commonplace; they stopped during the Kapou'e era. Unfortunately for the Straight Blades, orcs were not the only ones who grew stronger after the respite."
        {DB_BIGMAP}
        [/part]
        [part]
        story= _"Sensing that the unity of orcs was weakening, the ogres gathered a large horde and raided the Straight Blades. Hundreds of hungry, snarling, hooting ogres came under the orcish walls."
        {DB_BIGMAP}
        [/part]
        [part]
        story= _"The orcs fought worthy of their ancestors, but the forces were unequal. The ogres killed all the men, ate the children, and enslaved the women. For three days and three nights, the ogres rampaged through blood-soaked streets."
        {DB_BIGMAP}
        [/part]
        [part]
        story= _"On the fourth day the ogres burned the settlement and went back to their steppes. But their carelessness had played havoc with them. An army of the border Cold Blood clan caught up with the ogre caravan. The enraged orcs brought vengeance at the tip of their blades."
        {DB_BIGMAP}
        [/part]
        [part]
        story= _"The Cold Blood warriors massacred the ogres. They freed the captives and brought them to their settlement. The chief accepted them into the clan."
        {DB_BIGMAP}
        [/part]
        [part]
        story= _"Some time later, one of the former captives gave birth. A huge, ugly child tore open its mother's womb and came into the world. The whole hut was drenched in blood. It was a half-ogre half-orc, a sinister greeting from the past."
        {DB_BIGMAP}
        [/part]
        [part]
        story= _"The chief wanted to kill him, but an old orc shamaness forbade him. The spirits told her that the clan must accept this terrible child or great misfortune would befall them."
        {DB_BIGMAP}
        [/part]
        [part]
        story= _"Gritting his teeth, the chief agreed. He ordered the shamaness to raise the cursed child."
        {DB_BIGMAP}
        [/part]
        [part]
        story= _"The baby was named 'Moog' which means 'Dirty'. Very soon the nickname 'Harmful' was added to it."
        {DB_BIGMAP}
        [/part]
        [part]
        story= _"Moog the Harmful grew up under the supervision of the orcish shamaness. Very soon he became larger and stronger than many of orcs, but his bad destiny kept him from taking his rightful place in the orc hierarchy. Moog grew up among goblins. He shared all the humiliation that the wimps are subjected to."
        {DB_BIGMAP}
        [/part]
        [part]
        story= _"But Moog himself was no wimp. Sometimes he fought back against orcs, which made him a hero in the other goblins' eyes. But Moog didn't want to be a hero of the weak. He grew up to be a strange and vicious creature."
        {DB_BIGMAP}
        [/part]
        [part]
        story= _"The years passed. As Moog came of age, war came to the orc lands. The Orc Power clashed with the Northern Alliance. The clans didn't even try to understand the reasons for the war. The Supreme Leader called the Great Horde - and the clans joined in. The chief of the Cold Blood put Moog in charge of a goblin warband."
        {DB_BIGMAP}
        [/part]
    [/story]

    {DB_TRACK {JOURNEY_01_NEW} }

    [item]
        image="scenery/mine-abandoned.png"
        visible_in_fog=yes
        x=6
        y=4
    [/item]
    [item]
        image="items/orcish-flag.png"
        visible_in_fog=yes
        x=20
        y=13
    [/item]

    [side]
        controller=human
        side=1
        {GOLD 116 93 70}
        {MOOG_HARMFUL_WAR_STATS}
        team_name=bastards
        user_team_name= _ "Cold Blood Bastards"
        recruit=Goblin Spearman,Wolf Rider,Orcish Archer
        color=blue
        fog=no
        shroud=no

        [unit]
            id=Goblin_Friend
            type=Goblin Impaler
            facing=s
            profile=portraits/goblins/rouser-2.png
            [modifications]
                {TRAIT_LOYAL}
                {TRAIT_RESILIENT}
            [/modifications]
            x=20
            y=12
        [/unit]

        [unit]
            id=Goblin_Watcher
            {TYPE_ON_DIFFICULTY "Goblin Impaler" "Goblin Impaler" "Goblin Spearman"}
            [modifications]
                {TRAIT_STRONG}
                {TRAIT_RESILIENT}
            [/modifications]
            x=25
            y=10
        [/unit]
        [unit]
            {TYPE_ON_DIFFICULTY "Goblin Impaler" "Goblin Impaler" "Goblin Spearman"}
            [modifications]
                {TRAIT_STRONG}
                {TRAIT_RESILIENT}
            [/modifications]
            x=26
            y=12
        [/unit]
        [unit]
            {TYPE_ON_DIFFICULTY "Goblin Impaler" "Goblin Impaler" "Goblin Spearman"}
            [modifications]
                {TRAIT_STRONG}
                {TRAIT_RESILIENT}
            [/modifications]
            x=15
            y=15
        [/unit]
        [unit]
            {TYPE_ON_DIFFICULTY "Goblin Impaler" "Goblin Impaler" "Goblin Spearman"}
            [modifications]
                {TRAIT_STRONG}
                {TRAIT_RESILIENT}
            [/modifications]
            x=16
            y=17
        [/unit]
    [/side]
    [side]
        controller=ai
        side=2
        team_name=bastards
        user_team_name= _ "Cold Blood Warriors"
        color=teal
        no_leader=yes
        hidden=no
        share_vision=no
        {BLACK_FLAG}

        #Gurrack and his veterans

        [unit]
            type="Orcish Warrior"
            x=22
            y=12
            id=guard3
            [modifications]
                {TRAIT_LOYAL}
            [/modifications]
        [/unit]
        [unit]
            type="Orcish Warrior"
            x=22
            y=13
            id=guard2
            [modifications]
                {TRAIT_LOYAL}
            [/modifications]
        [/unit]
        [unit]
            type="Orcish Warrior"
            x=23
            y=14
            id=guard1
            [modifications]
                {TRAIT_LOYAL}
            [/modifications]
        [/unit]
        [unit]
            name="Gurrak the Chief's Son"
            canrecruit=yes
            profile=portraits/gurrak.png
            facing=nw
            id=Son
            type="Orcish Leader"
            x=23
            y=13
        [/unit]
    [/side]
    [side]
        defeat_condition=never
        controller=ai
        side=3
        {GOLD 200 200 200}
        {INCOME 100 100 100}
        recruit=Spearman,Bowman,Horseman,Cavalryman,Longbowman
        team_name=alliance
        user_team_name= _ "Northern Alliance"
        no_leader=yes
        color=green
        hidden=no
        fog=no
        shroud=no
        {FLAG_VARIANT knalgan}
        {SCENARIO_1_ALLIANCE_AI}
    [/side]
    [side]
        defeat_condition=never
        controller=ai
        side=4
        {GOLD 200 200 200}
        {INCOME 100 100 100}
        recruit=Spearman,Bowman,Horseman,Cavalryman,Longbowman
        team_name=alliance
        user_team_name= _ "Northern Alliance"
        no_leader=yes
        color=purple
        hidden=no
        fog=no
        shroud=no
        {FLAG_VARIANT knalgan}
        {SCENARIO_1_ALLIANCE_AI}
    [/side]

    #prestart event: villages, variables, objectives

    [event]
    name=prestart

        {CAPTURE_VILLAGES_OF_TYPE Rb^Vct,Re^Vct 1 19 13 20}

        [set_variable]
            name=dead_orcs
            value=0
        [/set_variable]
        [set_variable]
            name=gurrak_come
            value=0
        [/set_variable]

        [objectives]
            silent=yes
                [objective]
                    description= _ "Protect the Crossing"
                    condition=win
                [/objective]
                [objective]
                    description= _ "Death of Moog"
                    condition=lose
                [/objective]
                {TURNS_RUN_OUT}
                [gold_carryover]
                    bonus=yes
                    carryover_percentage=20
                [/gold_carryover]
                [note]
                    description=_"In this campaign, Goblin Impalers have additional level-2 advancements."
                [/note]
                [note]
                    description=_"Moog has a lot of hate. Killing enemies fuels it, increasing the damage of his attacks and making his enemies fear him."
                [/note]
            [/objectives]    
    [/event]

    #start: dialogue, moving Gurrak, prepare to defense

    [event]
    name=start

        [message]
        speaker=Son
        message= _ "Useless bastards! If it were up to me, you'd all die in the front lines! But the chief ordered you to guard the crossing, so you'll sit on your asses in the rear."
        [/message]
        [message]
        speaker=Son
        message= _ "I'm going to war, to shed blood like a true orc. If any of you freaks are off duty when I get back, I'll slaughter this wimp where he stands. And don't expect to share in the spoils of war."
        [/message]

        {MOVE_UNIT id=Son 46 12}
        [kill]
        id=Son
        animation=no
        [/kill]

        {MOVE_UNIT id=guard1 46 12}
        [kill]
        id=guard1
        animation=no
        [/kill]

        {MOVE_UNIT id=guard2 46 12}
        [kill]
        id=guard2
        animation=no
        [/kill]

        {MOVE_UNIT id=guard3 46 12}
        [kill]
        id=guard3
        animation=no
        [/kill]

        [message]
        speaker=Goblin_Friend
        message= _"Don't care what he says, better to sit in the rear than be fodder for these huge piles of shit."
        [/message]
        [message]
        speaker=Goblin_Watcher
        message= _"I've spotted the Alliance weasels! They're sniffing around!"
        [/message]

        #north
        [unit]
            id=Scout1
            {TYPE_ON_DIFFICULTY "Cavalryman" "Dragoon" "Dragoon"}
            side=3
            x=44
            y=1
        [/unit]
        [unit]
            type=Cavalryman
            side=3
            x=24
            y=1
        [/unit]
        [unit]
            id=Scout1
            type=Cavalryman
            side=3
            x=46
            y=9
        [/unit]

        #south

        [unit]
            id=Scout2
            type=Cavalryman
            side=4
            x=39
            y=22
        [/unit]
        [unit]
            type=Cavalryman
            side=3
            x=45
            y=17
        [/unit]
       
        [scroll_to_unit]
            id=Scout1
        [/scroll_to_unit]
        [delay]
            time=500
        [/delay]
        [scroll_to_unit]
            id=Scout2
        [/scroll_to_unit]
        [delay]
            time=500
        [/delay]

        [message]
        speaker=Bastard
        message= _"Let's chase them away."
        [/message]
    [/event]

    #Alliance Commanders spawns

    [event]
    name=turn_5

        #side 3 spawn

        [unit]
            side=3
            type="Lieutenant"
            id=Commander1
            canrecruit=yes
            x=46
            y=1
        [/unit]

        [if]
            [have_unit]
                side=1
                x,y=42,2
            [/have_unit]

                [then]
                {MOVE_UNIT id=Commander1 43 2}
                {ANIMATE_ATTACK Commander1 42,2 sword yes}

                [kill]
                    x,y=42,2
                    animate=yes
                [/kill]

                {MOVE_UNIT id=Commander1 42 2}

                {MODIFY_TERRAIN Ke 42 2}
                {MODIFY_TERRAIN Ce 41 2}
                {MODIFY_TERRAIN Ce 41 3}
                {MODIFY_TERRAIN Ce 42 3}

                [unit]
                    side=3
                    ai_special=guardian
                    random_traits=no
                    upkeep=0
                    [modifications]
                    {TRAIT_STRONG}
                    {TRAIT_RESILIENT}
                    [/modifications]
                    id=Guard_3_1
                    type="Halberdier"
                    x=46
                    y=1
                    max_moves=3
                [/unit]

                {MOVE_UNIT id=Guard_3_1 40 2}

                [unit]
                    side=3
                    ai_special=guardian
                    random_traits=no
                    upkeep=0
                    [modifications]
                    {TRAIT_STRONG}
                    {TRAIT_RESILIENT}
                    [/modifications]
                    id=Guard_3_2
                    type="Halberdier"
                    x=46
                    y=1
                    max_moves=3
                [/unit]

                {MOVE_UNIT id=Guard_3_2 41 4}
                [/then]
                [else]

                {MOVE_UNIT id=Commander1 42 2}

                {MODIFY_TERRAIN Ke 42 2}
                {MODIFY_TERRAIN Ce 41 2}
                {MODIFY_TERRAIN Ce 41 3}
                {MODIFY_TERRAIN Ce 42 3}

                [unit]
                    side=3
                    ai_special=guardian
                    random_traits=no
                    upkeep=0
                    [modifications]
                    {TRAIT_STRONG}
                    {TRAIT_RESILIENT}
                    [/modifications]
                    id=Guard_3_1
                    type="Halberdier"
                    x=46
                    y=1
                    max_moves=3
                [/unit]

                {MOVE_UNIT id=Guard_3_1 40 2}

                [unit]
                    side=3
                    ai_special=guardian
                    random_traits=no
                    upkeep=0
                    [modifications]
                    {TRAIT_STRONG}
                    {TRAIT_RESILIENT}
                    [/modifications]
                    id=Guard_3_2
                    type="Halberdier"
                    x=46
                    y=1
                    max_moves=3
                [/unit]
                {MOVE_UNIT id=Guard_3_2 41 4}
                [/else]
        [/if]


        #side 4 spawn

        [unit]
            side=4
            type="Lieutenant"
            id=Commander2
            canrecruit=yes
            x=40
            y=25
        [/unit]

        [if]
            [have_unit]
                side=1
                x,y=39,23
            [/have_unit]

                [then]
                {MOVE_UNIT id=Commander2 39 24}
                {ANIMATE_ATTACK Commander2 39,23 sword yes}

                [kill]
                    x,y=39,23
                    animate=yes
                [/kill]

                {MOVE_UNIT id=Commander2 39 23}
                {MODIFY_TERRAIN Ke^Qhh 39 23}
                {MODIFY_TERRAIN Ce^Qhh 40 22}
                {MODIFY_TERRAIN Ce^Qhh 39 22}
                {MODIFY_TERRAIN Ce^Qhh 38 22}
                [redraw][/redraw]

                [unit]
                    side=4
                    ai_special=guardian
                    random_traits=no
                    upkeep=0
                    [modifications]
                    {TRAIT_STRONG}
                    {TRAIT_RESILIENT}
                    [/modifications]
                    id=Guard_4_1
                    type="Halberdier"
                    x=40
                    y=25
                    max_moves=3
                [/unit]

                {MOVE_UNIT id=Guard_4_1 40 21}

                [unit]
                    side=4
                    ai_special=guardian
                    random_traits=no
                    upkeep=0
                    [modifications]
                    {TRAIT_STRONG}
                    {TRAIT_RESILIENT}
                    [/modifications]
                    id=Guard_4_2
                    type="Halberdier"
                    x=40
                    y=25
                    max_moves=3
                [/unit]

                {MOVE_UNIT id=Guard_4_2 38 21}
                [/then]
                [else]

                {MOVE_UNIT id=Commander2 39 23}
                {MODIFY_TERRAIN Ke^Qhh 39 23}
                {MODIFY_TERRAIN Ce^Qhh 40 22}
                {MODIFY_TERRAIN Ce^Qhh 39 22}
                {MODIFY_TERRAIN Ce^Qhh 38 22}
                [redraw][/redraw]

                [unit]
                    side=4
                    ai_special=guardian
                    random_traits=no
                    upkeep=0
                    [modifications]
                    {TRAIT_STRONG}
                    {TRAIT_RESILIENT}
                    [/modifications]
                    id=Guard_4_1
                    type="Halberdier"
                    x=40
                    y=25
                    max_moves=3
                [/unit]

                {MOVE_UNIT id=Guard_4_1 40 21}

                [unit]
                    side=4
                    ai_special=guardian
                    random_traits=no
                    upkeep=0
                    [modifications]
                    {TRAIT_STRONG}
                    {TRAIT_RESILIENT}
                    [/modifications]
                    id=Guard_4_2
                    type="Halberdier"
                    x=40
                    y=25
                    max_moves=3
                [/unit]
                {MOVE_UNIT id=Guard_4_2 38 21}
                [/else]
        [/if]

        [message]
        speaker=Commander1
        message= _ "We're ahead of the stinking orcs! Now let's take the crossing and cut them off."
        [/message]
        [message]
        speaker=Bastard
        message= _ "I have a bad feeling. But we must hold on."
        [/message]
    [/event]

    {FORCE_CHANCE_TO_HIT (side=1) (id=Commander1) 0 ()}
    {FORCE_CHANCE_TO_HIT (side=1) (id=Commander2) 0 ()}

    [event]
    name=turn_7

    {REPLACE_SCENARIO_MUSIC the_city_falls.ogg}
    {APPEND_MUSIC "casualties_of_war.ogg"}
    {APPEND_MUSIC "battle.ogg"}

        [unit]
        id=messenger
        #ifdef EASY
            type=Goblin Knight
            hitpoints=33
            experience=8
        #endif
        #ifdef NORMAL
            type=Wolf Rider
            hitpoints=20
            experience=11
        #endif
        #ifdef HARD
            type=Wolf Rider
            hitpoints=18
        #endif
        [modifications]
            {TRAIT_STRONG}
            {TRAIT_QUICK}
        [/modifications]
        x,y=46,12
        [/unit]

        {MOVE_UNIT id=messenger 22 14}

        [message]
        speaker=messenger
        message= _"Trouble, trouble, everyone's fleeing! The battle... lost! Supreme Leader... missing! The Great Horde... defeated! Many clans have been slaughtered! We've been lucky, most of the warriors of our clan survived, they rushing here, but the Alliance skirmishers are on their tail, the chief ordered you to protect the crossing!"
        [/message]
        [message]
        speaker=Bastard
        message= _"So that's why these commanders are here. Smells like a big fight. Shit! I don't want to spill blood for these assholes. But we don't have a choice."
        [/message]

        [micro_ai]
            side=2
            ai_type=goto
            action=add
            release_unit_at_goal=yes
            [filter]
                side=2
            [/filter]
            [filter_location]
                x,y=1,18
            [/filter_location]
            ca_score=600000
        [/micro_ai]

        #ai for alliance

        [micro_ai]
            side=3
            ai_type=simple_attack
            action=add
            ca_score=110000
            [filter]
                race=human,dwarf
            [/filter]
            [filter_second]
            side=2
            [/filter_second]
        [/micro_ai]
        [micro_ai]
            side=4
            ai_type=simple_attack
            action=add
            ca_score=110000
            [filter]
                race=human,dwarf
            [/filter]
            [filter_second]
                side=2
            [/filter_second]
        [/micro_ai]
    [/event]
    [event]
    name=turn_8
    first_time_only=yes

        {REPEAT 2 (

            [unit]
            {TYPE_ON_DIFFICULTY "Orcish Grunt" "Orcish Grunt" "Orcish Grunt"}
            side=2
            x,y=46,12
            animate=yes
            role=retreat
            {LOW_HP 10 12 14}
            [/unit])}

            [unit]
            {TYPE_ON_DIFFICULTY "Orcish Warrior" "Orcish Grunt" "Orcish Grunt"}
            side=2
            x,y=46,12
            animate=yes
            role=retreat
            {LOW_HP 12 14 16}
            [/unit]

            [unit]
            {TYPE_ON_DIFFICULTY "Orcish Grunt" "Orcish Archer" "Orcish Archer"}
            side=2
            x,y=46,12
            animate=yes
            role=retreat
            {LOW_HP 10 12 14}
            [/unit]

        [scroll_to_unit]
            side=2
        [/scroll_to_unit]

        [message]
            speaker=messenger
            message= _ "There they are, our clansmen on the horizon!"
        [/message]
        [message]
        speaker=Bastard
        message= _ "I hope our dumbasses move their asses."
        [/message]

        [objectives]
            silent=no
                [objective]
                    description= _ "Protect the retreating orcs"
                    condition=win
                [/objective]
                [objective]
                    description= _ "Death of Moog"
                    condition=lose
                [/objective]
                [objective]
                    #ifdef EASY
                    description= _ "Death of 7 retreating orcs ($dead_orcs|/7)"
                    #endif
                    #ifdef NORMAL
                    description= _ "Death of 6 retreating orcs ($dead_orcs|/6)"
                    #endif
                    #ifdef HARD
                    description= _ "Death of 5 retreating orcs ($dead_orcs|/5)"
                    #endif
                    condition=lose
                [/objective]
                {TURNS_RUN_OUT}
                [note]
                    description=_"The retreating orcs will try to cross the river and get to the west border of the road."
                [/note]
                [note]
                    description=_"Alliance soldiers prefer to attack retreating orcs rather than your units."
                [/note]
            [gold_carryover]
                    bonus=yes
                    carryover_percentage=20
            [/gold_carryover]
            delayed_variable_substitution=yes
        [/objectives] 
    [/event]  

    #waves 

    [event]
    name=turn_10
    first_time_only=yes

         {REPEAT 2 (

            [unit]
            {TYPE_ON_DIFFICULTY "Orcish Grunt" "Orcish Grunt" "Orcish Grunt"}
            side=2
            x,y=46,12
            animate=yes
            role=retreat
            {LOW_HP 10 12 14}
            [/unit])}

            [unit]
            {TYPE_ON_DIFFICULTY "Orcish Warrior" "Orcish Grunt" "Orcish Grunt"}
            side=2
            x,y=46,12
            animate=yes
            role=retreat
            {LOW_HP 12 14 16}
            [/unit]

            [unit]
            {TYPE_ON_DIFFICULTY "Orcish Grunt" "Orcish Archer" "Orcish Archer"}
            side=2
            x,y=46,12
            animate=yes
            role=retreat
            {LOW_HP 10 12 14}
            [/unit]
    [/event]
    [event]
    name=turn_12
    first_time_only=yes

         {REPEAT 2 (

            [unit]
            {TYPE_ON_DIFFICULTY "Orcish Grunt" "Orcish Grunt" "Orcish Grunt"}
            side=2
            x,y=46,12
            animate=yes
            role=retreat
            {LOW_HP 10 12 14}
            [/unit])}

            [unit]
            {TYPE_ON_DIFFICULTY "Orcish Warrior" "Orcish Grunt" "Orcish Grunt"}
            side=2
            x,y=46,12
            animate=yes
            role=retreat
            {LOW_HP 12 14 16}
            [/unit]

            [unit]
            {TYPE_ON_DIFFICULTY "Orcish Grunt" "Orcish Archer" "Orcish Archer"}
            side=2
            x,y=46,12
            animate=yes
            role=retreat
            {LOW_HP 10 12 14}
            [/unit]
    [/event]
    [event]
    name=turn_14
    first_time_only=yes

        {REPEAT 2 (

            [unit]
            {TYPE_ON_DIFFICULTY "Orcish Grunt" "Orcish Grunt" "Orcish Grunt"}
            side=2
            x,y=46,12
            animate=yes
            role=retreat
            {LOW_HP 10 12 14}
            [/unit])}

            [unit]
            {TYPE_ON_DIFFICULTY "Orcish Warrior" "Orcish Grunt" "Orcish Grunt"}
            side=2
            x,y=46,12
            animate=yes
            role=retreat
            {LOW_HP 12 14 16}
            [/unit]

            [unit]
            {TYPE_ON_DIFFICULTY "Orcish Grunt" "Orcish Archer" "Orcish Archer"}
            side=2
            x,y=46,12
            animate=yes
            role=retreat
            {LOW_HP 10 12 14}
            [/unit]
    [/event]

    #first saved orcs

    [event]
    name=moveto
    first_time_only=yes

        [filter]
        side=2
        type=Orcish Grunt,Orcish Warrior
            [filter_location]
                x,y=21,14
                radius=3
            [/filter_location]
        [/filter]

        [message]
        speaker=unit
        message= _ "I didn't think I'd be saved by wimps one day."
        [/message]
        [message]
        speaker=Bastard
        message= _ "How many of yours are left?"
        [/message]
        [message]
        speaker=unit
        message= _ "About a half of the warriors, but only a few will reach the river under the blows of the Alliance dogs."
        [/message]
        [message]
        speaker=Bastard
        message= _ "I see. Help us protect the crossing."
        [/message]
        [message]
        speaker=unit
        message= _ "You have no right to order me around, asshole. The chief ordered us to retreat to the mountains and you to defend the crossing. Do as he says."
        [/message]
        [message]
        speaker=Bastard
        message= _ ". . ."
        [/message]
    [/event]

    #orcs goes away from map

    [event]
    name=moveto
    first_time_only=no

        [filter]
        side=2
        [not]
            id=Son
        [/not]
            [filter_location]
                x,y=1,18
                radius=1
            [/filter_location]
        [/filter]

        [kill]
        side=2
        x,y=1,18
        radius=1
        animation=no
        [/kill]
    [/event]

    #defeat condition

    [event]
    name=die
    id=orcs_dead_before_rebellion
    first_time_only=no

        [filter]
        side=2
        [/filter]

        {VARIABLE_OP dead_orcs add 1}

        [if]

            [variable]
                name=dead_orcs
                #ifdef EASY
                numerical_equals=7
                #endif
                #ifdef NORMAL
                numerical_equals=6
                #endif
                #ifdef HARD
                numerical_equals=5
                #endif
            [/variable]

        [then]
            [message]
            speaker=Bastard
            message= _"Almost all of the douchebags have been slaughtered. Now the whole clan will die."
            [/message]
            [endlevel]
            result=defeat
            [/endlevel]
        [/then]

        [else]
        [/else]

        [/if]
    [/event]

    #chief is dead wave

    [event]
    name=turn_12

        [message]
        side=2
        x,y=46,12
        message= _ "Chief... dead! Our chief is dead!"
        [/message]
        [message]
        speaker=Bastard
        message= _ "Are you the last ones?"
        [/message]
        [message]
        side=2
        x,y=46,12
        message= _ "Gurrak took command, he is heroically covering the tail of our column. He will be here soon."
        [/message]
        [message]
        speaker=Bastard
        message= _ "Uh-huh. Then we'll retreat with him."
        [/message]
    [/event]

    #bonus alliance wave

    [event]
    name=turn_11
    first_time_only=yes

        [unit]
        side=3
        {TYPE_ON_DIFFICULTY "Dwarvish Scout" "Dwarvish Scout" "Dwarvish Pathfinder"}
        x,y=6,4
        id=Scout1
        animate=no
        [/unit]

        {MOVE_UNIT id=Scout1 6 5}

        [unit]
        side=3
        name=_ "Alliance Soldier"
        type=Dwarvish Fighter
        x,y=6,4
        id=Scout2
        animate=no
        [/unit]

        {MOVE_UNIT id=Scout2 5 5}

        [unit]
        side=3
        name=_ "Alliance Soldier"
        type=Dwarvish Thunderer
        x,y=6,4
        id=Scout3
        animate=no
        [/unit]

        {MOVE_UNIT id=Scout3 7 5}

        [message]
        speaker=Scout1
        message=_ "I told you this old mine is a way to get behind the orcs!"
        [/message]
        [message]
        speaker=Scout2
        message=_ "We must seize the crossing and be heroes soon, or the general will kill us for leaving the formation."
        [/message]
    [/event]

    #last wave

    [event]
    name=turn_16

        #gurrak after battle

        [unit]
            side=2
            name="Gurrak the Chief"
            role=veteran
            profile=portraits/gurrak.png
            canrecruit=yes
            id=Son
            #ifdef EASY
            type=Orcish Leader
            #else
            type=Orcish Ruler
            #endif
            x=46
            y=12
            animate=yes
        [/unit]
        [unit]
            side=2
            name="Gurrak's Veteran"
            role=veteran
            #ifdef EASY
            type=Orcish Warrior
            #endif
            #ifdef NORMAL
            type=Orcish Warrior
            #endif
            #ifdef HARD
            type=Orcish Warlord
            #endif
            x=46
            y=11
            animate=yes
            [modifications]
                {TRAIT_LOYAL}
            [/modifications]
        [/unit]
        [unit]
            side=2
            name="Gurrak's Veteran"
            role=veteran
            #ifdef EASY
            type=Orcish Warrior
            #endif
            #ifdef NORMAL
            type=Orcish Warrior
            #endif
            #ifdef HARD
            type=Orcish Warlord
            #endif
            x=45
            y=12
            animate=yes
            [modifications]
                {TRAIT_LOYAL}
            [/modifications]
        [/unit]
        [unit]
            name="Gurrak's Veteran"
            side=2
            type="Orcish Warrior"
            role=veteran
            x=46
            y=13
            animate=yes
            [modifications]
                {TRAIT_LOYAL}
            [/modifications]
        [/unit]
        [unit]
            name="Gurrak's Veteran"
            side=2
            type="Orcish Warrior"
            role=veteran
            x=45
            y=13
            animate=yes
            [modifications]
                {TRAIT_LOYAL}
            [/modifications]
        [/unit]

        #alliance shocktroopers

        [unit]
        side=3
        #ifdef EASY
        type=Dwarvish Fighter
        #endif
        #ifdef NORMAL
        type=Dwarvish Fighter
        #endif
        #ifdef HARD
        type=Dwarvish Steelclad
        #endif
        x,y=46,9
        name=_ "Alliance Shocktrooper"
        id=Warrior1
        [modifications]
            {TRAIT_RESILIENT}
            {TRAIT_INTELLIGENT}
        [/modifications]
        [/unit]

        {MOVE_UNIT id=Warrior1 42 9}

        [unit]
        side=3
        #ifdef EASY
        type=Dwarvish Fighter
        #endif
        #ifdef NORMAL
        type=Dwarvish Steelclad
        #endif
        #ifdef HARD
        type=Dwarvish Steelclad
        #endif
        x,y=46,9
        name=_ "Alliance Shocktrooper"
        id=Warrior2
        experience=16
        [modifications]
            {TRAIT_RESILIENT}
            {TRAIT_INTELLIGENT}
        [/modifications]
        [/unit]

        {MOVE_UNIT id=Warrior2 44 10}

        [unit]
        side=4
        #ifdef EASY
        type=Heavy Infantryman
        #endif
        #ifdef NORMAL
        type=Heavy Infantryman
        #endif
        #ifdef HARD
        type=Shock Trooper
        #endif
        x,y=46,15
        name=_ "Alliance Shocktrooper"
        id=Warrior3
        [modifications]
            {TRAIT_RESILIENT}
            {TRAIT_INTELLIGENT}
        [/modifications]
        [/unit]

        {MOVE_UNIT id=Warrior3 42 15}

        [unit]
        side=4
        #ifdef EASY
        type=Heavy Infantryman
        #endif
        #ifdef NORMAL
        type=Shock Trooper
        #endif
        #ifdef HARD
        type=Shock Trooper
        #endif
        x,y=46,15
        name=_ "Alliance Shocktrooper"
        id=Warrior4
        [modifications]
            {TRAIT_RESILIENT}
            {TRAIT_INTELLIGENT}
        [/modifications]
        [/unit]

        {MOVE_UNIT id=Warrior4 44 14}

        #alliane general

        [unit]
        side=3
        id=General
        type=Dwarvish Lord
        canrecruit=yes
        extra_recruit=Dwarvish Steelclad,Shock Trooper
        x,y=46,1
        name=_ "Alliance General"
        [/unit]

        {MOVE_UNIT id=General 41 5}

        [modify_unit]
        [filter]
        id=General
        [/filter]
        facing=sw
        [/modify_unit]

        [delay]
        time=300
        [/delay]

        [message]
        speaker=General
        message=_ "I ordered you to seize the crossing, and it's still standing. What the hell are you doing here, commander?!"
        [/message]
        [message]
        speaker=Commander1
        message=_ "The orcs have proven more tenacious than we anticipated, my lord..."
        [/message]
        [message]
        speaker=General
        message=_ "Idiot, it's all goblins and wimps! Because of incompetents like you, the people of the Dwarven Doors will never be safe. You're demoted to private. Go on the attack, maybe there you'll get some wisdom!"
        [/message]

        [modify_unit]
        [filter]
        id=Commander1
        [/filter]
        canrecruit=no
        id=No_Commander
        [/modify_unit]

        {MOVE_UNIT id=No_Commander 40 3}
        {MOVE_UNIT id=General 42 2}

        [modify_side]
        side=3
        gold=1000

            [ai]
            [aspect]
            id=recruitment_instructions
            [facet]
            [value] 
                [recruit]
                    type=Dwarvish Steelclad,Shock Trooper
                number=30
                [/recruit]
            [/value]
            [/facet]
            [/aspect]
            [/ai]

        [/modify_side]
        
        [message]
        speaker=Son
        message= _"Damn it, the Alliance infantry have caught up with us! Hey, you bastards, cover your new chief with your bodies, it's your turn to die!"
        [/message]

        [objectives]
            silent=no
                [objective]
                    description= _ "Protect Gurrak"
                    condition=win
                [/objective]
                [objective]
                    description= _ "Death of Moog"
                    condition=lose
                [/objective]
                [objective]
                    description= _ "Death of Gurrak"
                    condition=lose
                [/objective]
                [objective]
                    #ifdef EASY
                    description= _ "Death of 7 retreating orcs ($dead_orcs|/7)"
                    #endif
                    #ifdef NORMAL
                    description= _ "Death of 6 retreating orcs ($dead_orcs|/6)"
                    #endif
                    #ifdef HARD
                    description= _ "Death of 5 retreating orcs ($dead_orcs|/5)"
                    #endif
                    condition=lose
                [/objective]
                {TURNS_RUN_OUT}
                [note]
                    description=_"The retreating orcs will try to cross the river and get to the west border of the road."
                [/note]
                [note]
                    description=_"Alliance soldiers prefer to attack retreating orcs rather than your units."
                [/note]
                [gold_carryover]
                    bonus=yes
                    carryover_percentage=20
                [/gold_carryover]
                delayed_variable_substitution=yes
        [/objectives] 
    [event]
    name=new_turn
    id=rebellion_of_moog
    first_time_only=no

        [if]

        [have_unit]
        id=Son
            [filter_location]
                x=1-23
            [/filter_location]
        [/have_unit]

        [then]

        {REPLACE_SCENARIO_MUSIC northerners.ogg}
        {APPEND_MUSIC "frantic.ogg"}
        {APPEND_MUSIC "casualties_of_war.ogg"}
        {APPEND_MUSIC "battle.ogg"}

        [message]
        speaker=Son
        message=_ "Not a bad job, bastards. I thought you'd shit your pants and run as soon as you saw Alliance soldiers."
        [/message]
        [message]
        speaker=Bastard
        message= _"Are we retreating now?"
        [/message]
        [message]
        speaker=Son
        message=_ "You are? No, the enemy is still on our tail, someone has to stop them, and it's gonna be you."
        [/message]
        [message]
        speaker=Bastard
        message= _"But we defeated the Alliance light troops. The heavy infantry can't catch up with us in the hills."
        [/message]
        [message]
        speaker=Son
        message=_ "Shut your stupid mouth. The dwarves will catch up with us, we have to hold them off. The big orcs have sacrificed enough in this war, it's time for the wimps to pay their debt to the clan!"
        [/message]
        [message]
        speaker=Bastard
        message= _"Shut up, asshole!"
        [/message]
        [message]
        speaker=Son
        message= _"What did you say?!"
        [/message]
        [message]
        speaker=Bastard
        message= _"I won't die for scumbags like you."
        [/message]
        [message]
        speaker=Son
        message= _"I knew you were alien to the concept of duty, you're not an orc, you're dirt. Goblins, kill him and hold off the Alliance soldiers!"
        [/message]
        [message]
        side=1
        canrecruit=no
        message= _"No."
        [/message]
        [message]
        speaker=Son
        message= _"The filth decided to rebel, well, I've been wanting to cleanse the clan of extra mouths for a long time!"
        [/message]

        {VARIABLE_OP gurrak_come add 1}

        [modify_side]
        side=2
        team_name=Evil_Orcs
        [/modify_side]

        [micro_ai]
            side=2
            ai_type=simple_attack
            action=add
            ca_score=110000
            [filter]
               side=2
            [/filter]
            [filter_second]
                side=1
            [/filter_second]
        [/micro_ai]
        [micro_ai]
            side=2
            ai_type=goto
            action=change
            release_unit_at_goal=yes
            [filter]
                side=2
                [not]
                    role=veteran
                [/not]
            [/filter]
            [filter_location]
                x,y=1,18
            [/filter_location]
            ca_score=600000
        [/micro_ai]

        [objectives]
            silent=no
            [objective]
                description= _ "Kill Gurrak and all his Veterans"
                condition=win
            [/objective]
            [objective]
                description= _ "Death of Moog"
                condition=lose
            [/objective]
            {TURNS_RUN_OUT}
            [gold_carryover]
                bonus=yes
                carryover_percentage=20
            [/gold_carryover]
        [/objectives]  


        [remove_event]
        id=orcs_dead_before_rebellion
        [/remove_event]
        [remove_event]
        id=rebellion_of_moog
        [/remove_event]

        {CLEAR_VARIABLE dead_orcs} 
        
        [event]
        name=die
        first_time_only=no

            [filter]
                side=2
                role=veteran
            [/filter]
        [if]
            [have_unit]
                side=2
                role=veteran
            [/have_unit]
        [then]
        [/then]

        [else]
            [message]
            speaker=Bastard
            message= _"<i>breathing heavily</i>"
            [/message]
            
            {TRY_SAY_BY_THIS_RACE goblin _"You did the right thing. Gurrak was a shit chief, he would turn our lives into a nightmare."}
            {TRY_SAY_BY_THIS_RACE "wolf,orc" _"No one will know of our rebellion. We'll say Gurrak was killed by Alliance dogs. We'll be safe."}
            [message]
            speaker=Bastard
            message= _"Let's get out of here!"
            [/message]
            
            [endlevel]
            result=victory
            [/endlevel]
        [/else]

        [/if]

        [/event]

        [/then]
        [else]
        [/else]
        [/if]
    [/event]   
    [/event]
    #gurrak death

    [event]
    name=last_breath

        [filter]
        id=Son
        [/filter]
        
    [if]
        [variable]
        name=gurrak_come
        numerical_equals=1
        [/variable]

    [then]
        [message]
        speaker=Son
        message= _"Scumbags... Because of you, our clan will die..."
        [/message]
    [/then]
    [else]
        [message]
        side=1
        canrecruit=no
        message= _"Without a worthy leader, our clan has no future!"
        [/message]
        [endlevel]
        result=defeat
        [/endlevel]
    [/else]
    [/if]
    [/event]

    #moog death - defeat

    [event]
    name=die

        [filter]
        id=Bastard
        [/filter]
        [filter_second]
        side=3
        [/filter_second]

        [message]
        speaker=Bastard
        message=_ "There's nothing worse... Than dying in a war... For those assholes..."
        [/message]
        [endlevel]
        result=defeat
        [/endlevel]
    [/event]
    [event]
    name=die

        [filter]
        id=Bastard
        [/filter]
        [filter_second]
        side=2
        [/filter_second]

        [message]
        speaker=second_unit
        message=_ "I've long wanted to wash away this stain of shame from our clan."
        [/message]
        [message]
        side=1
        canrecruit=no
        message=_ "Don't kill us! We didn't like Moog either, we'll follow orders, we'll hold off the Alliance soldiers!"
        [/message]
        [message]
        speaker=second_unit
        message=_ "That's better, you shit."
        [/message]
        [endlevel]
        result=defeat
        [/endlevel]
    [/event]
    [event]
    name=time_over

        [message]
        speaker=Bastard
        message=_ "Shit, we've lost too much time, now we can't get away from the Alliance soldiers. We're gonna die for the big orcs, just like Gurrak's asshole wanted. Shit!"
        [/message]
        [endlevel]
        result=defeat
        [/endlevel]
    [/event]
[/scenario]

#undef TRY_SAY_BY_THIS_RACE
