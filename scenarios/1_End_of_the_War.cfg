#textdomain wesnoth-DB

#define TRY_SAY_BY_THIS_RACE RACE MES
	[if]
        [have_unit]
            race={RACE}
        [/have_unit]
        [then]
            [message]
            	side=1
            	canrecruit=no
            	race={RACE}
            	message={MES}
            [/message]
        [/then]
        [else]
            [message]
            	side=1
            	canrecruit=no
            	message={MES}
            [/message]
        [/else]
    [/if]
#enddef

[scenario]
    id=1_The_End_of_the_War
    name = _ "Commander of Weaklings"
    random_start_time=no
    experience_modifier=100
    {DB_MAP 1_End_of_the_War.map}
    victory_when_enemies_defeated=no
    next_scenario=2_Breaking_Tradition
    carryover_percentage=40
    carryover_add=yes
    current_time=2

    {TURNS 35 32 30}
    {SCENARIO_MUSIC "loyalists.ogg"}
    {EXTRA_SCENARIO_MUSIC underground.ogg}

    {WINTER_SCHEDULE}
    {EVENTS_FOR_ABILITIES}

    [story]
        [part]
            story= _ "Thirty years ago, Kapou'e Black Eye united the previously quarreling orc clans under his banner. Since then, no one has ever dared to attack this powerful union of clans. The Iron Law of the Supreme Leader quashed any signs of dissent. Season after season, the orcs multiplied. They recovered from the Great War and established new settlements. One gloomy morning, Kapou'e passed away, leaving the union weakened. As the news spread, a taint of suspense and curiosity filled the air."
            {DB_BIGMAP}
        [/part]

        [part]
            story= _"The <i>Straight Blades</i> were a mighty clan, recently founded by veterans of Black Eye's army. Their settlement was located southeast of Black Eye's Union, borderering the Barren Plains. Scattered ogre tribes inhabited these lands. Once common raids were halted by Kapou'e, leaving the wild intruders in isolated nomadic clans. Since this respite, orcs were not the only ones growing in strength and number."
            {DB_BIGMAP}
        [/part]

        [part]
            story= _"Sensing the death of Kapou'e Black Eye and the accompanying news of the weakened unity, the former scattered and isolated ogre tribes gathered a large horde of immense size and sheer willpower. Thousands of hungry, snarling and hooting ogres rallied up and raided the <i>Straight Blades</i>."
            {DB_BIGMAP}
        [/part]

        [part]
            story= _"The orcs fought worthy of their ancestors, but this day the stars aligned in their enemy's favor. The ogres outnumbered and killed all the men. They feasted on the orcish children, and enslaved the remaining women. For three days and three nights, the ogres rampaged through blood-soaked streets."
            {DB_BIGMAP}
        [/part]

        [part]
            story= _"On the fourth day, the ogres burnt the settlement and marched back to their steppes. A breeze of carelessness and the ogre's indistinguishable scent happened to lead an orcish clan known as the <i>Cold Bloods</i> their way. The enraged orcs brought vengeance at the tip of their blades."
            {DB_BIGMAP}
        [/part]

        [part]
            story= _"The <i>Cold Blood</i> warriors massacred the ogres. They freed the captivated women of the former <i>Straight Blades</i>, accepting them into their own clan."
            {DB_BIGMAP}
        [/part]

        [part]
            story= _"As seasons turned, the ogre's onslaught seemed to fade in the orc's memories. But the onslaught shall never be forgotten..."
            {DB_BIGMAP}
        [/part]

        [part]
            story= _"One starlit night, a woman's screech resonated under the moonlight. A former captive of the ogres gave birth. A huge, ugly and fearsome child tore open its mother's womb. The entire hut was drenched in blood. This night gave life to a breed of half-ogre-half-orc, a sinister greeting form the past."
            {DB_BIGMAP}
        [/part]

        [part]
            story= _"Murmurs filled the clan's settlement, leaving everyone at unease. The chieftain demanded to have the newborn killed, as a sign to the orc's superiority. But an old orc shamaness forbade his mouth. The spirits overwhelmed her mind, leaving her will unstained. The clan had to accept this horrific child, or great misfortune would befall them all."
            {DB_BIGMAP}
        [/part]

        [part]
            story= _"Present tribemen's gaze fell upon the shamaness, as if death itself has befallen them. Gritting his teeth, the chieftain agreed to her proposal. He ordered the shamaness to raise the cursed child, for the baby's destiny may be her own fate."
            {DB_BIGMAP}
        [/part]

        [part]
            story= _"The abomination of a baby was named 'Moog,' which translates to 'Dirty' in common tongue. Despite tolerance across the orc clan, true acceptance had long gone. Due to his appearence, Moog was called the 'harmful'."
            {DB_BIGMAP}
        [/part]

        [part]
            story= _"Supervisied by the orcish shamaness, Moog became larger and stronger than any other orc. Orcish traditions proposed a hierarchy of strength, but the clan's arrogance prevented him from challenging even the weakest of orcs, without a dozen of their brute falling upon him."
            {DB_BIGMAP}
        [/part]

        [part]
            story= _"One day, Moog resettled and grew up among goblins. They shared all the humiliation that the wimps were subjected to by the orcs. But Moog himself was no wimp. Sometimes he fought back against orcs, which made him a hero in the other goblins' eyes."
            {DB_BIGMAP}
        [/part]

        [part]
            story= _"But Moog didn't want to be a hero of the weak. His inner will wouldn't stop painting his future self. He starved for true power."
            {DB_BIGMAP}
        [/part]

        [part]
            story= _"As Moog grew older, war came to their borders. The <i>Northern Alliance</i> intruded the orc's lands. Without hesitance, the Supreme Leader called upon the Great Horde. All clans rallied within a couple of days. The chief of the <i>Cold Blood</i> clan put Moog in charge of a goblin war band."
            {DB_BIGMAP}
        [/part]
    [/story]

    {DB_TRACK {JOURNEY_01_NEW} }

    [item]
        image="scenery/mine-abandoned.png"
        visible_in_fog=yes
        x=6
        y=4
    [/item]

    [item]
        image="items/orcish-flag.png"
        visible_in_fog=yes
        x=20
        y=13
    [/item]

    [side]
        controller=human
        side=1
        gold=100
        {MOOG_HARMFUL_WAR_STATS}
        team_name=bastards
        user_team_name= _ "Black Eye's Army"
        recruit=Goblin Spearman,Wolf Rider,Orcish Archer,Orcish Assassin
        fog=yes
        shroud=no

        [unit]
            #TODO: make him a side 2 leader in MP version
            id=Puga
            name=_ "Puga"
            type=Goblin Impaler
            facing=s
            profile=portraits/goblins/rouser-2.png
            [modifications]
                {TRAIT_LOYAL}
                {TRAIT_RESILIENT}
            [/modifications]
            x=20
            y=12
        [/unit]

        [unit]
            name=_ "Goblin Watcher"
            type=Goblin Spearman
            [modifications]
                {TRAIT_RESILIENT}
                {TRAIT_STRONG}
                [object]
                    [effect]
                        apply_to=overlay 
                        add="misc/hearticon.png"
                    [/effect]
                    [effect]
                        apply_to=profile
                        description=_ "To the strongest and toughest of the Cold Blood goblins, the chieftain entrusted a more difficult task than simply dying as fodder. They are to stand watch and guard the crossing on which the rear of the orcish army depends."
                    [/effect]
                [/object]
            [/modifications]
            x=25
            y=10
        [/unit]

        [unit]
            name=_ "Goblin Watcher"
            type=Goblin Spearman
            [modifications]
                {TRAIT_RESILIENT}
                {TRAIT_STRONG}
                [object]
                    [effect]
                        apply_to=overlay 
                        add="misc/hearticon.png"
                    [/effect]
                    [effect]
                        apply_to=profile
                        description=_ "To the strongest and toughest of the Cold Blood goblins, the chieftain entrusted a more difficult task than simply dying as fodder. They are to stand watch and guard the crossing on which the rear of the orcish army depends."
                    [/effect]
                [/object]
            [/modifications]
            x=26
            y=12
        [/unit]

        [unit]
            name=_ "Goblin Watcher"
            type=Goblin Spearman
            [modifications]
                {TRAIT_RESILIENT}
                {TRAIT_STRONG}
                [object]
                    [effect]
                        apply_to=overlay 
                        add="misc/hearticon.png"
                    [/effect]
                    [effect]
                        apply_to=profile
                        description=_ "To the strongest and toughest of the Cold Blood goblins, the chieftain entrusted a more difficult task than simply dying as fodder. They are to stand watch and guard the crossing on which the rear of the orcish army depends."
                    [/effect]
                [/object]
            [/modifications]
            x=15
            y=15
        [/unit]

        [unit]
            name=_ "Goblin Watcher"
            type=Goblin Spearman
            [modifications]
                {TRAIT_RESILIENT}
                {TRAIT_STRONG}
                [object]
                    [effect]
                        apply_to=overlay 
                        add="misc/hearticon.png"
                    [/effect]
                    [effect]
                        apply_to=profile
                        description=_ "To the strongest and toughest of the Cold Blood goblins, the chieftain entrusted a more difficult task than simply dying as fodder. They are to stand watch and guard the crossing on which the rear of the orcish army depends."
                    [/effect]
                [/object]
            [/modifications]
            x=16
            y=17
        [/unit]
    [/side]

    [side]
        controller=ai
        side=2
        team_name=bastards
        user_team_name= _ "Black Eye's Army"

        #It's better to not define colors for easier MP adoptation
        #color=blue

        no_leader=yes
        hidden=no
        share_vision=no
        {BLACK_FLAG}

        [ai]
            [avoid]
                x=10,9,7,5
                y=16,17,17,15
            [/avoid]
        [/ai]

        #Gurrack and his veterans

        [unit]
            name="Gurrak the Chief's Son"
            canrecruit=yes
            profile=portraits/gurrak.png
            facing=nw
            id=Gurrak
            type="Orcish Leader"
            [modifications]
                {TRAIT_RESILIENT}
                {TRAIT_QUICK}
            [/modifications]
            x=23
            y=13
        [/unit]

        [unit]
            type="Orcish Warrior"
            name=_ "Gurrak's Guard"
            [modifications]
                {TRAIT_STRONG}
                {TRAIT_LOYAL}
            [/modifications]
            x=22
            y=12
            id=guard1
        [/unit]

        [unit]
            type="Orcish Warrior"
            name=_ "Gurrak's Guard"
            [modifications]
                {TRAIT_STRONG}
                {TRAIT_LOYAL}
            [/modifications]
            x=22
            y=13
            id=guard2
        [/unit]

        [unit]
            type="Orcish Warrior"
            name=_ "Gurrak's Guard"
            [modifications]
                {TRAIT_STRONG}
                {TRAIT_LOYAL}
            [/modifications]
            x=23
            y=14
            id=guard3
        [/unit]
    [/side]

    [side]
        defeat_condition=never
        controller=ai
        side=3
        team_name=alliance
        user_team_name= _ "Northern Alliance's Army"
        no_leader=yes
        #color=green
        hidden=no
        fog=no
        shroud=no
        {FLAG_VARIANT knalgan}

        [ai]
            [goal]
                name=target_unit 
                [criteria]
                    type_adv_tree="Orcish Grunt"
                [/criteria]
                value={ON_DIFFICULTY 1 2 3}
            [/goal]
        [/ai]
    [/side]

    #prestart event: villages, variables, objectives

    [event]
    name=prestart

        {CAPTURE_VILLAGES_OF_TYPE Rb^Vct,Re^Vct 1 19 13 20}

        [set_variable]
            name=dead_orcs
            value=0
        [/set_variable]
        [set_variable]
            name=gurrak_come
            value=0
        [/set_variable]

        [objectives]
            silent=yes
                [objective]
                    description=_ "Protect fortifications along the road"
                    condition=win
                [/objective]

                [objective]
                    description= _ "Death of Moog"
                    condition=lose
                [/objective]

                {TURNS_RUN_OUT}

                [gold_carryover]
                    bonus=yes
                    carryover_percentage=40
                [/gold_carryover]

                [note]
                    description=_"In this campaign, Goblin Impalers have additional level 2 advancements."
                [/note]

                [note]
                    description=_"Moog has a lot of hate. Killing enemies fuels it, increasing the damage of his attacks and making his enemies fear him."
                [/note]
        [/objectives]    
    [/event]

    #start: dialogue, moving Gurrak, prepare to defense

    [event]
    name=start

        [message]
            speaker=Gurrak
            message= _ "Useless bastards! If it were up to me, you'd all die in the front lines! But the chief ordered you to guard the crossing, so you'll sit on your asses in the rear."
        [/message]

        [message]
            speaker=Gurrak
            message= _ "I'm going to war, to shed blood like a true orc. If any of you freaks are off duty when I get back, I'll slaughter this wimp where he stands. And don't expect to share in the spoils of war."
        [/message]
       
        [store_unit]
            [filter]
                id=Gurrak 
            [/filter]
            kill=yes 
            variable=gurrak 
        [/store_unit]

        [move_unit_fake]
            type="Orcish Leader"
            side=2 #MP!
            x=23,35
            y=13,12
        [/move_unit_fake]

        [store_unit]
            [filter]
                id=guard1
            [/filter]
            kill=yes 
            variable=guard1
        [/store_unit]

        [move_unit_fake]
            type="Orcish Warrior"
            side=2 #MP!
            x=22,35
            y=12,12
        [/move_unit_fake]

        [store_unit]
            [filter]
                id=guard2
            [/filter]
            kill=yes 
            variable=guard2
        [/store_unit]

        [move_unit_fake]
            type="Orcish Warrior"
            side=2 #MP!
            x=22,35
            y=13,12
        [/move_unit_fake]

        [store_unit]
            [filter]
                id=guard3
            [/filter]
            kill=yes 
            variable=guard3
        [/store_unit]

        [move_unit_fake]
            type="Orcish Warrior"
            side=2 #MP!
            x=23,35
            y=14,12
        [/move_unit_fake]

        [message]
            speaker=Puga
            message= _"Don't care what he says, better to sit in the rear than be fodder for these huge piles of shit."
        [/message]

        [message]
            speaker=narrator
            image=wesnoth-icon.png
            message= _"A few hours later..."
        [/message]

        [replace_schedule]
            {WINTER_SCHEDULE}
            current_time=3
        [/replace_schedule]

        [modify_side]
            side=1
            fog=no 
        [/modify_side]

        [redraw][/redraw]

        [message]
            speaker=Puga
            message= _"I've spotted the Alliance weasels! They're sniffing around!"
        [/message]

        #North:

        {GENERIC_UNIT 3 {ON_DIFFICULTY "Cavalryman" "Dragoon" "Dragoon"} 44 1}
        {GENERIC_UNIT 3 Cavalryman 24 1}

        #South:

        {GENERIC_UNIT 3 {ON_DIFFICULTY "Cavalryman" "Dragoon" "Dragoon"} 39 22}
        {GENERIC_UNIT 3 Cavalryman 45 17}
       
        [scroll_to_unit]
            x,y=44,1
        [/scroll_to_unit]

        [delay]
            time=500
        [/delay]

        [scroll_to_unit]
            x,y=39,22
        [/scroll_to_unit]

        [delay]
            time=500
        [/delay]

        [message]
            speaker=Bastard
            message= _"Let's chase them away."
        [/message]
    [/event]

    #Alliance Forces Spawn:

    [event]
    name=turn_5

        {REPLACE_SCENARIO_MUSIC the_city_falls.ogg}
        {APPEND_MUSIC "casualties_of_war.ogg"}
        {APPEND_MUSIC "loyalists.ogg"}
        {APPEND_MUSIC "battle.ogg"}

        [move_unit_fake]
            type={ON_DIFFICULTY "Goblin Knight" "Wolf Rider" "Wolf Rider"}
            side=1
            x=46,36,29,22
            y=12,12,11,14
        [/move_unit_fake]

        [unit]
            id=messenger
            #ifdef EASY
                type=Goblin Knight
                hitpoints=35
                experience=4
            #endif
            #ifdef NORMAL
                type=Wolf Rider
                hitpoints=20
                experience=16
            #endif
            #ifdef HARD
                type=Wolf Rider
                hitpoints=20
                experience=16
            #endif
            [modifications]
                {TRAIT_STRONG}
                {TRAIT_QUICK}
            [/modifications]
            x,y=22,14
        [/unit]

        [message]
            speaker=messenger
            message= _"Trouble, trouble, everyone's fleeing! The battle... lost! Supreme Leader... missing! The Great Horde... defeated! Many clans have been slaughtered! We've been lucky, most of the warriors of our clan survived, they rushing here, but the Alliance skirmishers are on their tail, the chief ordered you to protect the crossing!"
        [/message]

        [message]
            speaker=Bastard
            message= _"Smells like a big fight. Shit! I don't want to spill blood for these assholes. But we don't have a choice."
        [/message]

        [micro_ai]
            side=2 #MP!
            ai_type=goto
            action=add
            release_unit_at_goal=yes
            [filter]
                side=2 #MP!
            [/filter]
            [filter_location]
                x,y=1,18
            [/filter_location]
            ca_score=600000
        [/micro_ai]

        #ai for alliance

        [micro_ai]
            side=3 #MP!
            ai_type=simple_attack
            action=add
            ca_score=110000
            [filter]
                race=human,dwarf
                canrecruit=no
            [/filter]
            [filter_second]
                side=2 #MP!
            [/filter_second]
        [/micro_ai]
    [/event]

    [event]
    name=turn 6,turn 10,turn 14,turn 16
    first_time_only=no

        {REPEAT 3 (
            [unit]
                type=Orcish Grunt
                side=2 #MP!
                x,y=46,12
                animate=yes
                role=retreat
            [/unit])}

        [unit]
            type=Orcish Warrior
            side=2 #MP!
            x,y=46,12
            animate=yes
            role=retreat
        [/unit]

        #MP!

        {SPAWN_UNIT 3 {ON_DIFFICULTY Sergeant Lieutenant Lieutenant} 37 1 37 2}
        #ifndef EASY
        {SPAWN_UNIT 3 Spearman 36 0 36 1}
        #endif
        #ifdef HARD
        {SPAWN_UNIT 3 Javelineer 38 0 38 1}
        #endif
        {SPAWN_UNIT 3 Bowman  35 1 35 2}
        {SPAWN_UNIT 3 Spearman 36 1 36 2}
        {SPAWN_UNIT 3 Spearman 38 1 38 2}
        {SPAWN_UNIT 3 Bowman 39 1 39 2}

        [scroll_to]
            x,y=39,22
        [/scroll_to]

        {SPAWN_UNIT 3 {ON_DIFFICULTY Sergeant Lieutenant Lieutenant} 41 26 39 22}
        #ifndef EASY
        {SPAWN_UNIT 3 Spearman 41 26 38 22}
        #endif
        #ifdef HARD
        {SPAWN_UNIT 3 Longbowman 41 26 40 22}
        #endif
        {SPAWN_UNIT 3 Bowman  41 26 37 22}
        {SPAWN_UNIT 3 Spearman 41 26 38 21}
        {SPAWN_UNIT 3 Spearman 41 26 40 21}
        {SPAWN_UNIT 3 Bowman 41 26 41 22}

        [delay]
            time=300
        [/delay]

        [fire_event]
            name=first dialog
        [/fire_event]
    [/event]

    [event]
    name=first dialog

        [message]
            type={ON_DIFFICULTY Sergeant Lieutenant Lieutenant}
            message= _ "We're ahead of the stinking orcs! Now let's take the crossing and cut them off."
        [/message]

        [scroll_to_unit]
            x,y=46,12
        [/scroll_to_unit]

        [message]
            speaker=messenger
            message= _ "There they are, our clansmen on the horizon!"
        [/message]

        [message]
            speaker=Bastard
            message= _ "I hope our dumbasses move their asses."
        [/message]

        [objectives]
            silent=no
            delayed_variable_substitution=yes

            [objective]
                description= _ "Protect the retreating orcs"
                condition=win
            [/objective]

            [objective]
                description= _ "Death of Moog"
                condition=lose
            [/objective]

            [objective]
                description= _ "Death of 8 retreating orcs ($dead_orcs|/8)"
                condition=lose
            [/objective]

            {TURNS_RUN_OUT}

            [gold_carryover]
                    bonus=yes
                    carryover_percentage=40
            [/gold_carryover]

            [note]
                description=_"The retreating orcs will try to cross the river and get to the west border of the road."
            [/note]

            [note]
                description=_"Alliance soldiers prefer to attack retreating orcs rather than your units."
            [/note]
        [/objectives] 
    [/event]  

    [event]
    name=moveto
    first_time_only=yes

        [filter]
            type_adv_tree="Orcish Grunt"
            [filter_location]
                x,y=21,14
                radius=3
            [/filter_location]
        [/filter]

        [message]
            speaker=unit
            message= _ "I didn't think I'd be saved by wimps one day."
        [/message]

        [message]
            speaker=Bastard
            message= _ "How many of yours are left?"
        [/message]

        [message]
            speaker=unit
            message= _ "About a half of the warriors, but only a few will reach the river under the blows of the Alliance dogs."
        [/message]

        [message]
            speaker=Bastard
            message= _ "I see. Help us protect the crossing."
        [/message]

        [message]
            speaker=unit
            message= _ "You have no right to order me around, asshole. The chief ordered us to retreat to the mountains and you to defend the crossing. Do as he says."
        [/message]

        [message]
            speaker=Bastard
            message= _ ". . ."
        [/message]
    [/event]

    #Orcs go away from map:

    [event]
    name=moveto
    first_time_only=no

        [filter]
            type_adv_tree="Orcish Grunt"
            [not]
                id=Gurrak
            [/not]
            [filter_location]
                x,y=1,18
                radius=1
            [/filter_location]
        [/filter]

        [kill]
            x,y=1,18
            radius=1
            animation=no
        [/kill]
    [/event]

    #Defeat condition:

    [event]
    name=die
    id=orcs_dead_before_rebellion
    first_time_only=no

        [filter]
            type_adv_tree="Orcish Grunt"
        [/filter]

        {VARIABLE_OP dead_orcs add 1}

        [if]

            [variable]
                name=dead_orcs
                numerical_equals=8
            [/variable]

        [then]
            [message]
                speaker=Bastard
                message= _"Almost all of the douchebags have been slaughtered. Now the whole clan will die."
            [/message]

            [endlevel]
                result=defeat
            [/endlevel]
        [/then]

        [else]
        [/else]

        [/if]
    [/event]

    #Chief is dead wave:

    [event]
    name=turn_16

        [message]
            x,y=46,12
            message= _ "Chief... dead! Our chief is dead!"
        [/message]

        [message]
            speaker=Bastard
            message= _ "Are you the last ones?"
        [/message]

        [message]
            x,y=46,12
            message= _ "Gurrak took command, he is heroically covering the tail of our column. He will be here soon."
        [/message]

        [message]
            speaker=Bastard
            message= _ "Uh-huh. Then we'll retreat with him."
        [/message]
    [/event]

    #bonus alliance wave if it's not easy diff
    #ifndef EASY

    [event]
    name=turn_11
    first_time_only=yes

        [unit]
            side=3 #MP!
            type={ON_DIFFICULTY "Dwarvish Miner" "Dwarvish Scout" "Dwarvish Pathfinder"}
            x,y=6,4
            id=DScout1
            animate=no
        [/unit]

        {MOVE_UNIT id=DScout1 6 5}

        [unit]
            side=3 #MP!
            name=_ "Alliance Soldier"
            type=Dwarvish Fighter
            x,y=6,4
            id=DScout2
            animate=no
        [/unit]

        {MOVE_UNIT id=DScout2 5 5}

        [unit]
            side=3 #MP!
            name=_ "Alliance Soldier"
            type=Dwarvish Thunderer
            x,y=6,4
            id=DScout3
            animate=no
        [/unit]

        {MOVE_UNIT id=DScout3 7 5}

        [message]
            speaker=DScout1
            message=_ "I told you this old mine is a way to get behind the orcs!"
        [/message]

        [message]
            speaker=DScout2
            message=_ "We must seize the crossing and be heroes soon, or the general will kill us for leaving the formation."
        [/message]
    [/event]
#endif

    #Last wave:

    [event]
    name=turn_20

        #gurrak after battle

        {VARIABLE gurrak.experience 13}
        {VARIABLE guard1.experience 34}
        {VARIABLE guard2.experience 18}
        {VARIABLE guard3.experience 23}

        [unstore_unit]
            variable=gurrak 
            find_vacant=yes 
            x,y=46,12
            animate=yes 
        [/unstore_unit]

        {TRANSFORM_UNIT id=Gurrak "Orcish Ruler"}
        {MODIFY_UNIT id=Gurrack hitpoints 55}

        [unstore_unit]
            variable=guard1
            find_vacant=yes 
            x,y=46,12
            animate=yes 
        [/unstore_unit]

        {MODIFY_UNIT id=guard1 hitpoints 50}

        [unstore_unit]
            variable=guard2
            find_vacant=yes 
            x,y=46,12
            animate=yes 
        [/unstore_unit]

        {MODIFY_UNIT id=guard2 hitpoints 51}

        [unstore_unit]
            variable=guard3
            find_vacant=yes 
            x,y=46,12
            animate=yes 
        [/unstore_unit]

        {MODIFY_UNIT id=guard3 hitpoints 47}

        #Alliance shocktroopers:

        {SPAWN_UNIT 3 {ON_DIFFICULTY "Dwarvish Fighter" "Dwarvish Steelclad" "Dwarvish Steelclad"} 46 9 42 9}
        {SPAWN_UNIT 3 "Dwarvish Fighter" 46 9 44 10}
        {SPAWN_UNIT 3 {ON_DIFFICULTY "Heavy Infantryman" "Shock Trooper" "Shock Trooper"} 46 15 42 15}
        {SPAWN_UNIT 3 "Heavy Infantryman" 46 15 44 14}

        #Alliane general

        [unit]
            side=3
            id="General Dunrol"
            type=Dwarvish Lord
            canrecruit=yes
            x,y=46,1
            name=_ "General Dunrol"
            ai_special=guardian
        [/unit]

        {MOVE_UNIT id="General Dunrol" 42 2}

        [unit]
            side=3
            type=Halberdier
            name=_ "Bodyguard"
            id=bodyguard1 
            [modifications]
                {TRAIT_LOYAL}
            [/modifications]
            x,y=46,1
            ai_special=guardian
        [/unit]

        {MOVE_UNIT id=bodyguard1  42 2}

        [unit]
            side=3
            type=Halberdier
            name=_ "Bodyguard"
            id=bodyguard2
            [modifications]
                {TRAIT_LOYAL}
            [/modifications]
            x,y=46,1
            ai_special=guardian
        [/unit]

        {MOVE_UNIT id=bodyguard2 42 2}

        [modify_unit]
            [filter]
                id="General Dunrol"
            [/filter]
            facing=sw
        [/modify_unit]

        [delay]
            time=300
        [/delay]

        [message]
            speaker="General Dunrol"
            message=_ "I ordered you to seize the crossing, and it's still standing. What the hell are you doing here, soldiers?!"
        [/message]

        [message]
            [filter_side]
                [enemy_of]
                    side=1
                [/enemy_of]
            [/filter_side]
            canrecruit=no
            [not]
                type=Halberdier
            [/not]
            message=_ "The orcs have proven more tenacious than we anticipated, my lord..."
        [/message]

        [message]
            speaker="General Dunrol"
            message=_ "Idiot, it's all goblins and wimps! Because of incompetents like you, the people of the Dwarven Doors will never be safe. You're demoted to private. Go on the attack, maybe there you'll get some wisdom!"
        [/message]
        
        [message]
            speaker=Gurrak
            message= _"Damn it, the Alliance infantry have caught up with us! Hey, you bastards, cover your new chief with your bodies, it's your turn to die!"
        [/message]

        [objectives]
            silent=no
                [objective]
                    description= _ "Protect Gurrak"
                    condition=win
                [/objective]
                [objective]
                    description= _ "Death of Moog"
                    condition=lose
                [/objective]
                [objective]
                    description= _ "Death of Gurrak"
                    condition=lose
                [/objective]
                [objective]
                    description= _ "Death of 8 retreating orcs ($dead_orcs|/8)"
                    condition=lose
                [/objective]
                {TURNS_RUN_OUT}
                [note]
                    description=_"The retreating orcs will try to cross the river and get to the west border of the road."
                [/note]
                [note]
                    description=_"Alliance soldiers prefer to attack retreating orcs rather than your units."
                [/note]
                [gold_carryover]
                    bonus=yes
                    carryover_percentage=40
                [/gold_carryover]
                delayed_variable_substitution=yes
        [/objectives] 

        [event]
        name=turn 20,turn 23, turn 26,turn 29,turn 32,turn 35,turn 38
        first_time_only=no 

            {SPAWN_UNIT 3 "Dwarvish Steelclad" 37 1 37 2}
            {SPAWN_UNIT 3 "Dwarvish Steelclad" 35 1 35 2}
            {SPAWN_UNIT 3 "Dwarvish Steelclad" 36 1 36 2}
            {SPAWN_UNIT 3 "Dwarvish Steelclad" 38 1 38 2}
            {SPAWN_UNIT 3 "Dwarvish Steelclad" 39 1 39 2}

            [scroll_to]
                x,y=39,22
            [/scroll_to]

            {SPAWN_UNIT 3 "Shock Trooper" 41 26 39 22}
            {SPAWN_UNIT 3 "Shock Trooper" 41 26 37 22}
            {SPAWN_UNIT 3 "Shock Trooper" 41 26 38 22}
            {SPAWN_UNIT 3 "Shock Trooper" 41 26 40 22}
            {SPAWN_UNIT 3 "Shock Trooper" 41 26 41 22}

            [delay]
                time=300
            [/delay]
        [/event]

        [event]
        name=new_turn
        id=rebellion_of_moog
        first_time_only=no

            [if]
                [have_unit]
                    id=Gurrak
                    [filter_location]
                        x=1-23
                    [/filter_location]
                [/have_unit]

            [then]

            {INCIDENTAL_MUSIC northerners.ogg}

            [message]
                speaker=Gurrak
                message=_ "Not a bad job, bastards. I thought you'd shit your pants and run as soon as you saw Alliance soldiers."
            [/message]

            [message]
                speaker=Bastard
                message= _"Are we retreating now?"
            [/message]

            [message]
                speaker=Gurrak
                message=_ "You are? No, the enemy is still on our tail, someone has to stop them, and it's gonna be you."
            [/message]

            [message]
                speaker=Bastard
                message= _"But we defeated the Alliance light troops. The heavy infantry can't catch up with us in the hills."
            [/message]

            [message]
                speaker=Gurrak
                message=_ "Shut your stupid mouth. The dwarves will catch up with us, we have to hold them off. The big orcs have sacrificed enough in this war, it's time for the wimps to pay their debt to the clan!"
            [/message]

            [message]
                speaker=Bastard
                message= _"Shut up, asshole!"
            [/message]

            [message]
                speaker=Gurrak
                message= _"What did you say?!"
            [/message]

            [message]
                speaker=Bastard
                message= _"I won't die for scumbags like you."
            [/message]

            [message]
                speaker=Gurrak
                message= _"I knew you were alien to the concept of duty, you're not an orc, you're dirt. Goblins, kill him and hold off the Alliance soldiers!"
            [/message]

            [message]
                side=1
                canrecruit=no
                message= _"No."
            [/message]

            [message]
                speaker=Gurrak
                message= _"The filth decided to rebel, well, I've been wanting to cleanse the clan of extra mouths for a long time!"
            [/message]

            {VARIABLE_OP gurrak_come add 1}

            [modify_side]
                side=1 #MP!
                team_name=evil_orcs
                user_team_name=_ "Cold Blood Bastards"
                {FLAG_VARIANT ragged}
            [/modify_side]

            [modify_side]
                side=2 #MP!
                team_name=evil_orcs
                user_team_name=_ "Cold Blood Warriors"
                {FLAG_VARIANT ragged}
            [/modify_side]

            [micro_ai]
                side=2 #MP!
                ai_type=simple_attack
                action=add
                ca_score=110000
                [filter]
                    role=veteran
                    [or]
                        id=Gurrack
                    [/or]
                [/filter]
                [filter_second]
                    side=1 #MP!
                [/filter_second]
            [/micro_ai]

            [micro_ai]
                side=2 #MP!
                ai_type=goto
                action=change
                release_unit_at_goal=yes
                [filter]
                    side=2 #MP!
                    [not]
                        role=veteran
                    [/not]
                [/filter]
                [filter_location]
                    x,y=1,18
                [/filter_location]
                ca_score=600000
            [/micro_ai]

            [objectives]
                silent=no
                [objective]
                    description= _ "Kill Gurrak and all his Veterans"
                    condition=win
                [/objective]
                [objective]
                    description= _ "Death of Moog"
                    condition=lose
                [/objective]
                {TURNS_RUN_OUT}
                [gold_carryover]
                    bonus=yes
                    carryover_percentage=40
                [/gold_carryover]
            [/objectives]  


            [remove_event]
                id=orcs_dead_before_rebellion
            [/remove_event]
            [remove_event]
                id=rebellion_of_moog
            [/remove_event]

            {CLEAR_VARIABLE dead_orcs} 
            
            [event]
            name=die
            first_time_only=no

                [filter]
                    side=2 #MP!
                    role=veteran
                [/filter]
            [if]
                [have_unit]
                    side=2 #MP!
                    role=veteran
                [/have_unit]
            [then]
            [/then]

            [else]
                [message]
                    speaker=Bastard
                    message= _"<i>breathing heavily</i>"
                [/message]
                
                {TRY_SAY_BY_THIS_RACE goblin _"You did the right thing. Gurrak was a shit chief, he would turn our lives into a nightmare."}
                {TRY_SAY_BY_THIS_RACE "wolf,orc" _"No one will know of our rebellion. We'll say Gurrak was killed by Alliance dogs. We'll be safe."}

                [message]
                    speaker=Bastard
                    message= _"Let's get out of here!"
                [/message]
                
                [endlevel]
                result=victory
                [/endlevel]
            [/else]

            [/if]

            [/event]

            [/then]
            [else]
            [/else]
            [/if]
        [/event]   
    [/event]
    #gurrak death

    [event]
    name=last_breath

        [filter]
            id=Gurrak
        [/filter]
        
        [if]
            [variable]
                name=gurrak_come
                numerical_equals=1
            [/variable]

        [then]
            [message]
                speaker=Gurrak
                message= _"Scumbags... Because of you, our clan will die..."
            [/message]
        [/then]
        [else]
            [message]
                side=1
                canrecruit=no
                message= _"Without a worthy leader, our clan has no future!"
            [/message]
            [endlevel]
                esult=defeat
            [/endlevel]
        [/else]
        [/if]
    [/event]

    #moog death - defeat

    [event]
    name=die

        [filter]
            id=Bastard
        [/filter]

        [filter_second]
            race=human,dwarf
        [/filter_second]

        [message]
            speaker=Bastard
            message=_ "There's nothing worse... Than dying in a war... For those assholes..."
        [/message]

        [endlevel]
            result=defeat
        [/endlevel]
    [/event]

    [event]
    name=die

        [filter]
            id=Bastard
        [/filter]
        [filter_second]
            race=orc
        [/filter_second]

        [message]
            speaker=second_unit
            message=_ "I've long wanted to wash away this stain of shame from our clan!"
        [/message]

        [message]
            side=1
            canrecruit=no
            message=_ "Don't kill us! We didn't like Moog either, we'll follow orders, we'll hold off the Alliance soldiers!"
        [/message]

        [message]
            speaker=second_unit
            message=_ "That's better, you shit."
        [/message]

        [endlevel]
            result=defeat
        [/endlevel]
    [/event]

    [event]
    name=time_over

        [message]
            speaker=Bastard
            message=_ "Shit, we've lost too much time, now we can't get away from the Alliance soldiers. We're gonna die for the big orcs, just like Gurrak's asshole wanted. Shit!"
        [/message]

        [endlevel]
            result=defeat
        [/endlevel]
    [/event]
[/scenario]

#undef TRY_SAY_BY_THIS_RACE
