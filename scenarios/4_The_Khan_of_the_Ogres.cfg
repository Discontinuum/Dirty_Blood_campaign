#textdomain wesnoth-DB
[scenario]
    id=4_The_Khan_of_the_Ogres
    name = _ "The Khan of the Ogres"
    random_start_time=no
    experience_modifier=100
    map_data="{~add-ons/Dirty_Blood/maps/4_The_Khan_of_the_Ogres.map}"
    victory_when_enemies_defeated=no
    next_scenario=5_The_Orc_State
    carryover_percentage=20
    carryover_add=yes
    current_time=dusk

    {TURNS 36 32 30}
    {EVENTS_FOR_ABILITIES}

    {SCENARIO_MUSIC "breaking_the_chains.ogg"}
    {EXTRA_SCENARIO_MUSIC "loyalists.ogg"}
    {EXTRA_SCENARIO_MUSIC "casualties_of_war.ogg"}
    {EXTRA_SCENARIO_MUSIC "battle.ogg"}

    {WINTER_SCHEDULE}

    [story]
    [part]
    story= _ "By the end of the week, none of the orcs could bring anything that compared to the hide of the avatar of the Hunt. To the surprise of all the orcs, Moog became the clan chief."
    [/part]
    [part]
    story= _ "The goblins cheerfully embraced Moog. But many Orcs were wary of the new leader. Moog himself was no defender of the weak, and he made no difference in the life of the clan. He was as hard and cruel a leader as any."
    [/part]
    [part]
    story= _ "Ka'ah tried her best to influence Moog. At first he obeyed and simply carried out her secret instructions. But soon the half-blood chief got a taste of power and wanted to rule himself."
    [/part]
    [part]
    story= _ "The matter was aggravated by the foul rumors Lokra was spreading. Orc discontent was growing. No one liked a weak chieftain ruled by an old woman. The clan was on the verge of rebellion."
    [/part]
    [part]
    story= _ "Ka'ah was telling Moog to be patient and promised to fix all the problems herself. But Moog didn't want to be patient. He wanted to assert himself as a chief in his own right, and to gain a firm foothold in his power."
    [/part]
    [part]
    story= _ "Mursha saw another possibility. The lands of the nomadic ogres that the Coldblood Clan defeated twenty years ago have been taken over by the Deadwood Clan. The leader of the Dead Tree turned the ogres into slaves. In recent months, rumors have spread among the orcs that he ogres have been revolting time and again. Moog, as heir to the Khan of the Ogres, could free the slaves, and make them into a loyal guard. "
    [/part]
    [part]
    story= _ "Moog ordered the orcs to prepare for war. Ka'ah tried to stop him. At sunset, in front of all the warriors, Moog declared that he was the leader and only he could decide when to start the war. To the cheers of the orcs and goblins, Moog marched into the lands of the DeadWood Clan..."
    [/part]
    [/story]

[item]
	image="items/orcish-flag.png"
	visible_in_fog=yes
	x=7
	y=29
[/item]
[item]
	image="items/orcish-flag.png"
	visible_in_fog=yes
	x=8
	y=31
[/item]
[item]
	image="items/orcish-flag.png"
	visible_in_fog=yes
	x=18
	y=13
[/item]
[item]
	image="items/burial.png"
	visible_in_fog=yes
	x=22
	y=20
[/item]
[item]
	image="items/orcish-flag.png"
	visible_in_fog=yes
	x=30
	y=23
[/item]
[item]
	image="scenery/trash.png"
	visible_in_fog=yes
	x=31
	y=13
[/item]
[item]
	image="scenery/trash.png"
	visible_in_fog=yes
	x=33
	y=4
[/item]
[item]
	image="items/bonestack.png"
	visible_in_fog=yes
	x=34
	y=14
[/item]
[item]
	image="items/bonestack.png"
	visible_in_fog=yes
	x=37
	y=16
[/item]
[item]
	image="scenery/icepack-1.png"
	visible_in_fog=yes
	x=42
	y=1
[/item]
[item]
	image="scenery/icepack-1.png"
	visible_in_fog=yes
	x=42
	y=3
[/item]
[item]
	image="scenery/wreck-3.png"
	visible_in_fog=yes
	x=46
	y=8
[/item]
[item]
	image="scenery/trash.png"
	visible_in_fog=yes
	x=46
	y=12
[/item]
[item]
	image="scenery/icepack-1.png"
	visible_in_fog=yes
	x=47
	y=5
[/item]
[item]
	image="scenery/icepack-1.png"
	visible_in_fog=yes
	x=47
	y=7
[/item]
[item]
	image="scenery/icepack-1.png"
	visible_in_fog=yes
	x=50
	y=6
[/item]
[item]
	image="scenery/wreck.png"
	visible_in_fog=yes
	x=50
	y=11
[/item]
[item]
	image="scenery/wreck-2.png"
	visible_in_fog=yes
	x=51
	y=14
[/item]
[item]
	image="scenery/icepack-1.png"
	visible_in_fog=yes
	x=52
	y=10
[/item]
    [side]
        controller=human
        side=1
        {GOLD 200 180 160}
        {MOOG_HARMFUL_STATS}
        team_name=bastards
        user_team_name= _ "ColdBlood clan"
        recruit=Goblin Spearman,Wolf Rider,Orcish Archer,Goblin Impaler, Novice Orcish Witch,Orcish Assassin
        color=red
        fog=no
        shroud=no
    [/side]
    [side]
    controller="ai"
    side=2
    {GOLD 100 120 150}
    {INCOME 5 10 15}
    id=Slaver_Wood
    type=Orcish Warrior
    name="DeadWood Overseer"
    recruit=Orcish Grunt,Orcish Archer
    hidden=no
    share_vision="all"
    shroud=no
    fog=no
    team_name=slavers
    user_team_name=_"DeadWood clan"
    color=green
    {SCENARIO_4_OVERSEERS_AI}
    [unit]
        id=Deputy
		type="Orcish Grunt"
		x=17
		y=12
	[/unit]
	[unit]
		type="Orcish Grunt"
		x=23
		y=13
	[/unit]
	[unit]
		type="Orcish Grunt"
		x=12
		y=15
	[/unit]
    [/side]
    [side]
    controller="ai"
    side=3
    {GOLD 100 120 150}
    {INCOME 5 10 15}
    id=Slaver_Farm
    type=Orcish Warrior
    name=_"DeadWood Overseer"
    recruit=Orcish Grunt,Orcish Archer
    hidden=no
    share_vision="all"
    shroud=no
    fog=no
    team_name=slavers
    user_team_name=_"DeadWood clan"
    color=green
    {SCENARIO_4_OVERSEERS_AI}
    [unit]
		type="Orcish Grunt"
		x=32
		y=22
	[/unit]
	[unit]
		type="Orcish Grunt"
		x=28
		y=24
	[/unit]
	[unit]
		type="Orcish Grunt"
		x=40
		y=21
	[/unit]
    [/side]
    [side]
    controller="ai"
    side=4
    gold=0
    id=Slaver_Main
    type=Orcish Warlord
    name=_"Turge the Enslaver"
    recruit=
    hidden=no
    share_vision="all"
    shroud=no
    fog=no
    team_name=slavers
    user_team_name=_"DeadWood clan"
    color=green
    {SCENARIO_4_SLAVER_ARMY}
    [/side]
    [side]
        controller=ai
        side=5
        team_name=bastards
        user_team_name= _ "Slaves"
        color=teal
        no_leader=yes
        hidden=no
        share_vision=no
        {SCENARIO_4_FARM_SLAVES}
        {SCENARIO_4_WOOD_SLAVES}
    [/side]

#prestart event - micro ais, recalls, wolves

[event]
name=prestart
        [micro_ai]
            side=5
            ai_type=simple_attack
            action=add
            ca_score=300000
            [filter]
                race=ogre
            [/filter]
            [filter_second]
                side=2,3
                [not]
                canrecruit=yes
                [/not]
            [/filter_second]
        [/micro_ai]
        [micro_ai]
            side=2
            ai_type=coward
            action=add
            [filter]
            type=Young Ogre
            [/filter]
            [filter_second]
            side=4
            [/filter_second]
            distance=4
            avoid_x,avoid_y=39,10
            radius=11
            attack_if_trapped=yes
            ca_score=300000
        [/micro_ai]
        [micro_ai]
            side=2
            ai_type=simple_attack
            action=add
            ca_score=300000
            [filter]
                type=Orcish Grunt,Orcish Archer,Wolf
            [/filter]
            [filter_second]
                side=5
            [/filter_second]
        [/micro_ai]
        [micro_ai]
            side=3
            ai_type=simple_attack
            action=add
            ca_score=300000
            [filter]
                type=Orcish Grunt,Orcish Archer,Wolf
            [/filter]
            [filter_second]
                side=5
            [/filter_second]
        [/micro_ai]
        [modify_unit]
            [filter]
                side=5
                max_moves=0
            [/filter]
            upkeep=0
        [/modify_unit]
#Mursha
        [recall]
        id=Mursha
        x,y=11,27
        [/recall]
[/event]

#wolves

{WOLF_CAGE 20 14 2}
{WOLF_CAGE 9 16 2}
{WOLF_CAGE 24 10 2}

{WOLF_CAGE 34 20 3}
{WOLF_CAGE 25 25 3}
{WOLF_CAGE 41 21 3}

#villages

{STARTING_VILLAGES_ALL 4}

[event]
name=start

    [set_variable]
    name=saved_ogres
    value=0
    [/set_variable]
    [set_variable]
    name=dead_ogres
    value=0
    [/set_variable]
    [set_variable]
    name=open_cages2
    value=0
    [/set_variable]
    [set_variable]
    name=open_cages3
    value=0
    [/set_variable]

    [message]
    speaker=Mursha
    message= _"This is the land of the Deadwood Clan. Looks like there's a lot of work going on here!"
    [/message]

    #Фермы
    [scroll_to]
    x,y=35,28
    [/scroll_to]
    {FARM_OGRE_ANIM 37 27 37 26}
    [delay]
    time=200
    [/delay]
    {FARM_OGRE_ANIM 32 28 31 29}

    #Лесопилка
    [scroll_to]
    x,y=19,13
    [/scroll_to]
    {CUT_OGRE_ANIM 15 11 15 10}
    [delay]
    time=200
    [/delay]
    {CUT_OGRE_ANIM 11 13 12 12}

    #Замок
    [scroll_to]
    x,y=38,12
    [/scroll_to]
    {BUILD_OGRE_ANIM 43 13 44 12}
    {MOVE_UNIT x,y=43,12 44 12}
    [delay]
    time=200
    [/delay]
    {BUILD_OGRE_ANIM 34 12 34 11}
    {MOVE_UNIT x,y=35,11 34 11}

    [message]
    speaker=Bastard
    message= _"If orcs can work, it is with the hands of slaves."
    [/message]
    [message]
    speaker=Slaver_Main
    message= _"Who are you, chief? Why have you come with your army to my plains?"
    [/message]
    [message]
    speaker=Bastard
    message= _"What do I say to him?"
    [/message]
    [message]
    speaker=Mursha
    message= _"Introduce yourself and say you wish to challenge his authority over the ogres."
    [/message]
    [message]
    speaker=Bastard
    message= _"I am Moog the Harmful. From the ColdBlooded Clan. I want- You don't have to rule the ogres. I will."
    [/message]
    [message]
    speaker=Slaver_Main
    message= _"Pah-ha-ha! You're nothing but a pathetic petty clan chief. What right do you have to challenge me?"
    [/message]
    [message]
    speaker=Mursha
    message= _"Tell him about your blood."
    [/message]
    [message]
    speaker=Bastard
    message= _"I have the blood of the Khan of Ogres in me. By this right."
    [/message]
    [message]
    speaker=Slaver_Main
    message= _"Of the Khan of the Ogres? Ha-ha! Even though the Supreme Leader has forbidden feuds, I'll have your wretched army razed to the ground and you made a slave. The Khan will be reunited with his people! Ha-ha!"
    [/message]
    [message]
    speaker=Bastard
    message= _"You will pay for those words, scum. "
    [/message]
    [message]
    x,y=42,28
    message=_ "Master, the water has turned the field into mud. Mine is sinking. Mine can't work like that, Master."
    [/message]
    [message]
    speaker=Slaver_Farm
    message=_ "The chief said to grow crops as soon as possible, so shut up and plant, you freak!"
    [/message]
    [sound]
    name=tail.ogg
    [/sound]

    {MOVE_UNIT x,y=42,28 42 27}

    [sound]
    name=mud-glob.ogg
    [/sound]

    [kill]
    x,y=42,27
    animate=yes
    [/kill]
    [unit]
    side=5
    role=rebel2
    type=Giant Mudcrawler
    x,y=42,27
    animate=yes
    [/unit]

    [scroll_to]
        x,y=19,13
    [/scroll_to]

    {CUT_OGRE_ANIM 10 10 10 9}

    [message]
    speaker=Slaver_Wood
    message=_ "Work faster, you bastards! We need more wood to rebuild the castle after the flood!"
    [/message]
    [message]
    x,y=15,11
    message=_ "Master, my work for two days without rest. My tired."
    [/message]
    [message]
    speaker=Slaver_Wood
    message=_ "You're wasting your energy talking?! Deputy, go help him work faster!"
    [/message]

    {MOVE_UNIT x,y=17,12 16 11}
    {ANIMATE_ATTACK Deputy 15,11 sword no}
    [sound]
    name=tail.ogg
    [/sound]
    {ANIMATE_ATTACK First_Rebel 17,12 cleaver yes}
    {KILL Deputy yes}

    [message]
    x,y=15,11
    message=_ "Ogres will no longer be slaves. Khan will free the Ogres and kill the evil Orcs!"
    [/message]
    [message]
    speaker=Slaver_Wood
    message=_ "Chief, my slaves have risen!"
    [/message]
    [message]
    speaker=Slaver_Farm
    message=_ "Mine, too! What do we do?!"
    [/message]
    [message]
    speaker=Slaver_Main
    message=_ "Idiots! Put down the rebellion, kill the rebels! Then take care of bastard Moog."
    [/message]
    [message]
    speaker=Mursha
    message=_ "It's a chance! The Ogres see you as Khan, Moog, you must help them before the Punishers slaughter them, and then they will be your loyal companions!"
    [/message]

    #Задания

    [objectives]
          silent=no
            [objective]
                description= _ "Save the rebel ogres"
                condition=win
            [/objective]
            [objective]
                description= _ "When you kill all the wardens on a field, the ogres from that field will come under your control. Release all the ogres."
                condition=win
            [/objective]
            [objective]
                #ifdef EASY
                description= _ "The Death of 10 rebel ogres ($dead_ogres|/10)"
                #endif
                #ifdef NORMAL
                description= _ "The Death of 9 rebel ogres ($dead_ogres|/9)"
                #endif
                #ifdef HARD
                description= _ "The Death of 8 rebel ogres ($dead_ogres|/8)"
                #endif
                condition=lose
            [/objective]
            [objective]
                description= _ "The Death of Moog the Harmful"
                condition=lose
            [/objective]
             [objective]
                description= _ "The Death of Mursha"
                condition=lose
            [/objective]
            [gold_carryover]
                bonus=yes
                carryover_percentage=20
            [/gold_carryover]
            [note]
                description=_"The ogres will try to kill the wardens. At the same time they will run away from enemy wolf riders."
            [/note]
            [note]
                description=_"Use as many wolf riders as possible in the beginning to protect the ogres."
            [/note]
            delayed_variable_substitution=yes
    [/objectives]    
[/event]

#Дальше пропишу переход огров на сторону игрока, затем - условия поражения

{SCENARIO_4_CAGE_CONDITIONAL Slaver_Wood 2 3 24 10}
{SCENARIO_4_CAGE_CONDITIONAL Slaver_Wood 2 6 20 14}
{SCENARIO_4_CAGE_CONDITIONAL Slaver_Wood 2 9 9 16}

{SCENARIO_4_CAGE_CONDITIONAL Slaver_Farm 3 3 41 21}
{SCENARIO_4_CAGE_CONDITIONAL Slaver_Wood 3 6 34 20}
{SCENARIO_4_CAGE_CONDITIONAL Slaver_Wood 3 9 25 25}


[event]
name=die
first_time_only=no

    [filter]
    id=Slaver_Wood
    [/filter]

    [message]
    role=rebel1
    message= _"Khan has returned and freed us!"
    [/message]

    [modify_unit]
    [filter]
    role=rebel1
    [/filter]
    side=1
    [/modify_unit]
        [if]
        [variable]
        name=open_cages2
        numerical_equals=3
        [/variable]
        [then]
        [/then]
        [else]
        [if]
        [have_unit]
        id=Slaver_Farm
        [/have_unit]
        [then]
        [message]
        speaker=Mursha
        message=_ "The warden still has the wolves in their cages. They look hungry."
        [/message]
        [message]
        speaker=Bastard
        message=_ "Let's feed them the corpses of these freaks and tame them!"
        [/message]
        [fire_event]
        name=open_all_cages2
        [/fire_event]
        [modify_unit]
        [filter]
            type=Wolf
            side=2
        [/filter]
        side=1
        [/modify_unit]
        [message]
        speaker=narrator
        message=_ "Now you can recruit wolves!"
        [/message]
        [modify_side]
        side=1
        recruit=Goblin Spearman,Wolf Rider,Orcish Archer,Goblin Impaler, Novice Orcish Witch,Orcish Assassin,Wolf
        [/modify_side]
        [set_variable]
        name=has_wolves
        value=1
        [/set_variable]
        [/then]
        [else]
        [message]
        speaker=Bastard
        message=_ "We'll take these wolves too."
        [/message]
        [fire_event]
        name=open_all_cages2
        [/fire_event]
        [modify_unit]
        [filter]
            type=Wolf
            side=2
        [/filter]
        side=1
        [/modify_unit]
        [/else]
        [/if]
        [/else]
        [/if]
    {VARIABLE_OP saved_ogres add 1}
    {ALL_SAVED}
[/event]
[event]
name=die
first_time_only=no

    [filter]
    id=Slaver_Farm
    [/filter]

    [message]
    role=rebel2
    message= _"Khan freed us!"
    [/message]

    [modify_unit]
    [filter]
    role=rebel2
    [/filter]
    side=1
    [/modify_unit]
     [if]
        [variable]
        name=open_cages3
        numerical_equals=3
        [/variable]
        [then]
        [/then]
        [else]
        [if]
        [have_unit]
        id=Slaver_Wood
        [/have_unit]
        [then]
        [message]
        speaker=Mursha
        message=_ "The warden still has the wolves in their cages. They look hungry."
        [/message]
        [message]
        speaker=Bastard
        message=_ "Let's feed them the corpses of these freaks and tame them!"
        [/message]
        [fire_event]
        name=open_all_cages3
        [/fire_event]
        [modify_unit]
        [filter]
            type=Wolf
            side=3
        [/filter]
        side=1
        [/modify_unit]
        [message]
        speaker=narrator
        message=_ "Now you can recruit wolves!"
        [/message]
        [modify_side]
        side=1
        recruit=Goblin Spearman,Wolf Rider,Orcish Archer,Goblin Impaler, Novice Orcish Witch,Orcish Assassin,Wolf
        [/modify_side]
        [set_variable]
        name=has_wolves
        value=1
        [/set_variable]
        [/then]
        [else]
        [message]
        speaker=Bastard
        message=_ "We'll take these wolves too."
        [/message]
        [fire_event]
        name=open_all_cages3
        [/fire_event]
        [modify_unit]
        [filter]
            type=Wolf
            side=3
        [/filter]
        side=1
        [/modify_unit]
        [/else]
        [/if]
        [/else]
        [/if]

    {VARIABLE_OP saved_ogres add 1}
    {ALL_SAVED}
[/event]
#Теперь условие опускания ворот и мятежа внутри крепости

[event]
name=moveto
first_time_only=no
  
    [filter]
        side=1
        race=ogre
        [not]
        role=movedogre
        [/not]
        [filter_location]
        x,y=36,14
        radius=3
        [/filter_location]
    [/filter]

    {VARIABLE_OP rebellion add 1}

    [modify_unit]
    [filter]
    x,y=$unit.x,$unit.y
    [/filter]
    role=movedogre
    [/modify_unit]

    [if]
    [variable]
        name=rebellion
        numerical_equals=5
    [/variable]
    [then]
    [message]
    role=treator
    message= _"Khan has freed the ogres! Khan has come for us! Praise be to Khan! Kill the evil orcs!"
    [/message]

    {REPLACE_SCENARIO_MUSIC the_city_falls.ogg}
    {APPEND_MUSIC northerners.ogg}

    [modify_unit]
    [filter]
    role=treator
    [/filter]
    side=5
    [/modify_unit]

    [scroll_to]
    x,y=36,14
    [/scroll_to]

    [sound]
    name=flail-miss.ogg
    [/sound]
    [delay]
    time=100
    [/delay]
    [sound]
    name=flail-miss.ogg
    [/sound]
    [delay]
    time=100
    [/delay]
    [sound]
    name=flail-miss.ogg
    [/sound]
    [delay]
    time=100
    [/delay]

    {QUAKE ""}

    [sound]
    name=wose-die.ogg
    [/sound]
    [sound]
    name=open-chest.wav
    [/sound]
    [sound]
    [sound]
    name=open-chest.wav
    [/sound]
    name=wose-die.ogg
    [/sound]
    [sound]
    name=open-chest.wav
    [/sound]
    [sound]
    name=wose-die.ogg
    [/sound]

    {MODIFY_TERRAIN Rr^Pw\o 36 13}
    {MODIFY_TERRAIN Rr^Pw\o 37 14}
    {MODIFY_TERRAIN Rr^Pw\o 38 14}

    [redraw][/redraw]

    [delay]
    time=1500
    [/delay]

    [message]
    speaker=Slaver_Main
    message= _"Damn it! Everybody to the gate! Stop them!"
    [/message]
    [modify_unit]
    [filter]
    side=5
    max_moves=0
    [/filter]
    max_moves=$unit.max_moves
    [/modify_unit]
    [modify_unit]
    [filter]
    side=4
    max_moves=0
    [/filter]
    max_moves=$unit.max_moves
    [/modify_unit]

     [objectives]
          silent=no
            [objective]
                description= _ "Kill the DeadWood Chief"
                condition=win
            [/objective]
            [objective]
                description= _ "The Death of Moog the Harmful"
                condition=lose
            [/objective]
             [objective]
                description= _ "The Death of Mursha"
                condition=lose
            [/objective]
            [gold_carryover]
                bonus=yes
                carryover_percentage=20
            [/gold_carryover]
    [/objectives] 
    
    {CLEAR_VARIABLE rebellion}
    {CLEAR_VARIABLE dead_ogres}

    [/then]
    [else]
    [/else]
    [/if]
[/event]

#Мне нужно узнать, как менять модификации юнитов с помощью ивентов... Хотя, есть идея. Но её я попробую потом
#Наверное, нет смысла в поражении за количество огров - по задумке, восставшие в крепости огры тоже присоединятся к нам
#Напишу сперва условие победы
#Завтра добавлю более эпичную катсцену с разрушениями

[event]
name=last_breath

    [filter]
    id=Slaver_Main
    [/filter]

    [message]
    speaker=Slaver_Main
    message= _"No. No way! Bastard Moog! Damn you and your ogres!"
    [/message]
    [message]
    speaker=Bastard
    message= _"You wanted to make me a slave, you scum. Let your slaves decide your fate!"
    [/message]
    [message]
    race=ogre
    message= _"The Great Khan! Let us eat the evil chief, raze his fortress and kill all his orcs!"
    [/message]
    [message]
    speaker=Mursha
    message= _"At least tell them to leave the goblins and the weaklings out of it. They can join to your-"
    [/message]
    [message]
    speaker=Bastard
    message= _"Do whatever you want to do with them!"
    [/message]

    {QUAKE "dwarf-laugh.wav"}
  
    [kill]
    side=4
    animate=yes
    [/kill]

    [message]
    speaker=Mursha
    message= _"Though the spirits have blessed your adventure, you must be more careful from now on, Moog. It was a mistake to storm the fortress and kill all the orcs."
    [/message]
    [message]
    speaker=Bastard
    message= _"Shut up, I don't like it when you talk like Ka'ah. I can decide for myself. "
    [/message]
    [message]
    speaker=Mursha
    message= _"Ka'ah and I helped you become chief. We know what's best."
    [/message]
    [message]
    speaker=Bastard
    message= _"You said I was born to be a leader! I killed the Hunting Avatar myself, I led the campaign and the army. Don't try to take it all for yourself."
    [/message]
    [message]
    speaker=Mursha
    message= _"Oh. All right, so be it. You are a strong Orc, Moog, I recognize that. But your grasp of power is still too poor, you could ruin yourself if you don't listen to me."
    [/message]
    [message]
    speaker=Bastard
    message= _"What makes you think you understand power any better?"
    [/message]
    [message]
    speaker=Mursha
    message= _"Because I've studied it through many tales of different chiefs."
    [/message]
    [message]
    speaker=Bastard
    message= _"Hmm. All right. I'll listen to you, but I'll still have the last word."
    [/message]
    [modify_unit]
        [filter]
        side=5
        [/filter]
        side=1
    [/modify_unit]
    [endlevel]
    result=victory
    [/endlevel]
[/event]

#А вот и условия поражения
#Сперва напишу главных героев, затем - огров
#Возможно, их стоит занести в макрос и копировать в другие миссии

{MOOG_MURSHA_DEATH}

#Теперь про огров
#После небольших тестов добавлю ранжирование по уровню сложности
#Опять переменная 

[event]
name=die
first_time_only=no

    [filter]
    type=Young Ogre
    [/filter]

    {VARIABLE_OP dead_ogres add 1}

    [objectives]
          silent=yes
            [objective]
                description= _ "Save the rebel ogres"
                condition=win
            [/objective]
            [objective]
                description= _ "When you kill all the wardens on a field, the ogres from that field will come under your control. Release all the ogres."
                condition=win
            [/objective]
            [objective]
                #ifdef EASY
                description= _ "The Death of 10 rebel ogres ($dead_ogres|/10)"
                #endif
                #ifdef NORMAL
                description= _ "The Death of 9 rebel ogres ($dead_ogres|/9)"
                #endif
                #ifdef HARD
                description= _ "The Death of 8 rebel ogres ($dead_ogres|/8)"
                #endif
                condition=lose
            [/objective]
            [objective]
                description= _ "The Death of Moog the Harmful"
                condition=lose
            [/objective]
             [objective]
                description= _ "The Death of Mursha"
                condition=lose
            [/objective]
            [note]
                description=_"The ogres will try to kill the wardens. At the same time they will run away from enemy wolf riders."
            [/note]
            [note]
                description=_"Use as many wolf riders as possible in the beginning to protect the ogres."
            [/note]
            [gold_carryover]
                bonus=yes
                carryover_percentage=20
            [/gold_carryover]
    [/objectives]    

    [if]
    [variable]
    name=dead_ogres
    #ifdef EASY
    numerical_equals=10
    #endif
    #ifdef NORMAL
    numerical_equals=9
    #endif
    #ifdef HARD
    numerical_equals=8
    #endif
    [/variable]
    [then]

    [message]
    speaker=Bastard
    message=_ "Most of the ogres are dead. Now I have nowhere to get strong support!"
    [/message]
    [endlevel]
    result=defeat
    [/endlevel]

    {CLEAR_VARIABLE dead_ogres}

    [/then]
    [else]
    [/else]
    [/if]
[/event]
[event]
name=moveto
first_time_only=no
    [filter]
        role=movedogre
        [filter_location]
        [not]
        x,y=36,14
        radius=3
        [/not]
        [/filter_location]
        [/filter]
        [modify_unit]
            [filter]
                id=$unit.id
            [/filter]
            role=
        [/modify_unit]
        {VARIABLE_OP rebellion sub 1}
[/event]
[/scenario]
