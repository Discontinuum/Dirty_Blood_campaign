#textdomain wesnoth-DB
[scenario]
    id=4_The_Khan_of_the_Ogres
    name = _ "The Khan of the Ogres"
    random_start_time=no
    experience_modifier=100
    map_data="{~add-ons/Dirty_Blood/maps/4_The_Khan_of_the_Ogres.map}"
    victory_when_enemies_defeated=no
    next_scenario=5_The_Orc_State
    carryover_percentage=20
    carryover_add=yes
    current_time=dusk
    {TURNS -1 -1 -1}
    {EVENTS_FOR_ABILITIES}
    {SCENARIO_MUSIC "breaking_the_chains.ogg"}
    {EXTRA_SCENARIO_MUSIC "loyalists.ogg"}
    {EXTRA_SCENARIO_MUSIC "casualties_of_war.ogg"}
    {EXTRA_SCENARIO_MUSIC "battle.ogg"}
    {DEFAULT_SCHEDULE}

    [story]
    [part]
    story= _ "By the end of the week, none of the orcs could bring anything that compared to the hide of the avatar of the Hunt. To the surprise of all the orcs, Moog became the clan chief."
    [/part]
    [part]
    story= _ "The goblins cheerfully embraced Moog. But many Orcs were wary of the new leader. Moog himself was no defender of the weak, and he made no difference in the life of the clan. He was as hard and cruel a leader as any."
    [/part]
    [part]
    story= _ "Ka'ah tried her best to influence Moog. At first he obeyed and simply carried out her secret instructions. But soon the half-blood chief got a taste of power and wanted to rule himself."
    [/part]
    [part]
    story= _ "The matter was aggravated by the foul rumors Lokra was spreading. Orc discontent was growing. No one liked a weak chieftain ruled by an old woman. The clan was on the verge of rebellion."
    [/part]
    [part]
    story= _ "Ka'ah was telling Moog to be patient and promised to fix all the problems herself. But Moog didn't want to be patient. He wanted to assert himself as a chief in his own right, and to gain a firm foothold in his power."
    [/part]
    [part]
    story= _ "Mursha saw another possibility. The lands of the nomadic ogres that the Coldblood Clan defeated twenty years ago have been taken over by the Deadwood Clan. The leader of the Dead Tree turned the ogres into slaves. In recent months, rumors have spread among the orcs that he ogres have been revolting time and again. Moog, as heir to the Khan of the Ogres, could free the slaves, and make them into a loyal guard. "
    [/part]
    [part]
    story= _ "Moog ordered the orcs to prepare for war. Ka'ah tried to stop him. At sunset, in front of all the warriors, Moog declared that he was the leader and only he could decide when to start the war. To the cheers of the orcs and goblins, Moog marched into the lands of the DreadWood Clan..."
    [/part]
    [/story]

    [label]
    x,y=25,15
    text=_ "overseer"
    color=255,255,255
    immutable=yes
    [/label]
    [label]
    x,y=13,14
    text=_ "overseer"
    color=255,255,255
    immutable=yes
    [/label]
    [label]
    x,y=19,9
    text=_ "overseer"
    color=255,255,255
    immutable=yes
    [/label]

    [label]
    x,y=33,27
    text=_ "overseer"
    color=255,255,255
    immutable=yes
    [/label]
    [label]
    x,y=38,21
    text=_ "overseer"
    color=255,255,255
    immutable=yes
    [/label]
    [label]
    x,y=42,25
    text=_ "overseer"
    color=255,255,255
    immutable=yes
    [/label]

    [side]
        controller=human
        side=1
        {GOLD 300 250 230}
        {MOOG_HARMFUL_STATS}
        team_name=bastards
        user_team_name= _ "ColdBlooded clan"
        recruit=Goblin Spearman,Wolf Rider,Orcish Archer,Goblin Impaler, Novice Orcish Witch,Orcish Assassin
        color=red
        fog=no
        shroud=no
    [/side]
    [side]
    controller="ai"
    fog=no
    {GOLD 200 250 300}
    hidden=no
    income=2
    id=Slaver
    type=Orcish Warlord
    name="DreadWood Chief"
    #ifdef EASY
    recruit=Wolf Rider
    #endif
     #ifdef NORMAL
    recruit=Wolf Rider
    #endif
     #ifdef HARD
    recruit=Wolf Rider
    #endif
    share_vision="all"
    shroud=no
    side=2
    team_name=slavers
    user_team_name=_"DreadWood clan"
    [village]
        x=7
        y=30
    [/village]
    [village]
        x=8
        y=7
    [/village]
    [village]
        x=8
        y=15
    [/village]
    [village]
        x=13
        y=14
    [/village]
    [village]
        x=15
        y=25
    [/village]
    [village]
        x=19
        y=9
    [/village]
    [village]
        x=20
        y=21
    [/village]
    [village]
        x=20
        y=28
    [/village]
    [village]
        x=21
        y=4
    [/village]
    [village]
        x=25
        y=15
    [/village]
    [village]
        x=29
        y=4
    [/village]
    [village]
        x=30
        y=19
    [/village]
    [village]
        x=33
        y=11
    [/village]
    [village]
        x=33
        y=27
    [/village]
    [village]
        x=34
        y=8
    [/village]
    [village]
        x=35
        y=13
    [/village]
    [village]
        x=36
        y=6
    [/village]
    [village]
        x=36
        y=10
    [/village]
    [village]
        x=38
        y=21
    [/village]
    [village]
        x=39
        y=8
    [/village]
    [village]
        x=39
        y=15
    [/village]
    [village]
        x=41
        y=12
    [/village]
    [village]
        x=42
        y=14
    [/village]
    [village]
        x=44
        y=9
    [/village]
    [village]
        x=45
        y=12
    [/village]
    [village]
        x=46
        y=26
    [/village]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        role=treator
        type="Ogre"
        x=38
        y=17
        max_moves=0
    [/unit]
    [unit]
     [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        role=treator
        type="Ogre"
        x=32
        y=14
        max_moves=0
    [/unit]
    [unit]
     [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        role=treator
        type="Ogre"
        x=44
        y=15
        max_moves=0
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        role=treator
        type="Ogre"
        x=32
        y=12
        max_moves=0
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        role=treator
        type="Ogre"
        x=31
        y=9
        max_moves=0
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        role=treator
        type="Ogre"
        x=37
        y=4
        max_moves=0
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        role=treator
        type="Ogre"
        x=47
        y=9
        max_moves=0
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        type="Orcish Crossbowman"
        x=42
        y=17
        max_moves=0
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        type="Orcish Orcish Archer"
        x=30
        y=10
        max_moves=0
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Crossbowman"
        x=30
        y=11
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Orcish Archer"
        x=43
        y=17
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Crossbowman"
        x=45
        y=16
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Crossbowman"
        x=46
        y=15
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Crossbowman"
        x=30
        y=10
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Crossbowman"
        x=31
        y=7
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Grunt"
        x=34
        y=5
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Grunt"
        x=28
        y=20
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Orcish Archer"
        x=31
        y=7
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Archer"
        x=47
        y=14
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Archer"
        x=48
        y=10
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Archer"
        x=34
        y=4
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Archer"
        x=39
        y=4
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Grunt"
        x=31
        y=12
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Warrior"
        x=32
        y=13
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Warrior"
        x=39
        y=17
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Grunt"
        x=40
        y=16
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Warrior"
        x=41
        y=17
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Grunt"
        x=43
        y=16
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Warrior"
        x=46
        y=14
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Warrior"
        x=31
        y=10
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Grunt"
        x=32
        y=7
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Grunt"
        x=33
        y=6
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Grunt"
        x=47
        y=12
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Grunt"
        x=47
        y=13
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Grunt"
        x=46
        y=8
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        role=guard1
        max_moves=0
        type="Orcish Grunt"
        x=19
        y=9
        max_moves=0
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        role=guard1
        max_moves=0
        type="Orcish Grunt"
        x=13
        y=14
        max_moves=0
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        role=guard1
        max_moves=0
        type="Orcish Grunt"
        x=25
        y=15
        max_moves=0
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        role=guard2
        max_moves=0
        type="Orcish Grunt"
        x=38
        y=21
        max_moves=0
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Grunt"
        x=33
        y=27
        role=guard2
        max_moves=0
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Grunt"
        x=42
        y=25
        role=guard2
        max_moves=0
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        ai_special=guardian
        type="Orcish Crossbowman"
        x=27
        y=21
        max_moves=0
        random_traits=no
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        ai_special=guardian
        type="Orcish Crossbowman"
        x=28
        y=21
        max_moves=0
        random_traits=no
    [/unit]
[/side]
     [side]
        controller=ai
        side=3
        team_name=bastards
        user_team_name= _ "Ogres"
        color=teal
        no_leader=yes
        hidden=no
        share_vision=no
    [unit]
        role=rebel1
        [modifications]
        {TRAIT_LOYAL}
        [/modifications]
        type="Young Ogre"
        x=21
        y=6
    [/unit]
    [unit]
        role=rebel1
        [modifications]
        {TRAIT_LOYAL}
        [/modifications]
        type="Young Ogre"
        x=25
        y=8
    [/unit]
    [unit]
        role=rebel1
        [modifications]
        {TRAIT_LOYAL}
        [/modifications]
        type="Young Ogre"
        x=20
        y=11
    [/unit]
    [unit]
        role=rebel1
        [modifications]
        {TRAIT_LOYAL}
        [/modifications]
        type="Young Ogre"
        x=17
        y=13
    [/unit]
    [unit]
        role=rebel1
        [modifications]
        {TRAIT_LOYAL}
        [/modifications]
        type="Young Ogre"
        x=20
        y=14
    [/unit]
    [unit]
        role=rebel1
        [modifications]
        {TRAIT_LOYAL}
        [/modifications]
        type="Young Ogre"
        x=11
        y=15
    [/unit]
    [unit]
        role=rebel1
        [modifications]
        {TRAIT_LOYAL}
        [/modifications]
        type="Young Ogre"
        x=25
        y=18
    [/unit]
    [unit]
        role=rebel1
        [modifications]
        {TRAIT_LOYAL}
        [/modifications]
        type="Young Ogre"
        x=21
        y=19
    [/unit]

    #south rebels

    [unit]
        role=rebel2
        [modifications]
        {TRAIT_LOYAL}
        [/modifications]
        type="Young Ogre"
        x=30
        y=25
    [/unit]
    [unit]
        role=rebel2
        [modifications]
        {TRAIT_LOYAL}
        [/modifications]
        type="Young Ogre"
        x=34
        y=20
    [/unit]
    [unit]
        role=rebel2
        [modifications]
        {TRAIT_LOYAL}
        [/modifications]
        type="Young Ogre"
        x=36
        y=24
    [/unit]
    [unit]
        role=rebel2
        [modifications]
        {TRAIT_LOYAL}
        [/modifications]
        type="Young Ogre"
        x=49
        y=26
    [/unit]
    [unit]
        role=rebel2
        [modifications]
        {TRAIT_LOYAL}
        [/modifications]
        type="Young Ogre"
        x=41
        y=21
    [/unit]
    [unit]
        role=rebel2
        [modifications]
        {TRAIT_LOYAL}
        [/modifications]
        type="Young Ogre"
        x=43
        y=27
    [/unit]
    [unit]
        role=rebel2
        [modifications]
        {TRAIT_LOYAL}
        [/modifications]
        type="Young Ogre"
        x=39
        y=28
    [/unit]
    [/side]

#Сперва пусть будет престарт с настройкой ИИ
#Впредь мне надо более ответственно подходить к структурированию моего кода
#Я переделаю код первых миссий, чтобы он был более удобным и стройным
#Пока не уверен насчёт макросов

[event]
name=prestart

        [micro_ai]
            side=2
            ai_type=simple_attack
            action=add
            ca_score=300000
            [filter]
                side=2
            [/filter]
            [filter_second]
            role=rebel1
            [/filter_second]
        [/micro_ai]

        [micro_ai]
            side=2
            ai_type=simple_attack
            action=add
            ca_score=300000
            [filter]
                side=2
            [/filter]
            [filter_second]
            role=rebel2
            [/filter_second]
        [/micro_ai]

        [micro_ai]
            side=3
            ai_type=simple_attack
            action=add
            ca_score=600000
            [filter]
                role=rebel1
            [/filter]
            [filter_second]
            role=guard1
            [/filter_second]
        [/micro_ai]
        [micro_ai]
            side=3
            ai_type=simple_attack
            action=add
            ca_score=600000
            [filter]
                role=rebel2
            [/filter]
            [filter_second]
            role=guard2
            [/filter_second]
        [/micro_ai]
         [micro_ai]
            side=3
            ai_type=coward
            action=add

            [filter]
            type=Young Ogre
            [/filter]
            [filter_second]
            type=Wolf Rider
            side=2
            [/filter_second]
            distance=4
            avoid_x,avoid_y=40,9
            radius=11
            attack_if_trapped=yes
            ca_score=500000
        [/micro_ai]


#Реколл Мурши

        [recall]
        id=Mursha
        x,y=11,27
        [/recall]

[/event]

#В этом сценарии одно из условий поражения - смерть огров, поэтому ивенты поражения помещу в конец, один за другим
#Надо добавить переменную для диалога после освобождения всех огров

[event]
name=start

    [set_variable]
    name=saved_ogres
    value=0
    [/set_variable]
    [set_variable]
    name=dead_ogres
    value=0
    [/set_variable]

    [message]
    speaker=Mursha
    message= _"Here comes the land of the Deadwood Clan. The rumors were true: there were many ogres working the fields. If orcs can farm, this is the way to do it."
    [/message]

    [scroll_to]
    x,y=38,24
    [/scroll_to]
    [delay]
    time=2000
    [/delay]
    [scroll_to]
    x,y=19,13
    [/scroll_to]
    [delay]
    time=2000
    [/delay]
    [message]
    speaker=Slaver
    message= _"Who are you, chief? Why have you come with your army to my plains?"
    [/message]
    [message]
    speaker=Bastard
    message= _"What do I say to him?"
    [/message]
    [message]
    speaker=Mursha
    message= _"Introduce yourself and say you wish to challenge his authority over the ogres."
    [/message]
    [message]
    speaker=Bastard
    message= _"I am Moog the Harmful. From the ColdBlooded Clan. I want- You don't have to rule the ogres. I will."
    [/message]
    [message]
    speaker=Slaver
    message= _"Pah-ha-ha! You're nothing but a pathetic petty clan chief. What right do you have to challenge me?"
    [/message]
    [message]
    speaker=Mursha
    message= _"Tell him about your blood."
    [/message]
    [message]
    speaker=Bastard
    message= _"I have the blood of the Khan of Ogres in me. By this right."
    [/message]
    [message]
    speaker=Slaver
    message= _"Of the Khan of the Ogres? Ha-ha! Even though the Supreme Leader has forbidden feuds, I'll have your wretched army razed to the ground and you made a slave. The Khan will be reunited with his people! Ha-ha!"
    [/message]
    [message]
    speaker=Bastard
    message= _"You will pay for those words, scum. "
    [/message]

    #Задания

    [objectives]
          silent=no
            [objective]
                description= _ "Save the rebel ogres"
                condition=win
            [/objective]
            [objective]
                description= _ "When you kill all the wardens on a field, the ogres from that field will come under your control. Release all the ogres."
                condition=win
            [/objective]
            [objective]
                #ifdef EASY
                description= _ "The Death of 10 rebel ogres ($dead_ogres|/10)"
                #endif
                #ifdef NORMAL
                description= _ "The Death of 9 rebel ogres ($dead_ogres|/9)"
                #endif
                #ifdef HARD
                description= _ "The Death of 8 rebel ogres ($dead_ogres|/8)"
                #endif
                condition=lose
            [/objective]
            [objective]
                description= _ "The Death of Moog the Harmful"
                condition=lose
            [/objective]
             [objective]
                description= _ "The Death of Mursha"
                condition=lose
            [/objective]
            [gold_carryover]
                bonus=yes
                carryover_percentage=20
            [/gold_carryover]
            [note]
                description=_"The ogres will try to kill the wardens. At the same time they will run away from enemy wolf riders."
            [/note]
            [note]
                description=_"Use as many wolf riders as possible in the beginning to protect the ogres."
            [/note]
            delayed_variable_substitution=yes
    [/objectives]    

[/event]
[event]
name=side_3_turn_1

    [message]
    speaker=narrator
    message= _"Rumors of an heir to the Khan of the ogres have stirred the ogres. The fields became restless."
    [/message]
[/event]
[event]
name=attack_end
first_time_only=yes

    [filter]
        side=3
    [/filter]
    [filter_second]
        side=2
    [/filter_second]
    [message]
    speaker=second_unit
    message= _"Chief! Those assholes have risen again!"
    [/message]
    [message]
    speaker=Slaver
    message= _"Ar-r, that's the last thing we need! Wolf riders, deal with the rebels! We kill Moog the Asshole later."
    [/message]
    [message]
    speaker=Mursha
    message= _"This is your chance, Moog. You must save the rebel ogres before the Deadwood punishers get to them. That's how you'll gain loyal followers."
    [/message]
[/event]

#Дальше пропишу переход огров на сторону игрока, затем - условия поражения

[event]
name=die
first_time_only=no

    [filter]
    role=guard1
    [/filter]

    [label]
    x,y=$unit.x,$unit.y
    text=_ ""
    immutable=yes
    [/label]

    [if]
    [have_unit]
    role=guard1
    [/have_unit]
    [then]
    [/then]
    [else]
    [message]
    role=rebel1
    message= _"Khan has returned and freed us!"
    [/message]

    [modify_unit]
    [filter]
    role=rebel1
    [/filter]
    side=1
    [/modify_unit]

    {VARIABLE_OP saved_ogres add 1}

    [/else]
    [/if]

[/event]
[event]
name=die
first_time_only=no

    [filter]
    role=guard2
    [/filter]

    [label]
    x,y=$unit.x,$unit.y
    text=_ ""
    immutable=yes
    [/label]

    [if]
    [have_unit]
    role=guard2
    [/have_unit]
    [then]
    [/then]
    [else]
    [message]
    role=rebel2
    message= _"Khan has returned and freed us!"
    [/message]

    [modify_unit]
    [filter]
    role=rebel2
    [/filter]
    side=1
    [/modify_unit]

    {VARIABLE_OP saved_ogres add 1}

    [/else]
    [/if]

[/event]

#Диалог про освобождение огров и новая цель

[event]
name=new_turn
first_time_only=no

    [if]

    [variable]
    name=saved_ogres
    numerical_equals=2
    [/variable]

    [then]

    [modify_unit]
    	[filter]
    		role=rebel1,rebel2
    	[/filter]
    	role=rebel
    [/modify_unit]

    [message]
    speaker=Mursha
    message= _"What?! Don't be silly, Deadwood Fortress is well defended, we don't have the strength to storm it."
    [/message]
    [message]
    speaker=Bastard
    message= _"No. I want to punish the asshole."
    [/message]
    [scroll_to]
    x,y=39,11
    [/scroll_to]
    [delay]
    time=1000
    [/delay]
    [message]
    speaker=Mursha
    message= _"But the Dead Tree Fortress is well defended. We'll lose our entire army if we try to storm the walls. And we have no siege machines to breach the mighty gates."
    [/message]
    [message]
    speaker=Bastard
    message= _"Don't try to push me around. I'm the leader here. I want to storm the fortress. Think of something."
    [/message]
    [message]
    role=rebel
    message= _"Great Khan! We know how to take the fortress."
    [/message]
    [message]
    speaker=Bastard
    message= _"Speak, ogre."
    [/message]
    [message]
    role=rebel
    message= _"The evil chief has taken the strongest ogres to the fortress. They open and close the heavy gates. If they see that Khan has freed us, they will open the gate for Khan!"
    [/message]
    [message]
    speaker=Bastard
    message= _"I saw ogres in Deadwood's army. How can I believe you?"
    [/message]
    [message]
    role=rebel
    message= _"Great Khan, even though the strong ogres serve in the Dead Tree Army, they hate the evil leader in their hearts! They will definitely open the gates for Khan! You can eat me alive if I deceive you."
    [/message]
    [message]
    speaker=Bastard
    message= _"Hmm, all right. I order everyone to assemble under the castle gate!"
    [/message]
    [message]
    speaker=Mursha
    message= _"If you're going to storm the fortress, Moog, prepare well. Gather as many warriors as you can and start the ogre rebellion in the daytime. That way they'll last longer against the Deadwood Orcs."
    [/message]


    [objectives]
          silent=no
            [objective]
                description= _ "Convince the ogres in the fortress to open the gate for you."
                condition=win
            [/objective]
            [objective]
                description= _ "To convince them, bring 5 ogres to the gate (3 hex radius from the gate)."
                condition=win
            [/objective]
            [objective]
                #ifdef EASY
                description= _ "The Death of 10 rebel ogres ($dead_ogres|/10)"
                #endif
                #ifdef NORMAL
                description= _ "The Death of 9 rebel ogres ($dead_ogres|/9)"
                #endif
                #ifdef HARD
                description= _ "The Death of 8 rebel ogres ($dead_ogres|/8)"
                #endif
                condition=lose
            [/objective]
            [objective]
                description= _ "The Death of Moog the Harmful"
                condition=lose
            [/objective]
             [objective]
                description= _ "The Death of Mursha"
                condition=lose
            [/objective]
            [note]
                description=_"Orc Assassins can be useful for weakening the defenders of a fortress before an assault."
            [/note]
            [gold_carryover]
                bonus=yes
                carryover_percentage=20
            [/gold_carryover]
    [/objectives] 

    {CLEAR_VARIABLE saved_ogres}   

    [set_variable]
    name=rebellion
    value=0
    [/set_variable]
        [micro_ai]
            side=2
            ai_type=simple_attack
            action=delete
        [/micro_ai]
        [micro_ai]
            side=3
            ai_type=simple_attack
            action=delete
        [/micro_ai]
         [micro_ai]
            side=3
            ai_type=coward
            action=delete
        [/micro_ai]

    [/then]
    [else]
    [/else]
    [/if]
[/event]

#Теперь условие опускания ворот и мятежа внутри крепости

[event]
name=moveto
first_time_only=no
  
    [filter]
        side=1
        race=ogre
        [not]
        role=movedogre
        [/not]
        [filter_location]
        x,y=33,17
        radius=3
        [/filter_location]
    [/filter]

          {VARIABLE_OP rebellion add 1}

    [modify_unit]
    [filter]
    x,y=$unit.x,$unit.y
    [/filter]
    role=movedogre
    [/modify_unit]

    [if]
    [variable]
        name=rebellion
        numerical_equals=5
    [/variable]
    [then]
    [message]
    role=treator
    message= _"Khan has freed the ogres! Khan has come for us! Praise be to Khan! Kill the evil orcs!"
    [/message]

    {REPLACE_SCENARIO_MUSIC the_city_falls.ogg}
    {APPEND_MUSIC northerners.ogg}

    [modify_unit]
    [filter]
    role=treator
    [/filter]
    side=3
    [/modify_unit]

    [scroll_to]
    x,y=35,16
    [/scroll_to]

    [sound]
    name=flail-miss.ogg
    [/sound]
    [delay]
    time=100
    [/delay]
    [sound]
    name=flail-miss.ogg
    [/sound]
    [delay]
    time=100
    [/delay]
    [sound]
    name=flail-miss.ogg
    [/sound]
    [delay]
    time=100
    [/delay]

    {QUAKE ""}

    [sound]
    name=wose-die.ogg
    [/sound]
    [sound]
    name=open-chest.wav
    [/sound]
    [sound]
    [sound]
    name=open-chest.wav
    [/sound]
    name=wose-die.ogg
    [/sound]
    [sound]
    name=open-chest.wav
    [/sound]
    [sound]
    name=wose-die.ogg
    [/sound]

    {MODIFY_TERRAIN Rr^Pw\o 34 15}
    {MODIFY_TERRAIN Rr^Pw\o 35 16}
    {MODIFY_TERRAIN Rr^Pw\o 36 16}

    [redraw][/redraw]

    [delay]
    time=1500
    [/delay]

    [message]
    speaker=Slaver
    message= _"Damn it! Kill the traitors! Kill them all!"
    [/message]
    [modify_side]
    {GOLD 80 100 120}
    side=2
    #ifdef EASY
    recruit=Orcish Grunt,Orcish Archer
    #endif
    #ifdef NORMAL
    recruit=Orcish Grunt,Orcish Warrior,Orcish Archer,Orcish Assassin
    #endif
    #ifdef HARD
    recruit=Orcish Grunt,Orcish Warrior,Orcish Archer,Orcish Crossbowman,Orcish Assassin
    #endif
    [/modify_side]
    [modify_unit]
    [filter]
    side=2
    max_moves=0
    [/filter]
    max_moves=$unit.max_moves
    [/modify_unit]
    [modify_unit]
    [filter]
    side=3
    max_moves=0
    [/filter]
    max_moves=$unit.max_moves
    [/modify_unit]

     [objectives]
          silent=no
            [objective]
                description= _ "Kill the DreadWood Chief"
                condition=win
            [/objective]
            [objective]
                description= _ "The Death of Moog the Harmful"
                condition=lose
            [/objective]
             [objective]
                description= _ "The Death of Mursha"
                condition=lose
            [/objective]
            [gold_carryover]
                bonus=yes
                carryover_percentage=20
            [/gold_carryover]
    [/objectives] 
    
    {CLEAR_VARIABLE rebellion}
    {CLEAR_VARIABLE dead_ogres}

    [/then]
    [else]
    [/else]
    [/if]
[/event]

#Мне нужно узнать, как менять модификации юнитов с помощью ивентов... Хотя, есть идея. Но её я попробую потом
#Наверное, нет смысла в поражении за количество огров - по задумке, восставшие в крепости огры тоже присоединятся к нам
#Напишу сперва условие победы
#Завтра добавлю более эпичную катсцену с разрушениями

[event]
name=last_breath

    [filter]
    id=Slaver
    [/filter]

    [message]
    speaker=Slaver
    message= _"No. No way! Bastard Moog! Damn you and your ogres!"
    [/message]
    [message]
    speaker=Bastard
    message= _"You wanted to make me a slave, you scum. Let your slaves decide your fate!"
    [/message]
    [message]
    race=ogre
    message= _"The Great Khan! Let us eat the evil chief, raze his fortress and kill all his orcs!"
    [/message]
    [message]
    speaker=Mursha
    message= _"At least tell them to leave the goblins and the weaklings out of it. They can join to your-"
    [/message]
    [message]
    speaker=Bastard
    message= _"Do whatever you want to do with them!"
    [/message]

    [scroll_to]
    x,y=40,9
    [/scroll_to]
    [delay]
    time=1000
    [/delay]

    {QUAKE "dwarf-laugh.wav"}
    {QUAKE "rumble.ogg"}
    {QUAKE "rumble.ogg"}
    {QUAKE "explosion.ogg"}
    {QUAKE "wose-die.ogg"}
    {QUAKE "rumble.ogg"}
    {QUAKE "wose-die.ogg"}
    {QUAKE "rumble.ogg"}
    {QUAKE "rumble.ogg"}
    {QUAKE "explosion.ogg"}
    {QUAKE "wose-die.ogg"}
    {QUAKE "rumble.ogg"}
    {QUAKE "wose-die.ogg"}
    {QUAKE "rumble.ogg"}
    {QUAKE "rumble.ogg"}
    [kill]
    side=2
    level=1
    animate=no
    [/kill]
    [delay]
    time=300
    [/delay]
    {QUAKE "explosion.ogg"}
    {QUAKE "wose-die.ogg"}
    {QUAKE "rumble.ogg"}
    {QUAKE "wose-die.ogg"}
    {QUAKE "rumble.ogg"}
    {QUAKE "rumble.ogg"}
    {QUAKE "explosion.ogg"}
    {QUAKE "wose-die.ogg"}
    {QUAKE "rumble.ogg"}
    {QUAKE "wose-die.ogg"}
    {QUAKE "rumble.ogg"}
    {QUAKE "rumble.ogg"}
    [kill]
    side=2
    level=2
    animate=no
    [/kill]
    [delay]
    time=300
    [/delay]
    {QUAKE "explosion.ogg"}
    {QUAKE "wose-die.ogg"}
    {QUAKE "rumble.ogg"}
    {QUAKE "wose-die.ogg"}
    {QUAKE "rumble.ogg"}
    {QUAKE "rumble.ogg"}
    [kill]
    side=2
    level=3
    animate=no
    [/kill]
    [delay]
    time=300
    [/delay]
    {QUAKE "explosion.ogg"}
    {QUAKE "wose-die.ogg"}
    {QUAKE "rumble.ogg"}
    {QUAKE "wose-die.ogg"}
    [replace_map]
            map_file=~add-ons/Dirty_Blood/maps/4a_The_Ogre_Rebellion.map
            expand=yes
            shrink=yes
    [/replace_map]
    [redraw][/redraw]

    [delay]
    time=2000
    [/delay]
   
    [message]
    speaker=Mursha
    message= _"Though the spirits have blessed your adventure, you must be more careful from now on, Moog. It was a mistake to storm the fortress and kill all the orcs."
    [/message]
    [message]
    speaker=Bastard
    message= _"Shut up, I don't like it when you talk like Ka'ah. I can decide for myself. "
    [/message]
    [message]
    speaker=Mursha
    message= _"Ka'ah and I helped you become chief. We know what's best."
    [/message]
    [message]
    speaker=Bastard
    message= _"You said I was born to be a leader! I killed the Hunting Avatar myself, I led the campaign and the army. Don't try to take it all for yourself."
    [/message]
    [message]
    speaker=Mursha
    message= _"Oh. All right, so be it. You are a strong Orc, Moog, I recognize that. But your grasp of power is still too poor, you could ruin yourself if you don't listen to me."
    [/message]
    [message]
    speaker=Bastard
    message= _"What makes you think you understand power any better?"
    [/message]
    [message]
    speaker=Mursha
    message= _"Because I've studied it through many tales of different chiefs."
    [/message]
    [message]
    speaker=Bastard
    message= _"Hmm. All right. I'll listen to you, but I'll still have the last word."
    [/message]

    [endlevel]
    result=victory
    [/endlevel]
[/event]

#А вот и условия поражения
#Сперва напишу главных героев, затем - огров
#Возможно, их стоит занести в макрос и копировать в другие миссии

{MOOG_MURSHA_DEATH}

#Теперь про огров
#После небольших тестов добавлю ранжирование по уровню сложности
#Опять переменная 

[event]
name=die
first_time_only=no

    [filter]
    type=Young Ogre
    [/filter]

    {VARIABLE_OP dead_ogres add 1}

    [objectives]
          silent=yes
            [objective]
                description= _ "Save the rebel ogres"
                condition=win
            [/objective]
            [objective]
                description= _ "When you kill all the wardens on a field, the ogres from that field will come under your control. Release all the ogres."
                condition=win
            [/objective]
            [objective]
                #ifdef EASY
                description= _ "The Death of 10 rebel ogres ($dead_ogres|/10)"
                #endif
                #ifdef NORMAL
                description= _ "The Death of 9 rebel ogres ($dead_ogres|/9)"
                #endif
                #ifdef HARD
                description= _ "The Death of 8 rebel ogres ($dead_ogres|/8)"
                #endif
                condition=lose
            [/objective]
            [objective]
                description= _ "The Death of Moog the Harmful"
                condition=lose
            [/objective]
             [objective]
                description= _ "The Death of Mursha"
                condition=lose
            [/objective]
            [note]
                description=_"The ogres will try to kill the wardens. At the same time they will run away from enemy wolf riders."
            [/note]
            [note]
                description=_"Use as many wolf riders as possible in the beginning to protect the ogres."
            [/note]
            [gold_carryover]
                bonus=yes
                carryover_percentage=20
            [/gold_carryover]
    [/objectives]    

    [if]
    [variable]
    name=dead_ogres
    #ifdef EASY
    numerical_equals=10
    #endif
    #ifdef NORMAL
    numerical_equals=9
    #endif
    #ifdef HARD
    numerical_equals=8
    #endif
    [/variable]
    [then]

    [message]
    speaker=Bastard
    message=_ "Most of the ogres are dead. Now I have nowhere to get strong support!"
    [/message]
    [endlevel]
    result=defeat
    [/endlevel]

    {CLEAR_VARIABLE dead_ogres}

    [/then]
    [else]
    [/else]
    [/if]
[/event]
[/scenario]
