#textdomain wesnoth-DB
[scenario]
    id=5_Revolution
    name = _ "The Khan of the Ogres"
    random_start_time=no
    experience_modifier=100
    map_data="{~add-ons/Dirty_Blood/maps/5_Revolution.map}"
    victory_when_enemies_defeated=no
    next_scenario=6_Fighting
    carryover_percentage=20
    carryover_add=yes
    current_time=dusk
    {TURNS -1 -1 -1}
    {SCENARIO_MUSIC "breaking_the_chains.ogg"}
    {EXTRA_SCENARIO_MUSIC "casualties_of_war.ogg"}
    {EXTRA_SCENARIO_MUSIC "battle.ogg"}
    {DEFAULT_SCHEDULE}

    [story]
    [part]
    story= _ "That's how Mug the Harmful became the leader of the Coldblooded Clan. The shamans turned a blind eye to the incident at the cave and recognized him. The clan needed a chief, and a chief is found. To reject him would mean further strife and more bloodshed. The Coldblooded clan couldn't afford it."
    [/part]
    [part]
    story= _ "The goblins cheerfully embraced Mug. But many Orcs were wary of the new leader. Mug himself was no defender of the weak, and he made no difference in the life of the clan. He was as hard and cruel a leader as any."
    [/part]
    [part]
    story= _ "All winter long, the clan has been rebuilding its strength. Mug ruled in consultation with Ka'ah. With her help, he improved the life of the clan. Not the least of which was the blessing of the Spirit of the Hunt."
    [/part]
    [part]
    story= _ "But Mug's position was still precarious. The chiefs of the neighboring clans refused to recognize him. Although the law of the Supreme Ruler kept them from war, they all realized that a chief who relied on weaklings and goblins would not last long."
    [/part]
    [part]
    story= _ "Mug needed a new, strong pillar of his power. And Ka'ah had an idea of where to find that pillar."
    [/part]
    [part]
    story= _ "The lands of the nomadic ogres that the Coldblood Clan defeated twenty years ago have been taken over by the Deadwood Clan. The leader of the Dead Tree turned the ogres into slaves. In recent months, rumors have spread among the orcs that he ogres have been revolting time and again."
    [/part]
    [part]
    story= _ "Ka'ah told Mug to take this chance. In early spring, when the mountain passes became passable again, Mug marched his army into the Deadwood lands."
    [/part]
    [/story]


    [side]
        controller=human
        side=1
        {GOLD 300 250 230}
        id=Bastard
        name=_ "Mug the Harmful"
        type=Orc Bastard
        team_name=bastards
        user_team_name= _ "ColdBlooded clan"
        recruit=Goblin Spearman,Wolf Rider,Orcish Archer,Goblin Impaler, Novice Orcish Witch,Orcish Assassin
        color=red
        fog=no
        shroud=no
    [/side]
    [side]
    controller="ai"
    fog=no
    {GOLD 200 250 300}
    hidden=no
    income=2
    id=Slaver
    type=Orcish Warlord
    name="DreadWood Chief"
    #ifdef EASY
    recruit=Wolf Rider
    #endif
     #ifdef NORMAL
    recruit=Wolf Rider
    #endif
     #ifdef HARD
    recruit=Wolf Rider
    #endif
    share_vision="all"
    shroud=no
    side=2
    team_name=slavers
    user_team_name=_"DreadWood clan"
    [village]
        x=7
        y=30
    [/village]
    [village]
        x=8
        y=7
    [/village]
    [village]
        x=8
        y=15
    [/village]
    [village]
        x=13
        y=14
    [/village]
    [village]
        x=15
        y=25
    [/village]
    [village]
        x=19
        y=9
    [/village]
    [village]
        x=20
        y=21
    [/village]
    [village]
        x=20
        y=28
    [/village]
    [village]
        x=21
        y=4
    [/village]
    [village]
        x=25
        y=15
    [/village]
    [village]
        x=29
        y=4
    [/village]
    [village]
        x=30
        y=19
    [/village]
    [village]
        x=33
        y=11
    [/village]
    [village]
        x=33
        y=27
    [/village]
    [village]
        x=34
        y=8
    [/village]
    [village]
        x=35
        y=13
    [/village]
    [village]
        x=36
        y=6
    [/village]
    [village]
        x=36
        y=10
    [/village]
    [village]
        x=38
        y=21
    [/village]
    [village]
        x=39
        y=8
    [/village]
    [village]
        x=39
        y=15
    [/village]
    [village]
        x=41
        y=12
    [/village]
    [village]
        x=42
        y=14
    [/village]
    [village]
        x=44
        y=9
    [/village]
    [village]
        x=45
        y=12
    [/village]
    [village]
        x=46
        y=26
    [/village]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        role=treator
        type="DB Ogre"
        x=38
        y=17
        max_moves=0
    [/unit]
    [unit]
     [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        role=treator
        type="DB Ogre"
        x=32
        y=14
        max_moves=0
    [/unit]
    [unit]
     [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        role=treator
        type="DB Ogre"
        x=44
        y=15
        max_moves=0
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        role=treator
        type="DB Ogre"
        x=32
        y=12
        max_moves=0
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        role=treator
        type="DB Ogre"
        x=31
        y=9
        max_moves=0
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        role=treator
        type="DB Ogre"
        x=37
        y=4
        max_moves=0
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        role=treator
        type="DB Ogre"
        x=47
        y=9
        max_moves=0
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        type="Orcish Crossbowman"
        x=42
        y=17
        max_moves=0
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        type="Orcish Orcish Archer"
        x=30
        y=10
        max_moves=0
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Crossbowman"
        x=30
        y=11
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Orcish Archer"
        x=43
        y=17
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Crossbowman"
        x=45
        y=16
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Crossbowman"
        x=46
        y=15
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Crossbowman"
        x=30
        y=10
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Crossbowman"
        x=31
        y=7
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Grunt"
        x=34
        y=5
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Grunt"
        x=28
        y=20
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Orcish Archer"
        x=31
        y=7
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Archer"
        x=47
        y=14
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Archer"
        x=48
        y=10
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Archer"
        x=34
        y=4
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Archer"
        x=39
        y=4
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Grunt"
        x=31
        y=12
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Warrior"
        x=32
        y=13
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Warrior"
        x=39
        y=17
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Grunt"
        x=40
        y=16
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Warrior"
        x=41
        y=17
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Grunt"
        x=43
        y=16
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Warrior"
        x=46
        y=14
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Warrior"
        x=31
        y=10
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Grunt"
        x=32
        y=7
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Grunt"
        x=33
        y=6
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Grunt"
        x=47
        y=12
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Grunt"
        x=47
        y=13
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Grunt"
        x=46
        y=8
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        role=guard1
        max_moves=0
        type="Orcish Grunt"
        x=19
        y=9
        max_moves=0
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        role=guard1
        max_moves=0
        type="Orcish Grunt"
        x=13
        y=14
        max_moves=0
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        role=guard1
        max_moves=0
        type="Orcish Grunt"
        x=25
        y=15
        max_moves=0
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        role=guard2
        max_moves=0
        type="Orcish Grunt"
        x=38
        y=21
        max_moves=0
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Grunt"
        x=33
        y=27
        role=guard2
        max_moves=0
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        max_moves=0
        type="Orcish Grunt"
        x=46
        y=26
        role=guard2
        max_moves=0
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        ai_special=guardian
        type="Orcish Crossbowman"
        x=27
        y=21
        max_moves=0
        random_traits=no
    [/unit]
    [unit]
    [modifications]
    {TRAIT_LOYAL}
    [/modifications]
        ai_special=guardian
        type="Orcish Crossbowman"
        x=28
        y=21
        max_moves=0
        random_traits=no
    [/unit]
[/side]
     [side]
        controller=ai
        side=3
        team_name=bastards
        user_team_name= _ "Ogres"
        color=brown
        no_leader=yes
        hidden=no
        share_vision=no
    [unit]
        role=rebel1
        [modifications]
        {TRAIT_LOYAL}
        [/modifications]
        type="DB Young Ogre"
        x=21
        y=6
    [/unit]
    [unit]
        role=rebel1
        [modifications]
        {TRAIT_LOYAL}
        [/modifications]
        type="DB Young Ogre"
        x=25
        y=8
    [/unit]
    [unit]
        role=rebel1
        [modifications]
        {TRAIT_LOYAL}
        [/modifications]
        type="DB Young Ogre"
        x=20
        y=11
    [/unit]
    [unit]
        role=rebel1
        [modifications]
        {TRAIT_LOYAL}
        [/modifications]
        type="DB Young Ogre"
        x=17
        y=13
    [/unit]
    [unit]
        role=rebel1
        [modifications]
        {TRAIT_LOYAL}
        [/modifications]
        type="DB Young Ogre"
        x=20
        y=14
    [/unit]
    [unit]
        role=rebel1
        [modifications]
        {TRAIT_LOYAL}
        [/modifications]
        type="DB Young Ogre"
        x=11
        y=15
    [/unit]
    [unit]
        role=rebel1
        [modifications]
        {TRAIT_LOYAL}
        [/modifications]
        type="DB Young Ogre"
        x=25
        y=18
    [/unit]
    [unit]
        role=rebel1
        [modifications]
        {TRAIT_LOYAL}
        [/modifications]
        type="DB Young Ogre"
        x=21
        y=19
    [/unit]

    #south rebels

    [unit]
        role=rebel2
        [modifications]
        {TRAIT_LOYAL}
        [/modifications]
        type="DB Young Ogre"
        x=30
        y=25
    [/unit]
    [unit]
        role=rebel2
        [modifications]
        {TRAIT_LOYAL}
        [/modifications]
        type="DB Young Ogre"
        x=34
        y=20
    [/unit]
    [unit]
        role=rebel2
        [modifications]
        {TRAIT_LOYAL}
        [/modifications]
        type="DB Young Ogre"
        x=36
        y=24
    [/unit]
    [unit]
        role=rebel2
        [modifications]
        {TRAIT_LOYAL}
        [/modifications]
        type="DB Young Ogre"
        x=49
        y=26
    [/unit]
    [unit]
        role=rebel2
        [modifications]
        {TRAIT_LOYAL}
        [/modifications]
        type="DB Young Ogre"
        x=41
        y=21
    [/unit]
    [unit]
        role=rebel2
        [modifications]
        {TRAIT_LOYAL}
        [/modifications]
        type="DB Young Ogre"
        x=42
        y=25
    [/unit]
    [unit]
        role=rebel2
        [modifications]
        {TRAIT_LOYAL}
        [/modifications]
        type="DB Young Ogre"
        x=39
        y=28
    [/unit]
    [/side]

#Сперва пусть будет престарт с настройкой ИИ
#Впредь мне надо более ответственно подходить к структурированию моего кода
#Я переделаю код первых миссий, чтобы он был более удобным и стройным
#Пока не уверен насчёт макросов

[event]
name=prestart

        [micro_ai]
            side=2
            ai_type=simple_attack
            action=add
            ca_score=300000
            [filter]
                side=2
            [/filter]
            [filter_second]
            role=rebel1
            [/filter_second]
        [/micro_ai]

        [micro_ai]
            side=2
            ai_type=simple_attack
            action=add
            ca_score=300000
            [filter]
                side=2
            [/filter]
            [filter_second]
            role=rebel2
            [/filter_second]
        [/micro_ai]

        [micro_ai]
            side=3
            ai_type=simple_attack
            action=add
            ca_score=600000
            [filter]
                role=rebel1
            [/filter]
            [filter_second]
            role=guard1
            [/filter_second]
        [/micro_ai]
        [micro_ai]
            side=3
            ai_type=simple_attack
            action=add
            ca_score=600000
            [filter]
                role=rebel2
            [/filter]
            [filter_second]
            role=guard2
            [/filter_second]
        [/micro_ai]
         [micro_ai]
            side=3
            ai_type=coward
            action=add

            [filter]
            type=DB Young Ogre
            [/filter]
            [filter_second]
            type=Wolf Rider
            side=2
            [/filter_second]
            distance=4
            avoid_x,avoid_y=40,9
            radius=11
            attack_if_trapped=yes
            ca_score=500000
        [/micro_ai]


#Реколл Мурши

        [recall]
        id=Mursha
        x,y=11,27
        [/recall]

[/event]

#В этом сценарии одно из условий поражения - смерть огров, поэтому ивенты поражения помещу в конец, один за другим
#Надо добавить переменную для диалога после освобождения всех огров

[event]
name=start

    [message]
    speaker=Mursha
    message= _"This is the land of the DreadWood Clan. The rumors were true - the orcs had indeed turned the ogres into slaves."
    [/message]

    [scroll_to]
    x,y=38,24
    [/scroll_to]
    [delay]
    time=2000
    [/delay]
    [scroll_to]
    x,y=19,13
    [/scroll_to]
    [delay]
    time=2000
    [/delay]
    [message]
    speaker=Slaver
    message= _"Who are you, chief? Why have you come with your army to my land?"
    [/message]
    [message]
    speaker=Bastard
    message= _"I'm Mug the Harmful of the Coldblood clan. I have come to-"
    [/message]
    [message]
    speaker=Slaver
    message= _"Ah, motherfucker Mug. Get outta here. I don't do business with freaks."
    [/message]
    [message]
    speaker=Bastard
    message= _"Filthy scum! I, Mug the Harmful, heir to the Khan of the Ogres, have come to slit your throat and free the ogres!"
    [/message]
    [message]
    speaker=Slaver
    message= _"I don't even want to hear your bullshit. Get out of here before I sweep you and your wretched army to the ground."
    [/message]
    [message]
    speaker=Bastard
    message= _"No way."
    [/message]
    [message]
    speaker=Slaver
    message= _"Well, you chose death. I think the Orcs of the Coldblood Clan will thank me!"
    [/message]
    [message]
    speaker=narrator
    message= _"Rumors of an heir to the Khan of the ogres have stirred the ogres. The fields became restless."
    [/message]
    [message]
    role=guard1
    message= _"Chief! Those assholes have risen again!"
    [/message]
    [message]
    speaker=Slaver
    message= _"Ar-r, that's the last thing we need! Wolf riders, deal with the rebels! We kille Mug the Asshole later."
    [/message]
    [message]
    speaker=Mursha
    message= _"First of all, we must help the rebellious ogres. If they are slaughtered, our entire quest will fail."
    [/message]

    [set_variable]
    name=saved_ogres
    value=0
    [/set_variable]
    [set_variable]
    name=dead_ogres
    value=0
    [/set_variable]

#Задания

    [objectives]
          silent=no
            [objective]
                description= _ "Save the rebel ogres"
                condition=win
            [/objective]
            [objective]
                description= _ "When you kill all the wardens on a field, the ogres from that field will come under your control. Release all the ogres."
                condition=win
            [/objective]
            [objective]
                #ifdef EASY
                description= _ "The Death of 12 rebel ogres ($dead_ogres|/10)"
                #endif
                #ifdef NORMAL
                description= _ "The Death of 10 rebel ogres ($dead_ogres|/9)"
                #endif
                #ifdef HARD
                description= _ "The Death of 8 rebel ogres ($dead_ogres|/8)"
                #endif
                condition=lose
            [/objective]
            [objective]
                description= _ "The Death of Mug the Harmful"
                condition=lose
            [/objective]
             [objective]
                description= _ "The Death of Mursha"
                condition=lose
            [/objective]
            [gold_carryover]
                bonus=yes
                carryover_percentage=20
            [/gold_carryover]
    [/objectives]    
[/event]

#Дальше пропишу переход огров на сторону игрока, затем - условия поражения

[event]
name=die
first_time_only=no

    [filter]
    role=guard1
    [/filter]

    [if]
    [have_unit]
    role=guard1
    [/have_unit]
    [then]
    [/then]
    [else]
    [message]
    role=rebel1
    message= _"Khan has returned and freed us!"
    [/message]

    [modify_unit]
    [filter]
    role=rebel1
    [/filter]
    side=1
    [/modify_unit]

    {VARIABLE_OP saved_ogres add 1}

    [/else]
    [/if]

[/event]
[event]
name=die
first_time_only=no

    [filter]
    role=guard2
    [/filter]

    [if]
    [have_unit]
    role=guard2
    [/have_unit]
    [then]
    [/then]
    [else]
    [message]
    role=rebel2
    message= _"Khan has returned and freed us!"
    [/message]

    [modify_unit]
    [filter]
    role=rebel2
    [/filter]
    side=1
    [/modify_unit]

    {VARIABLE_OP saved_ogres add 1}

    [/else]
    [/if]

[/event]

#Диалог про освобождение огров и новая цель

[event]
name=new_turn
first_time_only=no

    [if]

    [variable]
    name=saved_ogres
    numerical_equals=2
    [/variable]

    [then]
    [message]
    speaker=Mursha
    message= _"We freed all the ogres. Now we can return home."
    [/message]
    [message]
    speaker=Bastard
    message= _"No. I want to stab the bastard."
    [/message]
    [scroll_to]
    x,y=39,11
    [/scroll_to]
    [delay]
    time=2000
    [/delay]
    [message]
    speaker=Mursha
    message= _"But the Dead Tree Fortress is well defended. We'll lose our entire army if we try to storm the walls. And we have no siege machines to breach the mighty gates."
    [/message]
    [message]
    race=ogre
    message= _"Please, Khan, don't go. Khan must save our brothers who are being held in the fortress."
    [/message]
    [message]
    speaker=Bastard
    message= _"Do they hate Deadwood, too?"
    [/message]
    [message]
    race=ogre
    message= _"Yeah, yeah. The evil chief took the strong ogres to work the fortress and open the heavy gates. If they see Khan saving us, they will open the gate for Khan."
    [/message]
    [message]
    speaker=Bastard
    message= _"I hope you're telling the truth. Orcs and ogres! We're all heading for the gate!"
    [/message]
    [message]
    speaker=Mursha
    message= _"This is insane. Mug, you're a complete idiot."
    [/message]


    [objectives]
          silent=no
            [objective]
                description= _ "Convince the ogres in the fortress to open the gate for you."
                condition=win
            [/objective]
            [objective]
                description= _ "To convince them, bring 5 ogres to the gate (3 hex radius from the gate)."
                condition=win
            [/objective]
            [objective]
                description= _ "The Death of Mug the Harmful"
                condition=lose
            [/objective]
             [objective]
                description= _ "The Death of Mursha"
                condition=lose
            [/objective]
            [gold_carryover]
                bonus=yes
                carryover_percentage=20
            [/gold_carryover]
    [/objectives] 

    {CLEAR_VARIABLE saved_ogres}   

    [set_variable]
    name=rebellion
    value=0
    [/set_variable]
        [micro_ai]
            side=2
            ai_type=simple_attack
            action=delete
        [/micro_ai]
        [micro_ai]
            side=3
            ai_type=simple_attack
            action=delete
        [/micro_ai]
         [micro_ai]
            side=3
            ai_type=coward
            action=delete
        [/micro_ai]

    [/then]
    [else]
    [/else]
    [/if]
[/event]

#Теперь условие опускания ворот и мятежа внутри крепости

[event]
name=moveto
first_time_only=no
  
    [filter]
        side=1
        race=ogre
        [not]
        role=movedogre
        [/not]
        [filter_location]
        x,y=33,17
        radius=3
        [/filter_location]
    [/filter]

          {VARIABLE_OP rebellion add 1}

    [modify_unit]
    [filter]
    x,y=$unit.x,$unit.y
    [/filter]
    role=movedogre
    [/modify_unit]

    [if]
    [variable]
        name=rebellion
        numerical_equals=5
    [/variable]
    [then]
    [message]
    role=treator
    message= _"Khan has freed the ogres! Khan has come for us! Praise be to Khan! Kill the evil orcs!"
    [/message]

    {REPLACE_SCENARIO_MUSIC the_city_falls.ogg}

    [modify_unit]
    [filter]
    role=treator
    [/filter]
    side=3
    [/modify_unit]

    [scroll_to]
    x,y=35,16
    [/scroll_to]

    [sound]
    name=flail-miss.ogg
    [/sound]
    [delay]
    time=100
    [/delay]
    [sound]
    name=flail-miss.ogg
    [/sound]
    [delay]
    time=100
    [/delay]
    [sound]
    name=flail-miss.ogg
    [/sound]
    [delay]
    time=100
    [/delay]

    {QUAKE ""}

    [sound]
    name=wose-die.ogg
    [/sound]
    [sound]
    name=open-chest.wav
    [/sound]
    [sound]
    [sound]
    name=open-chest.wav
    [/sound]
    name=wose-die.ogg
    [/sound]
    [sound]
    name=open-chest.wav
    [/sound]
    [sound]
    name=wose-die.ogg
    [/sound]

    {MODIFY_TERRAIN Rr^Pw\o 34 15}
    {MODIFY_TERRAIN Rr^Pw\o 35 16}
    {MODIFY_TERRAIN Rr^Pw\o 36 16}

    [redraw][/redraw]

    [delay]
    time=1500
    [/delay]

    [message]
    speaker=Slaver
    message= _"Damn it! Kill the traitors! Kill them all!"
    [/message]
    [modify_side]
    {GOLD 80 100 120}
    side=2
    #ifdef EASY
    recruit=Orcish Grunt,Orcish Archer
    #endif
    #ifdef NORMAL
    recruit=Orcish Grunt,Orcish Warrior,Orcish Archer,Orcish Assassin
    #endif
    #ifdef HARD
    recruit=Orcish Grunt,Orcish Warrior,Orcish Archer,Orcish Crossbowman,Orcish Assassin
    #endif
    [/modify_side]
    [modify_unit]
    [filter]
    side=2
    max_moves=0
    [/filter]
    max_moves=$unit.max_moves
    [/modify_unit]
    [modify_unit]
    [filter]
    side=3
    max_moves=0
    [/filter]
    max_moves=$unit.max_moves
    [/modify_unit]

     [objectives]
          silent=no
            [objective]
                description= _ "Kill the DreadWood Chief"
                condition=win
            [/objective]
            [objective]
                description= _ "The Death of Mug the Harmful"
                condition=lose
            [/objective]
             [objective]
                description= _ "The Death of Mursha"
                condition=lose
            [/objective]
            [gold_carryover]
                bonus=yes
                carryover_percentage=20
            [/gold_carryover]
    [/objectives] 
    
    {CLEAR_VARIABLE rebellion}
    {CLEAR_VARIABLE dead_ogres}

    [/then]
    [else]
    [/else]
    [/if]
[/event]

#Мне нужно узнать, как менять модификации юнитов с помощью ивентов... Хотя, есть идея. Но её я попробую потом
#Наверное, нет смысла в поражении за количество огров - по задумке, восставшие в крепости огры тоже присоединятся к нам
#Напишу сперва условие победы
#Завтра добавлю более эпичную катсцену с разрушениями

[event]
name=last_breath

    [filter]
    id=Slaver
    [/filter]

    [message]
    speaker=Slaver
    message= _"I don't believe it... Bastard Mug... Damn you and your ogres!"
    [/message]
    [message]
    speaker=Bastard
    message= _"I love hearing the death cries of scumbags like you. Die, asshole."
    [/message]
    [message]
    race=ogre
    message= _"Great Khan! Allow us to destroy the hated fortress and devour the evil orcs!"
    [/message]
    [message]
    speaker=Bastard
    message= _"Do whatever you want. Give the bastards what they deserve!"
    [/message]

    [scroll_to]
    x,y=40,9
    [/scroll_to]
    [delay]
    time=1000
    [/delay]

    {QUAKE "dwarf-laugh.wav"}
    {QUAKE "rumble.ogg"}
    {QUAKE "rumble.ogg"}
    {QUAKE "explosion.ogg"}
    {QUAKE "wose-die.ogg"}
    {QUAKE "rumble.ogg"}
    {QUAKE "wose-die.ogg"}
    {QUAKE "rumble.ogg"}
    {QUAKE "rumble.ogg"}
    {QUAKE "explosion.ogg"}
    {QUAKE "wose-die.ogg"}
    {QUAKE "rumble.ogg"}
    {QUAKE "wose-die.ogg"}
    {QUAKE "rumble.ogg"}
    {QUAKE "rumble.ogg"}
    [kill]
    side=2
    level=1
    animate=no
    [/kill]
    [delay]
    time=300
    [/delay]
    {QUAKE "explosion.ogg"}
    {QUAKE "wose-die.ogg"}
    {QUAKE "rumble.ogg"}
    {QUAKE "wose-die.ogg"}
    {QUAKE "rumble.ogg"}
    {QUAKE "rumble.ogg"}
    {QUAKE "explosion.ogg"}
    {QUAKE "wose-die.ogg"}
    {QUAKE "rumble.ogg"}
    {QUAKE "wose-die.ogg"}
    {QUAKE "rumble.ogg"}
    {QUAKE "rumble.ogg"}
    [kill]
    side=2
    level=2
    animate=no
    [/kill]
    [delay]
    time=300
    [/delay]
    {QUAKE "explosion.ogg"}
    {QUAKE "wose-die.ogg"}
    {QUAKE "rumble.ogg"}
    {QUAKE "wose-die.ogg"}
    {QUAKE "rumble.ogg"}
    {QUAKE "rumble.ogg"}
    [kill]
    side=2
    level=3
    animate=no
    [/kill]
    [delay]
    time=300
    [/delay]
    {QUAKE "explosion.ogg"}
    {QUAKE "wose-die.ogg"}
    {QUAKE "rumble.ogg"}
    {QUAKE "wose-die.ogg"}
    [replace_map]
            map_file=~add-ons/Dirty_Blood/maps/Revolution_Сrush.map
            expand=yes
            shrink=yes
    [/replace_map]
    [redraw][/redraw]

    [delay]
    time=2000
    [/delay]
   
    [message]
    speaker=Bastard
    message= _"Another cocky orc lost his life, and I gained an army of loyal ogres. It's time to return to the fortress. No one can challenge my authority now."
    [/message]

    [endlevel]
    result=victory
    [/endlevel]
[/event]

#А вот и условия поражения
#Сперва напишу главных героев, затем - огров
#Возможно, их стоит занести в макрос и копировать в другие миссии

[event]
name=die

    [filter]
    id=Bastard
    [/filter]

    [message]
    speaker=Mursha
    message=_ "That idiot let himself get killed! Now the tribe will fall back into strife!"
    [/message]
    [endlevel]
    result=defeat
    [/endlevel]
[/event]
[event]
name=die

    [filter]
    id=Mursha
    [/filter]

    [message]
    speaker=Bastard
    message=_ "Mursha's dead! Who will help me on my hikes now?"
    [/message]
    [endlevel]
    result=defeat
    [/endlevel]
[/event]

#Теперь про огров
#После небольших тестов добавлю ранжирование по уровню сложности
#Опять переменная 

[event]
name=die
first_time_only=no

    [filter]
    type=DB Young Ogre
    [/filter]

    {VARIABLE_OP dead_ogres add 1}

    [objectives]
          silent=yes
            [objective]
                description= _ "Save the rebel ogres"
                condition=win
            [/objective]
            [objective]
                description= _ "When you kill all the wardens on a field, the ogres from that field will come under your control. Release all the ogres."
                condition=win
            [/objective]
            [objective]
                #ifdef EASY
                description= _ "The Death of 10 rebel ogres ($dead_ogres|/12)"
                #endif
                #ifdef NORMAL
                description= _ "The Death of 9 rebel ogres ($dead_ogres|/10)"
                #endif
                #ifdef HARD
                description= _ "The Death of 8 rebel ogres ($dead_ogres|/8)"
                #endif
                condition=lose
            [/objective]
            [objective]
                description= _ "The Death of Mug the Harmful"
                condition=lose
            [/objective]
             [objective]
                description= _ "The Death of Mursha"
                condition=lose
            [/objective]
            [gold_carryover]
                bonus=yes
                carryover_percentage=20
            [/gold_carryover]
    [/objectives]    

    [if]
    [variable]
    name=dead_ogres
    #ifdef EASY
    numerical_equals=10
    #endif
    #ifdef NORMAL
    numerical_equals=9
    #endif
    #ifdef HARD
    numerical_equals=8
    #endif
    [/variable]
    [then]

    [message]
    speaker=Bastard
    message=_ "Most of the ogres are dead. Now I have nowhere to get strong support!"
    [/message]
    [endlevel]
    result=defeat
    [/endlevel]

    {CLEAR_VARIABLE dead_ogres}

    [/then]
    [else]
    [/else]
    [/if]
[/event]
[/scenario]