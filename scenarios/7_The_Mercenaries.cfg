#textdomain wesnoth-DB
[scenario]
    id=7_Mercenaries
    name = _ "The Fugitive"
    random_start_time=no
    experience_modifier=100
    map_data="{~add-ons/Dirty_Blood/maps/7_Mercenaries_Start.map}"
    victory_when_enemies_defeated=no
    next_scenario=8_The_Troll_Graveyard
    carryover_percentage=20
    carryover_add=yes
    current_time=3

    {TURNS 10 8 6}
    
    {SCENARIO_MUSIC "casualties_of_war.ogg"}
    {EXTRA_SCENARIO_MUSIC "the_city_falls.ogg"}
    {EXTRA_SCENARIO_MUSIC "knolls.ogg"}
    {APPEND_MUSIC elvish-theme.ogg}
    {APPEND_MUSIC nunc_dimittis.ogg}

    {WINTER_SCHEDULE}
    
    {EVENTS_FOR_ABILITIES}
   
    [item]
    	image="scenery/mine-abandoned.png"
    	visible_in_fog=yes
    	x=26
    	y=14
    [/item]
    [item]
    	image="scenery/mine-abandoned.png"
    	visible_in_fog=yes
    	x=29
    	y=6
    [/item]
    [item]
        image="items/orcish-flag.png"
        visible_in_fog=yes
        x=6
        y=10
    [/item]
    [item]
        image="items/orcish-flag.png"
        visible_in_fog=yes
        x=14
        y=5
    [/item]
    [item]
        image="items/orcish-flag.png"
        visible_in_fog=yes
        x=14
        y=16
    [/item]
    [item]
        image="items/orcish-flag.png"
        visible_in_fog=yes
        x=32
        y=10
    [/item]
    [item]
        image="items/burial.png"
        visible_in_fog=yes
        x=37
        y=9
    [/item]
    [item]
        image="items/orcish-flag.png"
        visible_in_fog=yes
        x=42
        y=1
    [/item]
    [item]
        image="items/burial.png"
        visible_in_fog=yes
        x=42
        y=14
    [/item]
    [item]
        image="items/orcish-flag.png"
        visible_in_fog=yes
        x=47
        y=13
    [/item]
    [item]
        image="items/burial.png"
        visible_in_fog=yes
        x=48
        y=12
    [/item]
    [item]
        image="items/orcish-flag.png"
        visible_in_fog=yes
        x=51
        y=6
    [/item]
    [item]
        image="items/orcish-flag.png"
        visible_in_fog=yes
        x=57
        y=14
    [/item]
    [item]
        image="items/straw-bale2.png"
        visible_in_fog=yes
        x=60
        y=9
    [/item]
    [item]
        image="items/scarecrow.png"
        visible_in_fog=yes
        x=64
        y=20
    [/item]
    [item]
        image="items/straw-bale1.png"
        visible_in_fog=yes
        x=66
        y=12
    [/item]

    [side]
        controller=human
        side=1
        {GOLD 300 270 250}
        {MOOG_TERRIBLE_STATS}
        team_name=bastards
        user_team_name= _ "Cold Blood Clan"
        recruit=Goblin Spearman,Wolf Rider,Orcish Archer,Murshas Apprentice,Orcish Assassin,Young Ogre
        color=blue
        fog=no
        shroud=no
    [/side]
    [side]
        controller=ai
        side=2
        {GOLD 120 150 180}
        income=30
      	no_leader=yes
        recruit=Wolf Rider,Goblin Knight,Goblin Pillager
        team_name=mercernary
        user_team_name= _ "Mercernaries"
        color=purple
        fog=no
        shroud=no
        {FLAG_VARIANT ragged}
    [/side]
    [side]
        controller=ai
        side=3
        hidden=yes
        {GOLD 300 350 400}
        income=20
        no_leader=yes
        team_name=mercernary
        passive_leader=yes
        user_team_name= _ "Mercernaries"
        color=green
        recruit=Wolf Rider,Orcish Warrior,Orcish Archer,Orcish Grunt,Troll Rocklobber
        fog=no
        shroud=no
        {FLAG_VARIANT long}
    [/side]
    [side]
        controller=ai
        side=4
        hidden=yes
        {GOLD 230 250 300}
        team_name=White_Clans
        user_team_name= _ "North White Mountain Clan"
        type=Orcish Warlord
        id=Northern_Enemy
        scroll_to_leader=no
        color=white
        fog=yes
        shroud=yes
        share_vision=all
        village_support=4

        {SCENARIO_7_WHITE_CLANS_AI}
        {FLAG_VARIANT ragged}

        [unit]
            max_moves=0
            vision=3
            role=guard
            type="Orcish Warrior"
            x=30
            y=8
        [/unit]
        [unit]
            max_moves=0
            vision=3
            role=guard
            type="Orcish Warrior"
            x=30
            y=10
        [/unit]
        [unit]
            ai_special=guardian
            type="Orcish Warrior"
            x=19
            y=8
        [/unit]
        [unit]
            ai_special=guardian
            type="Orcish Warrior"
            x=20
            y=5
        [/unit]
        [unit]
            ai_special=guardian
            type="Orcish Grunt"
            x=28
            y=5
        [/unit]
        [unit]
            ai_special=guardian
            type="Orcish Crossbowman"
            x=22
            y=11
        [/unit]
        [unit]
            ai_special=guardian
            type="Orcish Crossbowman"
            x=8
            y=8
        [/unit]
        [unit]
            ai_special=guardian
            type="Orcish Warrior"
            x=15
            y=9
        [/unit]
    [/side]
    [side]
        controller=ai
        side=5
        hidden=yes
        {GOLD 230 250 300}
        team_name=White_Clans
        user_team_name= _ "South White Mountain Clan"
        type=Orcish Warlord
        id=South_Enemy
        scroll_to_leader=no
        color=white
        fog=yes
        shroud=yes
        share_vision=all
        village_support=4

        {SCENARIO_7_WHITE_CLANS_AI}
        {FLAG_VARIANT long}

        [unit]
            max_moves=0
            vision=3
            role=guard
            type="Orcish Warrior"
            x=30
            y=14
        [/unit]
        [unit]
            max_moves=0
            vision=3
            role=guard
            type="Orcish Warrior"
            x=31
            y=17
        [/unit]
        [unit]
            max_moves=0
            vision=3
            role=guard
            type="Orcish Warrior"
            x=29
            y=16
        [/unit]
        [unit]
            ai_special=guardian
            type="Orcish Crossbowman"
            x=24
            y=15
        [/unit]
        [unit]
            ai_special=guardian
            type="Orcish Grunt"
            x=28
            y=14
        [/unit]
        [unit]
            ai_special=guardian
            type="Orcish Warrior"
            x=20
            y=16
        [/unit]
        [unit]
            ai_special=guardian
            type="Orcish Warrior"
            x=16
            y=11
        [/unit]
        [unit]
            ai_special=guardian
            type="Orcish Warrior"
            x=6
            y=13
        [/unit]
    [/side]

    #реколлы, ИИ, спрятать юнитов 4 и 5 стороны

    [event]
    name=prestart
    {ALLOW_WOLVES}

    [hide_unit]
        side=4,5
    [/hide_unit]

            [micro_ai]
                side=2
                ai_type=simple_attack
                action=add
                ca_score=200000
                [filter]
                    side=2
                [/filter]
                [filter_second]
                id=Bastard,Mursha
                [/filter_second]
            [/micro_ai]
            [micro_ai]
                side=3
                ai_type=simple_attack
                action=add
                ca_score=200000
                [filter]
                    side=3
                [/filter]
                [filter_second]
                id=Bastard,Mursha
                [/filter_second]
            [/micro_ai]
            [micro_ai]
                side=4
                ai_type=simple_attack
                action=add
                ca_score=400000
                [filter]
                    side=4
                [/filter]
                [filter_second]
                    side=1
                [/filter_second]
            [/micro_ai]
            [micro_ai]
                side=5
                ai_type=simple_attack
                action=add
                ca_score=400000
                [filter]
                    side=5
                [/filter]
                [filter_second]
                    side=1
                [/filter_second]
            [/micro_ai]     
    [/event]

    [event]
    name=start

        #after the previous scenario's effects disappear, Moog is left with 3 moves for the first turn, fix it

        [modify_unit]
            [filter]
                id=Bastard
            [/filter]
            moves=5
        [/modify_unit]

        [recall]
            id=Mursha
            x,y=61,17
            animate=yes
        [/recall]

        [unit]
            type=Ogre
            side=1
            x,y=62,15
            animate=yes
        [/unit]
        [unit]
            type=Ogre
            side=1
            x,y=61,18
            animate=yes
        [/unit]
        [unit]
            type=Young Ogre
            side=1
            x,y=60,15
            animate=yes
        [/unit]
        [unit]
            type=Goblin Impaler
            side=1
            x,y=62,17
            animate=yes
        [/unit]
        [unit]
            type=Goblin Impaler
            side=1
            x,y=61,15
            animate=yes
        [/unit]
        [unit]
            type=Orcish Archer
            side=1
            x,y=59,17
            animate=yes
        [/unit]

        [unit]
            side=2
            type=Direwolf Rider
            name= _ "Mercernary Chief"
            canrecruit=yes
            max_moves=0
            facing=sw
            id=Merc1
            x,y=67,17
        [/unit]

        [unit]
            side=2
            type=Wolf Rider
            name= _ "Mercernary Rider"
            id=rider2
            x,y=67,17
        [/unit]

        {MOVE_UNIT id=rider2 62 18}

        [unit]
            side=2
            type=Goblin Pillager
            name= _ "Mercernary Rider"
            id=rider3
            x,y=67,17
        [/unit]

        {MOVE_UNIT id=rider3 61 14}

        [unit]
            side=2
            type=Wolf Rider
            name= _ "Mercernary Rider"
            id=rider4
            x,y=67,17
        [/unit]

        {MOVE_UNIT id=rider4 59 18}

        [unit]
            side=2
            type=Wolf Rider
            name= _ "Mercernary Rider"
            id=rider5
            x,y=67,17
        [/unit]

        {MOVE_UNIT id=rider5 60 19}

        [unit]
            side=2
            type=Goblin Pillager
            name= _ "Mercernary Rider"
            id=rider6
            x,y=67,17
        [/unit]

        {MOVE_UNIT id=rider6 60 13}
        
        [unit]
            side=2
            type=Direwolf
            name= _ "Guardian Wolf"
            id=wolfguard1
            max_moves=0
            x,y=67,17
            [modifications]
        		{TRAIT_LOYAL}
        		{TRAIT_RESILIENT}
        	[/modifications]
        [/unit]
        
        {MOVE_UNIT id=wolfguard1 66 15}
        
        [unit]
            side=2
            type=Direwolf
            name= _ "Guardian Wolf"
            id=wolfguard2
            max_moves=0
            x,y=67,17
            [modifications]
        		{TRAIT_LOYAL}
        		{TRAIT_STRONG}
        	[/modifications]
        [/unit]
        
        {MOVE_UNIT id=wolfguard2 65 18}

        [message]
        speaker=Mursha
        message= _ "We're surrounded!"
        [/message]
        [message]
        speaker=Bastard
        message= _ "What do you want, riders? I am the chief of the Coldblood Clan, by the law of the Supreme Leader, you cannot attack me."
        [/message]
        [message]
        speaker=Merc1
        message= _ "Heh-heh, chief! He says he's the chief! Just like she said. You're not fooling us, impostor. The real chief Coldblood is in the fortress right now. And we'll get a nice reward for you!"
        [/message]
        [message]
        speaker=Bastard
        message= _ "Did Lokra send you?"
        [/message]
        [message]
        speaker=Merc1
        message= _ "I won't say anything! Heh-heh! Get them!"
        [/message]
        [message]
        speaker=Mursha
        message= _ "There's an abandoned fort up ahead. If we reach it, we can fight off the goblins, let's go!"
        [/message]

        {HIGHLIGHT_IMAGE 43 11 items/gohere.png ()}

        [objectives]
              silent=no
                [objective]
                    description= _ "Moog has to get to the fort"
                    condition=win
                [/objective]
                   [objective]
                    description= _ "Death of Moog the Terrible"
                    condition=lose
                [/objective]
                [objective]
                    description= _ "Death of Mursha"
                    condition=lose
                [/objective]
                [objective]
                    description= _ "Turns run out"
                    condition=lose
                [/objective]
                [gold_carryover]
                    bonus=yes
                    carryover_percentage=20
                [/gold_carryover]
        [/objectives]   
    [/event]

    #Moog in fortess

    [event]
    name=moveto
    first_time_only=yes

        [filter]
        id=Bastard
            [filter_location]
                x,y=43,11
            [/filter_location]
        [/filter]

        {REMOVE_IMAGE 43 11}

        [message]
        speaker=Bastard
        message=_ "The fort is ours! Warriors, to arms!"
        [/message]
        [message]
        speaker=Mursha
        message=_ "We need to get rid of our pursuers. Goblins are cowardly. Let's make them retreat!"
        [/message]

        [set_variable]
            name=deadgoblins
            value=0
        [/set_variable]
        [set_variable]
            name=timer
            value=1
        [/set_variable]
        [modify_turns]
            #ifdef EASY
            add=40
            #endif
            #ifdef NORMAL
            add=35
            #endif
            #ifdef HARD
            add=30
            #endif
        [/modify_turns]

        [objectives]
              silent=no
                [objective]
                    description= _ "Kill 8 mercernaries ($deadgoblins|/8)"
                    condition=win
                [/objective]
                   [objective]
                    description= _ "Death of Moog"
                    condition=lose
                [/objective]
                   [objective]
                    description= _ "Death of Mursha"
                    condition=lose
                [/objective]
                [objective]
                    description= _ "Turns run out"
                    condition=lose
                [/objective]
                [gold_carryover]
                    bonus=yes
                    carryover_percentage=20
                [/gold_carryover]
                delayed_variable_substitution=yes
        [/objectives]

        #теперь смерти гоблинов учитываются в задание

        [event]
        name=last_breath
        first_time_only=no

            [filter]
            side=2
            [/filter]
            {VARIABLE_OP deadgoblins add 1}
        [/event]
    [/event]

    #таймер и бонусная волна

    [event]
    name=new_turn
    first_time_only=no
          
        [if]
            [variable]
            name=timer
            numerical_equals=1
            [/variable]

        [then]

            {REPEAT 3 (

            [unit]
            side=2
            type=Goblin Pillager
            name= _ "Mercernary Rider"
            x,y=42,21
            [/unit]

            {MOVE_UNIT x,y=42,21 44 18})} 

            {REPEAT 3 (

            [unit]
            side=2
            type=Wolf Rider
            name= _ "Mercernary Rider"
            x,y=42,21
            [/unit]

            {MOVE_UNIT x,y=42,21 44 18})} 

            {CLEAR_VARIABLE timer}
        [/then]
        [else]
        [/else]
        [/if]
    [/event]

    #условие выполнения задания 1

    [event]
    name=die
    first_time_only=no

        [filter]
            side=2
        [/filter]

    [if]

        [variable]
        name=deadgoblins
        numerical_equals=8
        [/variable]

    [then]

        [message]
        side=2
        message=_ "The bastard's too strong! Run!"
        [/message]

        {CLEAR_VARIABLE deadgoblins}

        [kill]
        side=2
        animate=no
        [/kill]

        [message]
        speaker=Bastard
        message=_ "We defeated the mercenaries, but don't found out who sent them."
        [/message]
        [message]
        speaker=Mursha
        message=_ "Their leader said that the real chief of our clan is in the fortress right now. But I don't think Ka'ah would let that happen. Maybe he lied..."
        [/message]
        [message]
        speaker=Bastard
        message=_ "Or Bagul and Lokra overthrew Ka'ah."
        [/message]
        [message]
        speaker=Mursha
        message=_ "It's hard for me to think about, but it's a possibility. Either way, we've defeated the mercenaries, so we can move on in peace."
        [/message]

        [replace_map]
        map_file=~add-ons/Dirty_Blood/maps/7_Mercenaries.map
        shrink=yes
        expand=yes
        [/replace_map]

        [unhide_unit]
            side=4,5
        [/unhide_unit]

        {CAPTURE_VILLAGES 4 15 3 10} 
        {CAPTURE_VILLAGES 5 15 19 8} 
        {CAPTURE_VILLAGES 5 30 19 5} 
        {CAPTURE_VILLAGES 5 25 13 1} 
        {CAPTURE_VILLAGES 5 3 9 1} 

        [modify_side]
            [filter]
                side=3,4,5
            [/filter]
            hidden=no
        [/modify_side]

        [unit]
        side=3
        type=Orcish Warlord
        color=Green
        x,y=39,2
        id=Merc2
        name=_ "Durbul"
        canrecruit=yes
        [/unit]
        [unit]
        side=3
        type=Troll Rocklobber
        role=rocklobber
        id=trollo
        x,y=39,3
        [/unit]
        [unit]
        side=3
        type=Orcish Warrior
        x,y=40,2
        [/unit]
        [unit]
        side=3
        type=Goblin Knight
        x,y=40,2
        [/unit]
        [unit]
        side=3
        type=Goblin Pillager
        x,y=39,1
        [/unit]
        [unit]
        side=3
        type=Orcish Crossbowman
        x,y=38,2
        [/unit]
        [unit]
        side=3
        type=Wolf Rider
        x,y=38,1
        [/unit]
        [modify_unit]
            [filter]
                side=3
            [/filter]
            [status]
                slowed=yes
            [/status]
        [/modify_unit]
        [message]
        speaker=Merc2
        message=_ "Looks like we're just in time, guys! We'll capture the bastard, use the bounty money to hire more warriors, and take over the entire worthless Cold Blood clan!"
        [/message]
        [message]
        speaker=Bastard
        message=_ "More mercenaries! Let's kill them!"
        [/message]
        [message]
        speaker=Mursha
        message=_ "No, there's something wrong here. If a whole clan has come for us, it means that the chiefs have understood the Supreme Leader's message. There may be more mercernaries coming. We must get to the trolls before they surround us!"
        [/message]

        {HIGHLIGHT_IMAGE 1 5 items/gohere.png ()}

        [message]
        speaker=Bastard
        message=_ "What awaits us further down the road?"
        [/message]
        [message]
        speaker=Mursha
        message=_ "We'll have to pass through the White Mountain clan lands. This great clan once split in two, but now they control the pass together. As far as I know, the White Mountain respects the laws of the Supreme Ruler, so I don't think they'll attack us."
        [/message]
        [message]
        speaker=Bastard
        message=_ "If they respect the Supreme Leader, then they respect his innuendos as well. I'll be on my guard."
        [/message]

        [objectives]
              silent=no
                [objective]
                    description= _ "Move Moog to the end of the road"
                    condition=win
                [/objective]
                   [objective]
                    description= _ "Death of Moog the Terrible"
                    condition=lose
                [/objective]
                   [objective]
                    description= _ "Death of Mursha"
                    condition=lose
                [/objective]
                [gold_carryover]
                    bonus=yes
                    carryover_percentage=20
                [/gold_carryover]
        [/objectives] 
        {FORCE_CHANCE_TO_HIT (side=1) (id=Merc2) 0 ()}  
    [/then]
    [else]
    [/else]
    [/if]
    [/event]

    [event]
    name=moveto
    first_time_only=yes

        [filter]
            side=1
            [filter_location]
                x="21,22,22,23,23,23,24,25,26,27,28,29,30,31,31,32,33,34"
                y="6-22,5-10,13-22,6-7,9-11,13-22,5-22,6-22,5-22,5-22,4-22,5-22,5-22,7-12,14-22,16-22,19-22,19-21"
            [/filter_location]
        [/filter]
        
            [message]
            speaker=Northern_Enemy
            message=_ "Who wants to enter the White Mountain lands?"
            [/message]
            [message]
            speaker=Bastard
            message=_ "Moog the Terrible from the Cold Blood clan. We are going to the troll tribe in the west and are not looking for trouble with you."
            [/message]
            [message]
            speaker=Northern_Enemy
            message=_ "Bastard Moog? You're finally here! I'll take your head to Barag-Gor and receive a reward from the Supreme Leader!"
            [/message]
            [message]
            speaker=South_Enemy
            message=_ "What do you mean, "you"? We agreed to catch Moog together!"
            [/message]
            [message]
            speaker=Northern_Enemy
            message=_ "Bullshit! It's obviously a competition. Whoever catches the Moog is rewarded. "
            [/message]
            [message]
            speaker=South_Enemy
            message=_ "Then I'll catch him first, even if I have to slaughter your entire army!"
            [/message]
            [message]
            speaker=Bastard
            message=_ "So that's loyalty to the Black Eye's laws. Ugh! At least these bastards are fighting amongst themselves. Let's break through their mobs and get out of here."
            [/message]

            [modify_side]
                side=4
                team_name=North
                #ifdef EASY
                recruit=Orcish Grunt,Orcish Archer,Orcish Assassin,Goblin Spearman,Wolf Rider
                #endif
                #ifdef NORMAL
                recruit=Orcish Grunt,Orcish Archer,Orcish Assassin,Goblin Spearman,Wolf Rider,Orcish Warrior
                #endif
                #ifdef HARD
                recruit=Orcish Grunt,Orcish Archer,Orcish Assassin,Goblin Spearman,Wolf Rider,Orcish Warrior,Yeti
                #endif
            [/modify_side]
            [modify_side]
                side=5
                team_name=South
                #ifdef EASY
                recruit=Orcish Grunt,Orcish Archer,Orcish Assassin,Goblin Spearman,Wolf Rider
                #endif
                #ifdef NORMAL
                recruit=Orcish Grunt,Orcish Archer,Orcish Assassin,Goblin Spearman,Wolf Rider,Orcish Warrior
                #endif
                #ifdef HARD
                recruit=Orcish Grunt,Orcish Archer,Orcish Assassin,Goblin Spearman,Wolf Rider,Orcish Warrior,Yeti
                #endif
            [/modify_side]
    [/event]
    [event]
    name=attack
    first_time_only=yes

        [filter]
            side=3
        [/filter]
        [filter_second]
            side=4,5
        [/filter_second]
      
        [message]
        side=$second_unit.side
        canrecruit=yes
        message=_ "Get away from my borders, you assholes! Moog has entered my lands, so he's mine!"
        [/message]
        [message]
        speaker=Merc2
        message=_ "I don't care about your boundaries. Warriors, slaughter the white scumbags without a second thought if they get in your way!"
        [/message]
    [/event]
    [event]
    name=moveto

            [filter]
                id=Bastard
                [filter_location]
                    x,y=1,5
                [/filter_location]
            [/filter]

            [message]
            speaker=Bastard
            message=_ "So they were hired by an "elder". Maybe I should have killed Ka'ah in the square..."
            [/message]
            [message]
            speaker=Mursha
            message=_ "You'll think about that after your arm is repaired! Move on!"
            [/message]
            [endlevel]
            result=victory
            [/endlevel]
    [/event]

    [event]
    name=moveto
    first_time_only=yes
        [filter]
            side=1
            [filter_location]
                x,y=29,6
            [/filter_location]
        [/filter]

        [message]
        speaker=unit
        message=_ "There's some gold left in the castle catacombs!"
        [/message]

        [sound]
        name=gold.ogg
        [/sound]
        [gold]
        side=1
        #ifdef EASY
        amount=100
        #endif
        #ifdef NORMAL
        amount=80
        #endif
        #ifdef HARD
        amount=60
        #endif
        [/gold]
    [/event]

    [event]
    name=moveto
    first_time_only=yes

        [filter]
            side=1
        [filter_location]
            x,y=26,14
        [/filter_location]
        [/filter]

        [message]
        speaker=unit
        message=_ "There's some gold left in the castle catacombs!"
        [/message]

        [sound]
        name=gold.ogg
        [/sound]
        [gold]
        side=1
        #ifdef EASY
        amount=100
        #endif
        #ifdef NORMAL
        amount=80
        #endif
        #ifdef HARD
        amount=60
        #endif
        [/gold]
    [/event]
    {MOOG_MURSHA_DEATH}
[/scenario]
