#textdomain wesnoth-DB
[scenario]
    id=7_Mercenaries
    name = _ "Mercenaries"
    random_start_time=no
    experience_modifier=100
    map_data="{~add-ons/Dirty_Blood/maps/7_Mercenaries.map}"
    victory_when_enemies_defeated=no
    next_scenario=8_The_Troll_Graveyard
    carryover_percentage=20
    carryover_add=yes
    current_time=3
    {TURNS 10 8 6}
    {SCENARIO_MUSIC "breaking_the_chains.ogg"}
    {EXTRA_SCENARIO_MUSIC "casualties_of_war.ogg"}
    {EXTRA_SCENARIO_MUSIC "the_city_falls.ogg"}
    {EXTRA_SCENARIO_MUSIC "knolls.ogg"}
    {EXTRA_SCENARIO_MUSIC "battle.ogg"}
    {DEFAULT_SCHEDULE}
    
    {EVENTS_FOR_ABILITIES}

    [side]
        controller=human
        side=1
        {GOLD 300 270 250}
        {MOOG_TERRIBLE_STATS}
        team_name=bastards
        user_team_name= _ "ColdBlooded clan"
        recruit=Goblin Spearman,Wolf Rider,Orcish Archer,Goblin Impaler, Novice Orcish Witch,Orcish Assassin,Young Ogre
        color=red
        fog=yes
        shroud=yes
    [/side]
    [side]
        controller=ai
        side=2
        {GOLD 120 150 180}
        income=30
      	no_leader=yes
        recruit=Wolf Rider,Goblin Knight,Goblin Pillager
        team_name=mercernary
        user_team_name= _ "Mercernary Clans"
        color=blue
        fog=no
        shroud=no
    [/side]
    [side]
        controller=ai
        side=3
        {GOLD 300 250 230}
        income=30
        no_leader=yes
        team_name=mercernary
        user_team_name= _ "Mercernary Clans"
        color=green
        recruit=Wolf Rider,Orcish Warrior,Orcish Archer,Orcish Grunt,Troll Rocklobber
        fog=no
        shroud=no
    [/side]
    [side]
        controller=ai
        side=4
        {GOLD 300 250 230}
        no_leader=yes
        team_name=mercernary
        user_team_name= _ "Mercernary Clans"
        recruit=Orcish Assassin,Wolf Rider,Orcish Slayer,Orcish Crossbowman
        color=purple
        fog=no
        shroud=no
    [/side]
    [side]
        controller=ai
        side=5
        {GOLD 300 250 230}
        no_leader=yes
        team_name=mercernary
        user_team_name= _ "Mercernary Clans"
        recruit=Troll,Troll Whelp,Troll Rocklobber
        color=white
        fog=no
        shroud=no
    [/side]
   

#Я думаю, надо добавить микро ИИ на фокус лидеров
#Муга и Муршу будут пытаться убить
#Они должны выяснить, что их наняла Локра

[event]
name=prestart

        [micro_ai]
            side=2
            ai_type=simple_attack
            action=add
            ca_score=200000
            [filter]
                side=2
            [/filter]
            [filter_second]
            id=Bastard,Mursha
            [/filter_second]
        [/micro_ai]
        [micro_ai]
            side=3
            ai_type=simple_attack
            action=add
            ca_score=200000
            [filter]
                side=2
            [/filter]
            [filter_second]
            id=Bastard,Mursha
            [/filter_second]
        [/micro_ai]
        [micro_ai]
            side=4
            ai_type=simple_attack
            action=add
            ca_score=200000
            [filter]
                side=2
            [/filter]
            [filter_second]
            id=Bastard,Mursha
            [/filter_second]
        [/micro_ai]
        [micro_ai]
            side=5
            ai_type=simple_attack
            action=add
            ca_score=200000
            [filter]
                side=2
            [/filter]
            [filter_second]
            id=Bastard,Mursha
            [/filter_second]
        [/micro_ai]
[/event]

#Реколлы, первая погоня, замок, цели

[event]
    name=start
    #after the previous scenario's effects disappear, Moog is left with 3 moves for the first turn, fix it
    [modify_unit]
        [filter]
            id=Bastard
        [/filter]
        moves=5
    [/modify_unit]
    [recall]
    id=Mursha
    x,y=61,17
    animate=yes
    [/recall]

    [unit]
    type=Ogre
    side=1
    x,y=62,15
    animate=yes
    [/unit]
    [unit]
    type=Ogre
    side=1
    x,y=61,18
    animate=yes
    [/unit]
    [unit]
    type=Young Ogre
    side=1
    x,y=60,15
    animate=yes
    [/unit]
    [unit]
    type=Goblin Impaler
    side=1
    x,y=62,17
    animate=yes
    [/unit]
    [unit]
    type=Goblin Impaler
    side=1
    x,y=61,15
    animate=yes
    [/unit]
    [unit]
    type=Goblin Rouser
    side=1
    x,y=59,17
    animate=yes
    [/unit]

    [unit]
    side=2
    type=Direwolf Rider
    name= _ "Mercernary Chief"
    canrecruit=yes
    max_moves=0
    facing=sw
    id=Merc1
    x,y=67,17
    [/unit]

    [unit]
    side=2
    type=Wolf Rider
    name= _ "Mercernary Rider"
    id=rider2
    x,y=67,17
    [/unit]

    {MOVE_UNIT id=rider2 62 18}

    [unit]
    side=2
    type=Goblin Pillager
    name= _ "Mercernary Rider"
    id=rider3
    x,y=67,17
    [/unit]

    {MOVE_UNIT id=rider3 61 14}

    [unit]
    side=2
    type=Wolf Rider
    name= _ "Mercernary Rider"
    id=rider4
    x,y=67,17
    [/unit]

    {MOVE_UNIT id=rider4 59 18}

    [unit]
    side=2
    type=Wolf Rider
    name= _ "Mercernary Rider"
    id=rider5
    x,y=67,17
    [/unit]

    {MOVE_UNIT id=rider5 60 19}

    [unit]
    side=2
    type=Goblin Pillager
    name= _ "Mercernary Rider"
    id=rider6
    x,y=67,17
    [/unit]

    {MOVE_UNIT id=rider6 60 13}
    
    [unit]
    side=2
    type=Direwolf
    name= _ "Guardian Wolf"
    id=wolfguard1
    max_moves=0
    x,y=67,17
    [modifications]
		{TRAIT_LOYAL}
		{TRAIT_RESILIENT}
	[/modifications]
    [/unit]
    
    {MOVE_UNIT id=wolfguard1 66 15}
    
    [unit]
    side=2
    type=Direwolf
    name= _ "Guardian Wolf"
    id=wolfguard2
    max_moves=0
    x,y=67,17
    [modifications]
		{TRAIT_LOYAL}
		{TRAIT_STRONG}
	[/modifications]
    [/unit]
    
    {MOVE_UNIT id=wolfguard2 65 18}

    [message]
    speaker=Mursha
    message= _ "Here we go! We're surrounded!"
    [/message]
    [message]
    speaker=Bastard
    message= _ "What do you want, riders? I am the chief of the Coldblood Clan, by the law of the Supreme Chief, you cannot attack me."
    [/message]
    [message]
    speaker=Merc1
    message= _ "Heh-heh, chief! He says he's the chief! Just like she said. You're not fooling us, impostor. The real Chief Coldblood is in the fortress right now. And we'll get a nice reward for you!"
    [/message]
    [message]
    speaker=Bastard
    message= _ "Did Lokra send you?"
    [/message]
    [message]
    speaker=Merc1
    message= _ "I won't say anything! Heh-heh! Get them!"
    [/message]
    [message]
    speaker=Mursha
    message= _ "There's an abandoned fort up ahead. If we reach it, we can fight off the goblins, let's go!"
    [/message]

    [remove_shroud]
    	side=1
    	x,y=43,11
    	radius=2
    [/remove_shroud]

    {HIGHLIGHT_IMAGE 43 11 items/gohere.png ()}

    [objectives]
          silent=no
            [objective]
                description= _ "Moog has to get to the fort"
                condition=win
            [/objective]
               [objective]
                description= _ "Death of Moog the Terrible"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Mursha"
                condition=lose
            [/objective]
            [objective]
                description= _ "Turns run out"
                condition=lose
            [/objective]
            [gold_carryover]
                bonus=yes
                carryover_percentage=20
            [/gold_carryover]
    [/objectives]   
    [/event]

#Приход Муга в крепость

[event]
name=moveto
first_time_only=yes

    [filter]
    id=Bastard
        [filter_location]
            x,y=43,11
        [/filter_location]
    [/filter]
    {REMOVE_IMAGE 43 11}
    [message]
    speaker=Bastard
    message=_ "The fort is ours! Warriors, to arms!"
    [/message]
    [message]
    speaker=Mursha
    message=_ "We need to get rid of our pursuers. Goblins are cowardly. Let's make them retreat!"
    [/message]

    [set_variable]
    name=deadgoblins
    value=0
    [/set_variable]
    [set_variable]
    name=timer
    value=1
    [/set_variable]
    [modify_unit]
        [filter]
        side=2
        [/filter]
        role=dead
    [/modify_unit]
    [modify_turns]
        add=40
    [/modify_turns]

    [objectives]
          silent=no
            [objective]
                description= _ "Kill 8 mercernaries ($deadgoblins|/8)"
                condition=win
            [/objective]
               [objective]
                description= _ "Death of Mug"
                condition=lose
            [/objective]
               [objective]
                description= _ "Death of Mursha"
                condition=lose
            [/objective]
            [objective]
                description= _ "Turns run out"
                condition=lose
            [/objective]
            [gold_carryover]
                bonus=yes
                carryover_percentage=20
            [/gold_carryover]
    [/objectives]   

[/event]

[event]
name=new_turn
first_time_only=no
      
        [if]
        [variable]
        name=timer
        numerical_equals=1
        [/variable]

        [then]

        {REPEAT 3 (

        [unit]
        side=2
        type=Goblin Pillager
        name= _ "Mercernary Rider"
        role=dead
        x,y=42,21
        [/unit]

        {MOVE_UNIT x,y=42,21 44 18})} 

        {REPEAT 3 (

        [unit]
        side=2
        type=Wolf Rider
        name= _ "Mercernary Rider"
        role=dead
        x,y=42,21
        [/unit]

        {MOVE_UNIT x,y=42,21 44 18})} 

        {CLEAR_VARIABLE timer}
        [/then]
        [else]
        [/else]
        [/if]

[/event]
[event]
    name=unit_recruited
    first_time_only=no
    [filter]
   		side=2
    [/filter]
    [modify_unit]
    	[filter]
    		x,y=$unit.x,$unit.y
    	[/filter]
    	role=dead
    	name=_ "Mercernary Rider"
    [/modify_unit]
[/event]
[event]
name=die
first_time_only=no

    [filter]
    role=dead
    [/filter]

    {VARIABLE_OP deadgoblins add 1}

    [if]
    [variable]
    name=deadgoblins
    numerical_equals=8
    [/variable]

    [then]
    [message]
    side=2
    message=_ "The bastard's too strong! Run!"
    [/message]

    {CLEAR_VARIABLE deadgoblins}

    [kill]
    side=2
    animate=no
    [/kill]

    [message]
    speaker=Bastard
    message=_ "We defeated the mercenaries, but don't found out who sent them."
    [/message]
    [message]
    speaker=Mursha
    message=_ "Their leader said that the real leader of our clan is in the fortress right now. But I don't think Ka'ah would let that happen. Maybe he lied..."
    [/message]
    [message]
    speaker=Bastard
    message=_ "Or Bagul and Lokra overthrew Kaa."
    [/message]
    [message]
    speaker=Mursha
    message=_ "It's hard for me to think about, but it's a possibility. Either way, we've defeated the mercenaries, so we can move on in peace."
    [/message]

    [remove_shroud]
    	side=1
    	x,y=39,2
    	radius=1
    [/remove_shroud]
    [lift_fog]
    	side=1
    	x,y=39,2
    	radius=1
    	multiturn=yes
    [/lift_fog]

    [unit]
    side=3
    type=Orcish Warlord
    color=Green
    x,y=39,2
    id=Merc2
    name=_ "Mercernary Chief"
    canrecruit=yes
    [/unit]
    [unit]
    side=3
    type=Troll Rocklobber
    role=rocklobber
    id=trollo
    x,y=39,3
    [/unit]
    [unit]
    side=3
    type=Orcish Warrior
    x,y=40,2
    [/unit]
    [unit]
    side=3
    type=Goblin Knight
    x,y=40,2
    [/unit]
    [unit]
    side=3
    type=Goblin Pillager
    x,y=39,1
    [/unit]
    [unit]
    side=3
    type=Orcish Crossbowman
    x,y=38,2
    [/unit]
    [unit]
    side=3
    type=Wolf Rider
    x,y=38,1
    [/unit]
    [modify_unit]
        [filter]
            side=3
        [/filter]
        [status]
            slowed=yes
        [/status]
    [/modify_unit]
    [message]
    speaker=Merc2
    message=_ "Looks like we're just in time, boys! Soon the Coldblood clan will belong to me. Whoever captures the bastard will get half of what I was paid!"
    [/message]
    [message]
    speaker=Bastard
    message=_ "More mercenaries! Let's kill them!"
    [/message]
    [message]
    speaker=Mursha
    message=_ "No, there's something wrong here. If a whole clan has come for us, it means that the chiefs have understood the Supreme Leader's message. There may be more thugs coming. We must get to the trolls before they surround us!"
    [/message]

    [reset_fog]
    	side=1
    [/reset_fog]
    [place_shroud]
    	side=1
    	x,y=39,2
    	radius=1
    [/place_shroud]
    [remove_shroud]
    	side=1
    	x,y=1,5
    	radius=1
    [/remove_shroud]
    [lift_fog]
    	side=1
    	x,y=1,5
    	multiturn=no
    [/lift_fog]

    {HIGHLIGHT_IMAGE 1 5 items/gohere.png ()}

     [objectives]
          silent=no
            [objective]
                description= _ "Move Moog to the end of the road"
                condition=win
            [/objective]
               [objective]
                description= _ "Death of Moog the Terrible"
                condition=lose
            [/objective]
               [objective]
                description= _ "Death of Mursha"
                condition=lose
            [/objective]
            [gold_carryover]
                bonus=yes
                carryover_percentage=20
            [/gold_carryover]
    [/objectives]   
    [/then]
    [else]
    [objectives]
          silent=yes
            [objective]
                description= _ "Kill 8 mercernaries ($deadgoblins|/8)"
                condition=win
            [/objective]
               [objective]
                description= _ "Death of Mug"
                condition=lose
            [/objective]
               [objective]
                description= _ "Death of Mursha"
                condition=lose
            [/objective]
            [objective]
                description= _ "Turns run out"
                condition=lose
            [/objective]
            [gold_carryover]
                bonus=yes
                carryover_percentage=20
            [/gold_carryover]
    [/objectives]   

    [/else]
    [/if]
[/event]
[event]
name=moveto

        [filter]
        id=Bastard
        [filter_location]
        x=1-18
        [/filter_location]
        [/filter]

        [unit]
        side=4
        type=Orcish Nightblade
        id=Merc3
        canrecruit=yes
        name=_ "Mercernary Chief"
        x,y=15,1
        [/unit]


        {MOVE_UNIT id=Merc3 12 2}

        {MODIFY_TERRAIN Ke 12 2}
        {MODIFY_TERRAIN Cer 11 2}
        {MODIFY_TERRAIN Cer 13 2}
        {MODIFY_TERRAIN Cer 11 3}
        {MODIFY_TERRAIN Cer 13 3}

        [remove_shroud]
    		side=1
    		x,y=12,2
    		radius=1
    	[/remove_shroud]
    	[lift_fog]
    		side=1
    		x,y=12,2
    		radius=1
    		multiturn=no
    	[/lift_fog]

        [message]
        speaker=Merc3
        message=_ "I knew I could take my time, stupid clansmen aren't capable of catching the bastard. The reward goes to the professionals!"
        [/message]

        [unit]
        side=5
        type=Troll Hero
        id=Merc4
        canrecruit=yes
        name=_ "Mercernary Chief"
        x,y=17,21
        [/unit]

        {MOVE_UNIT id=Merc4 8 17}

        {MODIFY_TERRAIN Ke 8 17}
        {MODIFY_TERRAIN Cer 8 16}
        {MODIFY_TERRAIN Cer 9 17}
        {MODIFY_TERRAIN Cer 7 17}

        [remove_shroud]
    		side=1
    		x,y=8,17
    		radius=1
    	[/remove_shroud]
    	[lift_fog]
    		side=1
    		x,y=8,17
    		radius=1
    		multiturn=no
    	[/lift_fog]

        [message]
        speaker=Merc4
        message=_ "Uh, small orcs would never steal a bounty from big trolls!"
        [/message]
        [message]
        speaker=Bastard
        message=_ "The trolls are coming against us too?!"
        [/message]
        [message]
        speaker=Mursha
        message=_ "The troll tribe we're looking for doesn't give their warriors to mercenaries. They're different."
        [/message]
        [message]
        speaker=Bastard
        message=_ "Okay, but they're all talking about the reward, so someone has bribed them, it's not just the Supreme Leader. I want to know if it's Lokra or not. I need answers."
        [/message]
        [message]
        speaker=Mursha
        message=_ "You're at it again, aren't you? We can't fight them, we have to run!"
        [/message]
        [message]
        speaker=Bastard
        message=_ "Shut up, Mursha. I'm making a decision. We kill one of these bastards and then we go on our way."
        [/message]

        [objectives]
          silent=no
           [objective]
                description= _ "Kill one of mercernary chiefs"
                condition=win
            [/objective]
            [objective]
                description= _ "Move Moog to the end of the road"
                condition=win
            [/objective]
               [objective]
                description= _ "Death of Mug"
                condition=lose
            [/objective]
               [objective]
                description= _ "Death of Mursha"
                condition=lose
            [/objective]
            [gold_carryover]
                bonus=yes
                carryover_percentage=20
            [/gold_carryover]
        [/objectives]

[/event]
[event]
name=last_breath
first_time_only=yes

        [filter]
        id=Merc3
        [or]
        id=Merc4
        [/or]
        [/filter] 

        [message]
        speaker=Bastard
        message=_ "Who hired you, scumbag? Lokra? Bagul?"
        [/message]
        [message]
        speaker=unit
        message=_ "I won't tell you anything, you can kill me right away."
        [/message]
        [message]
        speaker=Bastard
        message=_ "I'll get my answers. Ogres! Eat him alive. Starting with his feet."
        [/message]

        [unit]
        side=1
        type=Ogre
        id=eater
        x,y=$unit.x,$unit.y
        [/unit]

        [delay]
        time=400
        [/delay]

        [animate_unit]
        flag=idling
        [filter]
            id=eater
        [/filter] 
        [/animate_unit]     

        [sound]  
            name=ogre-die-4.ogg
        [/sound]  

        [delay]
        time=400
        [/delay]

        [message]
        speaker=unit
        message=_ "I'll tell you, just get that bald thing away from me! A wolf rider from the Cold Blood Clan came to us. He gave us 200 gold and promised us triple if we killed you. He said it was the chief's errand. But he didn't give us a name!"
        [/message]
        [message]
        speaker=Bastard
        message=_ "I'll get my answers. Ogres! Eat him alive. Starting with his feet."
        [/message]
        [kill]
        id=unit.id
        animate=yes
        [/kill]
        [set_variable]
        name=kill
        value=1
        [/set_variable]

[/event]
[event]
name=moveto

        [filter]
        id=Bastard
        [filter_location]
        x,y=1,5
        [/filter_location]
        [/filter]
        [if]
        [variable]
        name=kill
        numerical_equals=1
        [/variable]
        [then]
        [message]
        speaker=Bastard
        message=_ " I can't wait to get back to the fortress. If Lokra's there..."
        [/message]
        [message]
        speaker=Mursha
        message=_ "You'll think about that after your arm is repaired! Let's go!"
        [/message]
        [endlevel]
        result=victory
        [/endlevel]
        [/then]
        [else]
        [message]
        speaker=Bastard
        message=_ "It's too early to leave, I want to get my answers!"
        [/message]
        [/else]
        [/if]
[/event]

[event]
name=die

    [filter]
    id=Bastard
    [/filter]

    [message]
    speaker=Mursha
    message=_ "That idiot let himself get killed! Now the tribe will fall back into strife!"
    [/message]
    [endlevel]
    result=defeat
    [/endlevel]
[/event]
[event]
name=die

    [filter]
    id=Mursha
    [/filter]

    [message]
    speaker=Bastard
    message=_ "Mursha's dead! Who will help me on my hikes now?"
    [/message]
    [endlevel]
    result=defeat
    [/endlevel]
[/event]
[/scenario]
